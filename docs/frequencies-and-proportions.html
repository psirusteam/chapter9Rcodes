<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>3.1 Frequencies and Proportions | CHAPTER 9 - EXAMPLES IN R</title>
  <meta name="description" content="3.1 Frequencies and Proportions | CHAPTER 9 - EXAMPLES IN R" />
  <meta name="generator" content="bookdown 0.41 and GitBook 2.6.7" />

  <meta property="og:title" content="3.1 Frequencies and Proportions | CHAPTER 9 - EXAMPLES IN R" />
  <meta property="og:type" content="book" />
  
  <meta property="og:description" content="3.1 Frequencies and Proportions | CHAPTER 9 - EXAMPLES IN R" />
  <meta name="github-repo" content="psirusteam/chapter9Rcodes" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="3.1 Frequencies and Proportions | CHAPTER 9 - EXAMPLES IN R" />
  
  <meta name="twitter:description" content="3.1 Frequencies and Proportions | CHAPTER 9 - EXAMPLES IN R" />
  

<meta name="author" content="" />


<meta name="date" content="2025-03-21" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="using-software-to-generate-valid-inferences.html"/>
<link rel="next" href="totals-means-and-ratios.html"/>
<script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.6/dist/fuse.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />








<link href="libs/anchor-sections-1.1.0/anchor-sections.css" rel="stylesheet" />
<link href="libs/anchor-sections-1.1.0/anchor-sections-hash.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.1.0/anchor-sections.js"></script>
<script src="libs/kePrint-0.0.1/kePrint.js"></script>
<link href="libs/lightable-0.0.1/lightable.css" rel="stylesheet" />


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { color: #008000; } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { color: #008000; font-weight: bold; } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<style type="text/css">
  
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">CHAPTER 9 - EXAMPLES IN R</a></li>

<li class="divider"></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>Abstract</a></li>
<li class="chapter" data-level="" data-path="accounting-for-the-sampling-design.html"><a href="accounting-for-the-sampling-design.html"><i class="fa fa-check"></i>Accounting for the Sampling Design</a>
<ul>
<li class="chapter" data-level="" data-path="sample-design-of-the-ess4-20182019.html"><a href="sample-design-of-the-ess4-20182019.html"><i class="fa fa-check"></i>Sample design of the ESS4 2018/2019</a></li>
<li class="chapter" data-level="" data-path="data-source.html"><a href="data-source.html"><i class="fa fa-check"></i>Data Source</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="using-software-to-generate-valid-inferences.html"><a href="using-software-to-generate-valid-inferences.html"><i class="fa fa-check"></i>2.3 Using Software to Generate Valid Inferences</a>
<ul>
<li class="chapter" data-level="" data-path="using-software-to-generate-valid-inferences.html"><a href="using-software-to-generate-valid-inferences.html#prepare-the-work-environment"><i class="fa fa-check"></i>Prepare the work environment</a></li>
<li class="chapter" data-level="" data-path="using-software-to-generate-valid-inferences.html"><a href="using-software-to-generate-valid-inferences.html#loading-datasets"><i class="fa fa-check"></i>Loading Datasets</a></li>
<li class="chapter" data-level="" data-path="using-software-to-generate-valid-inferences.html"><a href="using-software-to-generate-valid-inferences.html#defining-the-survey-design"><i class="fa fa-check"></i>Defining the survey design</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="frequencies-and-proportions.html"><a href="frequencies-and-proportions.html"><i class="fa fa-check"></i>3.1 Frequencies and Proportions</a>
<ul>
<li class="chapter" data-level="" data-path="frequencies-and-proportions.html"><a href="frequencies-and-proportions.html#prepare-the-work-environment-1"><i class="fa fa-check"></i>Prepare the work environment</a></li>
<li class="chapter" data-level="" data-path="frequencies-and-proportions.html"><a href="frequencies-and-proportions.html#estimating-totals-and-proportions"><i class="fa fa-check"></i>Estimating totals and proportions</a></li>
<li class="chapter" data-level="" data-path="frequencies-and-proportions.html"><a href="frequencies-and-proportions.html#formatting-and-presenting-results"><i class="fa fa-check"></i>Formatting and presenting results</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="totals-means-and-ratios.html"><a href="totals-means-and-ratios.html"><i class="fa fa-check"></i>3.2 Totals, means and ratios</a>
<ul>
<li class="chapter" data-level="" data-path="totals-means-and-ratios.html"><a href="totals-means-and-ratios.html#prepare-the-work-environment-2"><i class="fa fa-check"></i>Prepare the work environment</a></li>
<li class="chapter" data-level="" data-path="totals-means-and-ratios.html"><a href="totals-means-and-ratios.html#estimation-of-totals-and-means"><i class="fa fa-check"></i>Estimation of totals and means</a></li>
<li class="chapter" data-level="" data-path="totals-means-and-ratios.html"><a href="totals-means-and-ratios.html#estimation-of-ratio"><i class="fa fa-check"></i>Estimation of Ratio</a></li>
<li class="chapter" data-level="" data-path="totals-means-and-ratios.html"><a href="totals-means-and-ratios.html#estimating-the-ratio-of-educational-expenditure"><i class="fa fa-check"></i>Estimating the Ratio of Educational Expenditure</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="correlations.html"><a href="correlations.html"><i class="fa fa-check"></i>3.3 Correlations</a>
<ul>
<li class="chapter" data-level="" data-path="correlations.html"><a href="correlations.html#prepare-the-work-environment-3"><i class="fa fa-check"></i>Prepare the work environment</a></li>
<li class="chapter" data-level="" data-path="correlations.html"><a href="correlations.html#estimating-correlations"><i class="fa fa-check"></i>Estimating Correlations</a></li>
</ul></li>
<li class="divider"></li>
<li><a CHAPTER 9 - EXAMPLES IN R </a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">CHAPTER 9 - EXAMPLES IN R</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="frequencies-and-proportions" class="section level1 unnumbered hasAnchor">
<h1>3.1 Frequencies and Proportions<a href="frequencies-and-proportions.html#frequencies-and-proportions" class="anchor-section" aria-label="Anchor link to header"></a></h1>
<p>This code block sets up the working environment for a new section of the analysis, focused on calculating frequencies and proportions based on the ESS4 survey design. Although this structure was defined earlier in the manual, it is repeated here to ensure that execution remains self-contained, reproducible, and free from interference from previous sections.</p>
<div id="prepare-the-work-environment-1" class="section level3 unnumbered hasAnchor">
<h3>Prepare the work environment<a href="frequencies-and-proportions.html#prepare-the-work-environment-1" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>This code block marks the beginning of a <strong>new working session</strong>, following the same methodological line established earlier. Its main purpose is to prepare a clean, efficient, and fully loaded environment to continue with the processing and analysis of the survey data.</p>
<p>By resetting the R environment, reloading the necessary libraries, and adjusting the memory settings, this ensures that any subsequent analysis is carried out in a controlled manner, free from interference by previous objects or configurations. This approach is especially useful when working with modular scripts, such as in a manual, as it allows each section to be executed independently, ensuring <strong>reproducibility</strong> and <strong>consistency</strong> throughout the entire workflow.</p>
<div class="sourceCode" id="cb11"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb11-1"><a href="frequencies-and-proportions.html#cb11-1" tabindex="-1"></a><span class="co">#------------------------------------------------------------------------------#</span></span>
<span id="cb11-2"><a href="frequencies-and-proportions.html#cb11-2" tabindex="-1"></a><span class="co">#                           Cleaning R Environment                             #</span></span>
<span id="cb11-3"><a href="frequencies-and-proportions.html#cb11-3" tabindex="-1"></a><span class="co">#------------------------------------------------------------------------------#</span></span>
<span id="cb11-4"><a href="frequencies-and-proportions.html#cb11-4" tabindex="-1"></a></span>
<span id="cb11-5"><a href="frequencies-and-proportions.html#cb11-5" tabindex="-1"></a><span class="fu">rm</span>(<span class="at">list =</span> <span class="fu">ls</span>())</span>
<span id="cb11-6"><a href="frequencies-and-proportions.html#cb11-6" tabindex="-1"></a><span class="fu">gc</span>()</span></code></pre></div>
<pre><code>##          used (Mb) gc trigger (Mb) max used (Mb)
## Ncells 554800 29.7    1241915 66.4   686454 36.7
## Vcells 982594  7.5    8388608 64.0  1876235 14.4</code></pre>
<div class="sourceCode" id="cb13"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb13-1"><a href="frequencies-and-proportions.html#cb13-1" tabindex="-1"></a><span class="co">#------------------------------------------------------------------------------#</span></span>
<span id="cb13-2"><a href="frequencies-and-proportions.html#cb13-2" tabindex="-1"></a><span class="co">#                                Libraries                                     #</span></span>
<span id="cb13-3"><a href="frequencies-and-proportions.html#cb13-3" tabindex="-1"></a><span class="co">#------------------------------------------------------------------------------#</span></span>
<span id="cb13-4"><a href="frequencies-and-proportions.html#cb13-4" tabindex="-1"></a></span>
<span id="cb13-5"><a href="frequencies-and-proportions.html#cb13-5" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span>
<span id="cb13-6"><a href="frequencies-and-proportions.html#cb13-6" tabindex="-1"></a><span class="fu">library</span>(survey)</span>
<span id="cb13-7"><a href="frequencies-and-proportions.html#cb13-7" tabindex="-1"></a><span class="fu">library</span>(srvyr)</span>
<span id="cb13-8"><a href="frequencies-and-proportions.html#cb13-8" tabindex="-1"></a><span class="fu">library</span>(data.table)</span>
<span id="cb13-9"><a href="frequencies-and-proportions.html#cb13-9" tabindex="-1"></a><span class="fu">library</span>(magrittr)</span>
<span id="cb13-10"><a href="frequencies-and-proportions.html#cb13-10" tabindex="-1"></a><span class="fu">library</span>(haven)</span>
<span id="cb13-11"><a href="frequencies-and-proportions.html#cb13-11" tabindex="-1"></a><span class="fu">library</span>(stringr)</span>
<span id="cb13-12"><a href="frequencies-and-proportions.html#cb13-12" tabindex="-1"></a><span class="fu">library</span>(tidyr)</span>
<span id="cb13-13"><a href="frequencies-and-proportions.html#cb13-13" tabindex="-1"></a><span class="fu">library</span>(knitr)</span>
<span id="cb13-14"><a href="frequencies-and-proportions.html#cb13-14" tabindex="-1"></a><span class="fu">library</span>(kableExtra)</span>
<span id="cb13-15"><a href="frequencies-and-proportions.html#cb13-15" tabindex="-1"></a></span>
<span id="cb13-16"><a href="frequencies-and-proportions.html#cb13-16" tabindex="-1"></a><span class="co"># Ensure select function from dplyr is used explicitly</span></span>
<span id="cb13-17"><a href="frequencies-and-proportions.html#cb13-17" tabindex="-1"></a>select <span class="ot">&lt;-</span> dplyr<span class="sc">::</span>select</span>
<span id="cb13-18"><a href="frequencies-and-proportions.html#cb13-18" tabindex="-1"></a></span>
<span id="cb13-19"><a href="frequencies-and-proportions.html#cb13-19" tabindex="-1"></a><span class="co">#------------------------------------------------------------------------------#</span></span>
<span id="cb13-20"><a href="frequencies-and-proportions.html#cb13-20" tabindex="-1"></a><span class="co">#                        Setting the RAM Memory Limit                          #</span></span>
<span id="cb13-21"><a href="frequencies-and-proportions.html#cb13-21" tabindex="-1"></a><span class="co">#------------------------------------------------------------------------------#</span></span>
<span id="cb13-22"><a href="frequencies-and-proportions.html#cb13-22" tabindex="-1"></a></span>
<span id="cb13-23"><a href="frequencies-and-proportions.html#cb13-23" tabindex="-1"></a><span class="fu">memory.limit</span>(<span class="dv">250000000</span>)</span></code></pre></div>
<pre><code>## [1] Inf</code></pre>
<p>This block continues the analysis, focusing on the processing of <strong>household consumption expenditure</strong> and <strong>participation</strong> in various items over the past 12 months. The dataset from section 7b of the questionnaire is loaded, and two variables are created: one for the <strong>amount spent</strong> (<code>expenditure</code>) and a binary indicator (<code>yes_no</code>) that reflects whether or not the household incurred that expense.</p>
<p>Next, the <strong>survey design</strong> is defined using the same structure as before: strata are created by combining region and urban/rural classification, primary sampling units (<code>ea_id</code>) are specified, and the adjusted sampling weights (<code>pw_w4</code>) are applied. The summary of the design allows for validation before proceeding with the analysis.</p>
<div class="sourceCode" id="cb15"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb15-1"><a href="frequencies-and-proportions.html#cb15-1" tabindex="-1"></a><span class="co">#------------------------------------------------------------------------------#</span></span>
<span id="cb15-2"><a href="frequencies-and-proportions.html#cb15-2" tabindex="-1"></a><span class="co">#                           Loading Datasets                                   #</span></span>
<span id="cb15-3"><a href="frequencies-and-proportions.html#cb15-3" tabindex="-1"></a><span class="co">#------------------------------------------------------------------------------#</span></span>
<span id="cb15-4"><a href="frequencies-and-proportions.html#cb15-4" tabindex="-1"></a>HH_data <span class="ot">&lt;-</span> <span class="fu">read_sav</span>(<span class="st">&quot;data/data_ESS4/sect7b_hh_w4_v2.sav&quot;</span>)</span>
<span id="cb15-5"><a href="frequencies-and-proportions.html#cb15-5" tabindex="-1"></a></span>
<span id="cb15-6"><a href="frequencies-and-proportions.html#cb15-6" tabindex="-1"></a><span class="co"># Processing expenditure and response indicators</span></span>
<span id="cb15-7"><a href="frequencies-and-proportions.html#cb15-7" tabindex="-1"></a>HH_data <span class="ot">&lt;-</span> HH_data <span class="sc">%&gt;%</span></span>
<span id="cb15-8"><a href="frequencies-and-proportions.html#cb15-8" tabindex="-1"></a>  <span class="fu">group_by</span>(<span class="at">item =</span> item_cd_12months) <span class="sc">%&gt;%</span></span>
<span id="cb15-9"><a href="frequencies-and-proportions.html#cb15-9" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb15-10"><a href="frequencies-and-proportions.html#cb15-10" tabindex="-1"></a>    <span class="at">expenditure =</span> <span class="fu">ifelse</span>(s7q03 <span class="sc">==</span> <span class="dv">2</span>, <span class="dv">0</span>, s7q04),</span>
<span id="cb15-11"><a href="frequencies-and-proportions.html#cb15-11" tabindex="-1"></a>    <span class="at">yes_no =</span> <span class="fu">ifelse</span>(s7q03 <span class="sc">==</span> <span class="dv">2</span>, <span class="dv">0</span>, <span class="dv">1</span>)</span>
<span id="cb15-12"><a href="frequencies-and-proportions.html#cb15-12" tabindex="-1"></a>  )</span>
<span id="cb15-13"><a href="frequencies-and-proportions.html#cb15-13" tabindex="-1"></a></span>
<span id="cb15-14"><a href="frequencies-and-proportions.html#cb15-14" tabindex="-1"></a><span class="co"># Defining the survey design</span></span>
<span id="cb15-15"><a href="frequencies-and-proportions.html#cb15-15" tabindex="-1"></a>ESS4_design <span class="ot">&lt;-</span> HH_data <span class="sc">%&gt;%</span></span>
<span id="cb15-16"><a href="frequencies-and-proportions.html#cb15-16" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">strata =</span> <span class="fu">paste0</span>(saq01, <span class="st">&quot;_&quot;</span>, saq14)) <span class="sc">%&gt;%</span></span>
<span id="cb15-17"><a href="frequencies-and-proportions.html#cb15-17" tabindex="-1"></a>  <span class="fu">as_survey_design</span>(</span>
<span id="cb15-18"><a href="frequencies-and-proportions.html#cb15-18" tabindex="-1"></a>    <span class="at">ids =</span> ea_id,</span>
<span id="cb15-19"><a href="frequencies-and-proportions.html#cb15-19" tabindex="-1"></a>    <span class="co"># Primary sampling unit identifier (EA)</span></span>
<span id="cb15-20"><a href="frequencies-and-proportions.html#cb15-20" tabindex="-1"></a>    <span class="at">strata =</span> strata,</span>
<span id="cb15-21"><a href="frequencies-and-proportions.html#cb15-21" tabindex="-1"></a>    <span class="co"># Stratification by region (saq01) and urban/rural zone (saq14)</span></span>
<span id="cb15-22"><a href="frequencies-and-proportions.html#cb15-22" tabindex="-1"></a>    <span class="at">weights =</span> pw_w4,</span>
<span id="cb15-23"><a href="frequencies-and-proportions.html#cb15-23" tabindex="-1"></a>    <span class="co"># Final adjusted weight</span></span>
<span id="cb15-24"><a href="frequencies-and-proportions.html#cb15-24" tabindex="-1"></a>    <span class="at">nest =</span> <span class="cn">TRUE</span></span>
<span id="cb15-25"><a href="frequencies-and-proportions.html#cb15-25" tabindex="-1"></a>  )</span>
<span id="cb15-26"><a href="frequencies-and-proportions.html#cb15-26" tabindex="-1"></a></span>
<span id="cb15-27"><a href="frequencies-and-proportions.html#cb15-27" tabindex="-1"></a><span class="co"># Makes it an error to have a stratum with a single, non-certainty PSU</span></span>
<span id="cb15-28"><a href="frequencies-and-proportions.html#cb15-28" tabindex="-1"></a><span class="fu">options</span>(<span class="at">survey.lonely.psu =</span> <span class="st">&quot;fail&quot;</span>) </span>
<span id="cb15-29"><a href="frequencies-and-proportions.html#cb15-29" tabindex="-1"></a><span class="fu">summary</span>(ESS4_design)</span></code></pre></div>
<pre><code>## Stratified 1 - level Cluster Sampling design (with replacement)
## With (535) clusters.
## Called via srvyr
## Probabilities:
##      Min.   1st Qu.    Median      Mean   3rd Qu.      Max. 
## 3.932e-05 1.997e-04 7.680e-04 2.814e-03 4.164e-03 1.317e-01 
## Stratum Sizes: 
##             1_1  1_2 12_1 12_2 13_1 13_2 14_2 15_1 15_2  2_1  2_2  3_1  3_2
## obs        4323 3113 2145 3300 2090 3960 8558 1760 4609 3289 2475 5269 2981
## design.PSU   35   19   19   20   18   24   52   14   28   28   15   43   18
## actual.PSU   35   19   19   20   18   24   52   14   28   28   15   43   18
##             4_1  4_2  5_1  5_2  6_1  6_2  7_1  7_2
## obs        4983 3300 3905 2805 1859 2145 4642 2959
## design.PSU   43   20   35   17   16   13   40   18
## actual.PSU   43   20   35   17   16   13   40   18
## Data variables:
##  [1] &quot;household_id&quot;     &quot;item_cd_12months&quot; &quot;ea_id&quot;            &quot;saq14&quot;           
##  [5] &quot;pw_w4&quot;            &quot;saq01&quot;            &quot;saq02&quot;            &quot;saq03&quot;           
##  [9] &quot;saq04&quot;            &quot;saq05&quot;            &quot;saq06&quot;            &quot;saq07&quot;           
## [13] &quot;saq08&quot;            &quot;s7q03&quot;            &quot;s7q04&quot;            &quot;item&quot;            
## [17] &quot;expenditure&quot;      &quot;yes_no&quot;           &quot;strata&quot;</code></pre>
</div>
<div id="estimating-totals-and-proportions" class="section level3 unnumbered hasAnchor">
<h3>Estimating totals and proportions<a href="frequencies-and-proportions.html#estimating-totals-and-proportions" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>This block calculates key indicators related to <strong>household spending on nonfood items and services</strong>, grouping the data by item type (<code>item_cd_12months</code>). Based on the defined survey design, two main estimates are produced:</p>
<ul>
<li><strong><code>N_hat</code></strong>: the estimated total number of households reporting expenditures on each item, along with its standard error and coefficient of variation.<br />
</li>
<li><strong><code>P_hat</code></strong>: the estimated proportion of households who reported spending, including its standard error, coefficient of variation, and a 95% confidence interval.</li>
</ul>
<p>These estimates provide insight into both the magnitude and coverage of consumption across different categories of goods and services at the national level.</p>
<div class="sourceCode" id="cb17"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb17-1"><a href="frequencies-and-proportions.html#cb17-1" tabindex="-1"></a><span class="co">#------------------------------------------------------------------------------#</span></span>
<span id="cb17-2"><a href="frequencies-and-proportions.html#cb17-2" tabindex="-1"></a><span class="co"># TABLE 7.3</span></span>
<span id="cb17-3"><a href="frequencies-and-proportions.html#cb17-3" tabindex="-1"></a><span class="co"># Spending on Nonfood Items and Services</span></span>
<span id="cb17-4"><a href="frequencies-and-proportions.html#cb17-4" tabindex="-1"></a><span class="co">#</span></span>
<span id="cb17-5"><a href="frequencies-and-proportions.html#cb17-5" tabindex="-1"></a><span class="co"># ESS4 Sampled EAs and Households by Region and by Urban and Rural  </span></span>
<span id="cb17-6"><a href="frequencies-and-proportions.html#cb17-6" tabindex="-1"></a><span class="co"># Ethiopia Socioeconomic Survey (ESS) 2018/19</span></span>
<span id="cb17-7"><a href="frequencies-and-proportions.html#cb17-7" tabindex="-1"></a><span class="co"># SURVEY REPORT</span></span>
<span id="cb17-8"><a href="frequencies-and-proportions.html#cb17-8" tabindex="-1"></a><span class="co"># Central Statistics Agency of Ethiopia | World Bank</span></span>
<span id="cb17-9"><a href="frequencies-and-proportions.html#cb17-9" tabindex="-1"></a><span class="co">#------------------------------------------------------------------------------#</span></span>
<span id="cb17-10"><a href="frequencies-and-proportions.html#cb17-10" tabindex="-1"></a></span>
<span id="cb17-11"><a href="frequencies-and-proportions.html#cb17-11" tabindex="-1"></a>tab_01 <span class="ot">&lt;-</span> ESS4_design <span class="sc">%&gt;%</span></span>
<span id="cb17-12"><a href="frequencies-and-proportions.html#cb17-12" tabindex="-1"></a>  <span class="fu">group_by</span>(<span class="at">item =</span> item_cd_12months) <span class="sc">%&gt;%</span></span>
<span id="cb17-13"><a href="frequencies-and-proportions.html#cb17-13" tabindex="-1"></a>  <span class="fu">summarise</span>(</span>
<span id="cb17-14"><a href="frequencies-and-proportions.html#cb17-14" tabindex="-1"></a>  <span class="at">N_hat =</span> <span class="fu">survey_total</span>(yes_no, <span class="at">na.rm =</span> <span class="cn">TRUE</span>, <span class="at">vartype =</span> <span class="fu">c</span>(<span class="st">&quot;se&quot;</span>, <span class="st">&quot;cv&quot;</span>)),</span>
<span id="cb17-15"><a href="frequencies-and-proportions.html#cb17-15" tabindex="-1"></a>  <span class="co"># Absolute size</span></span>
<span id="cb17-16"><a href="frequencies-and-proportions.html#cb17-16" tabindex="-1"></a>  <span class="at">P_hat =</span> <span class="fu">survey_mean</span>(yes_no, <span class="at">na.rm =</span> <span class="cn">TRUE</span>, <span class="at">vartype =</span> <span class="fu">c</span>(<span class="st">&quot;se&quot;</span>, <span class="st">&quot;cv&quot;</span>, <span class="st">&quot;ci&quot;</span>))</span>
<span id="cb17-17"><a href="frequencies-and-proportions.html#cb17-17" tabindex="-1"></a>  <span class="co"># Proportions</span></span>
<span id="cb17-18"><a href="frequencies-and-proportions.html#cb17-18" tabindex="-1"></a>  )</span></code></pre></div>
</div>
<div id="formatting-and-presenting-results" class="section level3 unnumbered hasAnchor">
<h3>Formatting and presenting results<a href="frequencies-and-proportions.html#formatting-and-presenting-results" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>In this block, the previously computed results are transformed into a reader-friendly table. Item codes are converted into factors, and all estimates are rounded for clarity, including:<br />
- The total number of households (<code>N_hat</code>),<br />
- The proportion of households (<code>P_hat</code>),<br />
- Standard errors, coefficients of variation, and confidence intervals.</p>
<p>This step facilitates interpretation and prepares the table for inclusion in technical reports or analytical documents, such as the official ESS4 survey report.</p>
<p>The resulting table provides a summary of <strong>nonfood items and services</strong> purchased by Ethiopian households over the past 12 months, with estimates based on the <strong>ESS4</strong> survey design. It includes key precision measures such as the <strong>coefficient of variation (<code>*_cv</code>)</strong>, <strong>standard error (<code>*_se</code>)</strong>, and the <strong>95% confidence interval (<code>*_low</code>, <code>*_upp</code>)</strong>.</p>
<div class="sourceCode" id="cb18"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb18-1"><a href="frequencies-and-proportions.html#cb18-1" tabindex="-1"></a>tab_01 <span class="sc">%&gt;%</span></span>
<span id="cb18-2"><a href="frequencies-and-proportions.html#cb18-2" tabindex="-1"></a>  <span class="fu">transmute</span>(</span>
<span id="cb18-3"><a href="frequencies-and-proportions.html#cb18-3" tabindex="-1"></a>    <span class="at">item =</span> <span class="fu">as_factor</span>(item),</span>
<span id="cb18-4"><a href="frequencies-and-proportions.html#cb18-4" tabindex="-1"></a>    <span class="at">N_hat =</span> <span class="fu">round</span>(N_hat),</span>
<span id="cb18-5"><a href="frequencies-and-proportions.html#cb18-5" tabindex="-1"></a>    <span class="at">N_hat_cv =</span> <span class="fu">round</span>(N_hat_cv <span class="sc">*</span> <span class="dv">100</span>, <span class="dv">2</span>),</span>
<span id="cb18-6"><a href="frequencies-and-proportions.html#cb18-6" tabindex="-1"></a>    <span class="at">P_hat =</span> <span class="fu">round</span>(P_hat <span class="sc">*</span> <span class="dv">100</span>, <span class="dv">2</span>),</span>
<span id="cb18-7"><a href="frequencies-and-proportions.html#cb18-7" tabindex="-1"></a>    <span class="at">P_hat_cv =</span> <span class="fu">round</span>(P_hat_cv <span class="sc">*</span> <span class="dv">100</span>, <span class="dv">2</span>),</span>
<span id="cb18-8"><a href="frequencies-and-proportions.html#cb18-8" tabindex="-1"></a>    <span class="at">P_hat_se =</span> <span class="fu">round</span>(P_hat_se <span class="sc">*</span> <span class="dv">100</span>, <span class="dv">2</span>),</span>
<span id="cb18-9"><a href="frequencies-and-proportions.html#cb18-9" tabindex="-1"></a>    <span class="at">P_hat_low =</span> <span class="fu">round</span>(P_hat_low <span class="sc">*</span> <span class="dv">100</span>, <span class="dv">2</span>),</span>
<span id="cb18-10"><a href="frequencies-and-proportions.html#cb18-10" tabindex="-1"></a>    <span class="at">P_hat_upp =</span> <span class="fu">round</span>(P_hat_upp <span class="sc">*</span> <span class="dv">100</span>, <span class="dv">2</span>)</span>
<span id="cb18-11"><a href="frequencies-and-proportions.html#cb18-11" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span> <span class="fu">data.frame</span>()</span></code></pre></div>
<table class="table" style="font-size: 10px; width: auto !important; margin-left: auto; margin-right: auto;">
<thead>
<tr>
<th style="text-align:left;">
item
</th>
<th style="text-align:right;">
N_hat
</th>
<th style="text-align:right;">
N_hat_cv
</th>
<th style="text-align:right;">
P_hat
</th>
<th style="text-align:right;">
P_hat_cv
</th>
<th style="text-align:right;">
P_hat_se
</th>
<th style="text-align:right;">
P_hat_low
</th>
<th style="text-align:right;">
P_hat_upp
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;">
<ol style="list-style-type: decimal">
<li>Clothes/shoes/fabric for MEN (18 years and older)
</td>
<td style="text-align:right;">
11641511
</td>
<td style="text-align:right;">
3.13
</td>
<td style="text-align:right;">
58.01
</td>
<td style="text-align:right;">
3.04
</td>
<td style="text-align:right;">
1.77
</td>
<td style="text-align:right;">
54.54
</td>
<td style="text-align:right;">
61.48
</td>
</tr>
<tr>
<td style="text-align:left;">
<ol start="2" style="list-style-type: decimal">
<li>Clothes/shoes/fabric for WOMEN (18 years and older)
</td>
<td style="text-align:right;">
12665176
</td>
<td style="text-align:right;">
3.03
</td>
<td style="text-align:right;">
63.11
</td>
<td style="text-align:right;">
2.90
</td>
<td style="text-align:right;">
1.83
</td>
<td style="text-align:right;">
59.51
</td>
<td style="text-align:right;">
66.71
</td>
</tr>
<tr>
<td style="text-align:left;">
<ol start="3" style="list-style-type: decimal">
<li>Clothes/shoes/fabric for BOYS (less than 18 years)
</td>
<td style="text-align:right;">
10538136
</td>
<td style="text-align:right;">
2.46
</td>
<td style="text-align:right;">
52.51
</td>
<td style="text-align:right;">
2.21
</td>
<td style="text-align:right;">
1.16
</td>
<td style="text-align:right;">
50.23
</td>
<td style="text-align:right;">
54.79
</td>
</tr>
<tr>
<td style="text-align:left;">
<ol start="4" style="list-style-type: decimal">
<li>Clothes/shoes/fabric for GIRLS (less than 18 years)
</td>
<td style="text-align:right;">
10366155
</td>
<td style="text-align:right;">
2.52
</td>
<td style="text-align:right;">
51.66
</td>
<td style="text-align:right;">
2.30
</td>
<td style="text-align:right;">
1.19
</td>
<td style="text-align:right;">
49.33
</td>
<td style="text-align:right;">
53.99
</td>
</tr>
<tr>
<td style="text-align:left;">
<ol start="5" style="list-style-type: decimal">
<li>Kitchen equipment (cooking pots, etc.)
</td>
<td style="text-align:right;">
3427502
</td>
<td style="text-align:right;">
8.63
</td>
<td style="text-align:right;">
17.08
</td>
<td style="text-align:right;">
8.58
</td>
<td style="text-align:right;">
1.46
</td>
<td style="text-align:right;">
14.20
</td>
<td style="text-align:right;">
19.96
</td>
</tr>
<tr>
<td style="text-align:left;">
<ol start="6" style="list-style-type: decimal">
<li>Linens (sheets, towels,blankets)
</td>
<td style="text-align:right;">
5673849
</td>
<td style="text-align:right;">
5.83
</td>
<td style="text-align:right;">
28.27
</td>
<td style="text-align:right;">
5.63
</td>
<td style="text-align:right;">
1.59
</td>
<td style="text-align:right;">
25.15
</td>
<td style="text-align:right;">
31.40
</td>
</tr>
<tr>
<td style="text-align:left;">
<ol start="7" style="list-style-type: decimal">
<li>Furniture
</td>
<td style="text-align:right;">
1583809
</td>
<td style="text-align:right;">
10.57
</td>
<td style="text-align:right;">
7.89
</td>
<td style="text-align:right;">
10.46
</td>
<td style="text-align:right;">
0.83
</td>
<td style="text-align:right;">
6.27
</td>
<td style="text-align:right;">
9.51
</td>
</tr>
<tr>
<td style="text-align:left;">
<ol start="8" style="list-style-type: decimal">
<li>Lamp/torch/solare power
</td>
<td style="text-align:right;">
5607831
</td>
<td style="text-align:right;">
6.12
</td>
<td style="text-align:right;">
27.94
</td>
<td style="text-align:right;">
6.02
</td>
<td style="text-align:right;">
1.68
</td>
<td style="text-align:right;">
24.64
</td>
<td style="text-align:right;">
31.25
</td>
</tr>
<tr>
<td style="text-align:left;">
<ol start="9" style="list-style-type: decimal">
<li>Ceremonial expenses
</td>
<td style="text-align:right;">
12305188
</td>
<td style="text-align:right;">
3.76
</td>
<td style="text-align:right;">
61.32
</td>
<td style="text-align:right;">
3.54
</td>
<td style="text-align:right;">
2.17
</td>
<td style="text-align:right;">
57.05
</td>
<td style="text-align:right;">
65.59
</td>
</tr>
<tr>
<td style="text-align:left;">
<ol start="10" style="list-style-type: decimal">
<li>Contributions to informal social security institutions (inc. IDDIR, mahiber..)
</td>
<td style="text-align:right;">
8985343
</td>
<td style="text-align:right;">
5.06
</td>
<td style="text-align:right;">
44.78
</td>
<td style="text-align:right;">
4.96
</td>
<td style="text-align:right;">
2.22
</td>
<td style="text-align:right;">
40.41
</td>
<td style="text-align:right;">
49.14
</td>
</tr>
<tr>
<td style="text-align:left;">
<ol start="11" style="list-style-type: decimal">
<li>Donations to religious institutions (Incl. churches and mosques..)
</td>
<td style="text-align:right;">
8174601
</td>
<td style="text-align:right;">
5.16
</td>
<td style="text-align:right;">
40.74
</td>
<td style="text-align:right;">
5.10
</td>
<td style="text-align:right;">
2.08
</td>
<td style="text-align:right;">
36.66
</td>
<td style="text-align:right;">
44.81
</td>
</tr>
</tbody>
</table></li>
</ol></li>
</ol></li>
</ol></li>
</ol></li>
</ol></li>
</ol></li>
</ol></li>
</ol></li>
</ol></li>
</ol></li>
</ol>

</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="using-software-to-generate-valid-inferences.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="totals-means-and-ratios.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": true,
"facebook": false,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"whatsapp": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": "https://github.com/psirusteam/chapter9Rcodes/3.1_Frequencies_and_proportions.rmd",
"text": "Edit"
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": ["CHAPTER 9 - EXAMPLES IN R.pdf", "CHAPTER 9 - EXAMPLES IN R.epub", "CHAPTER 9 - EXAMPLES IN R.mobi"],
"search": {
"engine": "fuse",
"options": null
},
"toc": {
"collapse": "section"
},
"tconfig": null
});
});
</script>

</body>

</html>
