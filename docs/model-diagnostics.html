<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>5.5 Model Diagnostics | Appendix of Chapter 9 - Analysis of Household Surveys - Examples in R</title>
  <meta name="description" content="CHAPTER 9 - EXAMPLES IN R" />
  <meta name="generator" content="bookdown 0.42 and GitBook 2.6.7" />

  <meta property="og:title" content="5.5 Model Diagnostics | Appendix of Chapter 9 - Analysis of Household Surveys - Examples in R" />
  <meta property="og:type" content="book" />
  
  <meta property="og:description" content="CHAPTER 9 - EXAMPLES IN R" />
  <meta name="github-repo" content="psirusteam/chapter9Rcodes" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="5.5 Model Diagnostics | Appendix of Chapter 9 - Analysis of Household Surveys - Examples in R" />
  
  <meta name="twitter:description" content="CHAPTER 9 - EXAMPLES IN R" />
  

<meta name="author" content="" />


<meta name="date" content="2025-03-25" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="working-with-weights.html"/>
<link rel="next" href="inference-on-model-parameters.html"/>
<script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.6/dist/fuse.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />








<link href="libs/anchor-sections-1.1.0/anchor-sections.css" rel="stylesheet" />
<link href="libs/anchor-sections-1.1.0/anchor-sections-hash.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.1.0/anchor-sections.js"></script>
<script src="libs/kePrint-0.0.1/kePrint.js"></script>
<link href="libs/lightable-0.0.1/lightable.css" rel="stylesheet" />


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { color: #008000; } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { color: #008000; font-weight: bold; } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<style type="text/css">
  
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">CHAPTER 9 - EXAMPLES IN R</a></li>

<li class="divider"></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>Abstract</a></li>
<li class="chapter" data-level="" data-path="introduction.html"><a href="introduction.html"><i class="fa fa-check"></i>Introduction</a></li>
<li class="chapter" data-level="" data-path="accounting-for-the-sampling-design.html"><a href="accounting-for-the-sampling-design.html"><i class="fa fa-check"></i>Accounting for the Sampling Design</a>
<ul>
<li class="chapter" data-level="" data-path="sample-design-of-the-ess4-20182019.html"><a href="sample-design-of-the-ess4-20182019.html"><i class="fa fa-check"></i>Sample design of the ESS4 2018/2019</a></li>
<li class="chapter" data-level="" data-path="data-source.html"><a href="data-source.html"><i class="fa fa-check"></i>Data Source</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="using-software-to-generate-valid-inferences.html"><a href="using-software-to-generate-valid-inferences.html"><i class="fa fa-check"></i>2.3 Using Software to Generate Valid Inferences</a>
<ul>
<li class="chapter" data-level="" data-path="using-software-to-generate-valid-inferences.html"><a href="using-software-to-generate-valid-inferences.html#prepare-the-work-environment"><i class="fa fa-check"></i>Prepare the work environment</a></li>
<li class="chapter" data-level="" data-path="using-software-to-generate-valid-inferences.html"><a href="using-software-to-generate-valid-inferences.html#loading-datasets"><i class="fa fa-check"></i>Loading Datasets</a></li>
<li class="chapter" data-level="" data-path="using-software-to-generate-valid-inferences.html"><a href="using-software-to-generate-valid-inferences.html#defining-the-survey-design"><i class="fa fa-check"></i>Defining the survey design</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="frequencies-and-proportions.html"><a href="frequencies-and-proportions.html"><i class="fa fa-check"></i>3.1 Frequencies and Proportions</a>
<ul>
<li class="chapter" data-level="" data-path="frequencies-and-proportions.html"><a href="frequencies-and-proportions.html#prepare-the-work-environment-1"><i class="fa fa-check"></i>Prepare the work environment</a></li>
<li class="chapter" data-level="" data-path="frequencies-and-proportions.html"><a href="frequencies-and-proportions.html#estimating-totals-and-proportions"><i class="fa fa-check"></i>Estimating totals and proportions</a></li>
<li class="chapter" data-level="" data-path="frequencies-and-proportions.html"><a href="frequencies-and-proportions.html#formatting-and-presenting-results"><i class="fa fa-check"></i>Formatting and presenting results</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="totals-means-and-ratios.html"><a href="totals-means-and-ratios.html"><i class="fa fa-check"></i>3.2 Totals, means and ratios</a>
<ul>
<li class="chapter" data-level="" data-path="totals-means-and-ratios.html"><a href="totals-means-and-ratios.html#prepare-the-work-environment-2"><i class="fa fa-check"></i>Prepare the work environment</a></li>
<li class="chapter" data-level="" data-path="totals-means-and-ratios.html"><a href="totals-means-and-ratios.html#estimation-of-totals-and-means"><i class="fa fa-check"></i>Estimation of totals and means</a></li>
<li class="chapter" data-level="" data-path="totals-means-and-ratios.html"><a href="totals-means-and-ratios.html#estimation-of-ratio"><i class="fa fa-check"></i>Estimation of Ratio</a></li>
<li class="chapter" data-level="" data-path="totals-means-and-ratios.html"><a href="totals-means-and-ratios.html#estimating-the-ratio-of-educational-expenditure"><i class="fa fa-check"></i>Estimating the Ratio of Educational Expenditure</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="correlations.html"><a href="correlations.html"><i class="fa fa-check"></i>3.3 Correlations</a>
<ul>
<li class="chapter" data-level="" data-path="correlations.html"><a href="correlations.html#prepare-the-work-environment-3"><i class="fa fa-check"></i>Prepare the work environment</a></li>
<li class="chapter" data-level="" data-path="correlations.html"><a href="correlations.html#estimating-correlations"><i class="fa fa-check"></i>Estimating Correlations</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="percentiles-and-inequality-measures.html"><a href="percentiles-and-inequality-measures.html"><i class="fa fa-check"></i>3.4 Percentiles and inequality measures</a>
<ul>
<li class="chapter" data-level="" data-path="percentiles-and-inequality-measures.html"><a href="percentiles-and-inequality-measures.html#prepare-the-work-environment-4"><i class="fa fa-check"></i>Prepare the work environment</a></li>
<li class="chapter" data-level="" data-path="percentiles-and-inequality-measures.html"><a href="percentiles-and-inequality-measures.html#estimating-the-mean-and-median-of-total-other-income"><i class="fa fa-check"></i>Estimating the Mean and Median of Total Other Income</a></li>
<li class="chapter" data-level="" data-path="percentiles-and-inequality-measures.html"><a href="percentiles-and-inequality-measures.html#the-gini-coefficient."><i class="fa fa-check"></i>The Gini Coefficient.</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="cross-tabulations.html"><a href="cross-tabulations.html"><i class="fa fa-check"></i>4.2 Cross-tabulations</a>
<ul>
<li class="chapter" data-level="" data-path="cross-tabulations.html"><a href="cross-tabulations.html#prepare-the-work-environment-5"><i class="fa fa-check"></i>Prepare the work environment</a></li>
<li class="chapter" data-level="" data-path="cross-tabulations.html"><a href="cross-tabulations.html#processing-variables-for-analysis"><i class="fa fa-check"></i>Processing Variables for Analysis</a></li>
<li class="chapter" data-level="" data-path="cross-tabulations.html"><a href="cross-tabulations.html#estimating-proportions-and-totals-by-religion"><i class="fa fa-check"></i>Estimating Proportions and Totals by Religion</a></li>
<li class="chapter" data-level="" data-path="cross-tabulations.html"><a href="cross-tabulations.html#formatting-and-displaying-cross-tabulation-tables"><i class="fa fa-check"></i>Formatting and Displaying Cross-tabulation Tables</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="testing-for-independence.html"><a href="testing-for-independence.html"><i class="fa fa-check"></i>4.3 Testing for Independence</a>
<ul>
<li class="chapter" data-level="" data-path="testing-for-independence.html"><a href="testing-for-independence.html#prepare-the-work-environment-6"><i class="fa fa-check"></i>Prepare the work environment</a></li>
<li class="chapter" data-level="" data-path="testing-for-independence.html"><a href="testing-for-independence.html#processing-education-variables"><i class="fa fa-check"></i>Processing Education Variables</a></li>
<li class="chapter" data-level="" data-path="testing-for-independence.html"><a href="testing-for-independence.html#testing-for-independence-1"><i class="fa fa-check"></i>Testing for Independence</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="tests-for-group-comparisons.html"><a href="tests-for-group-comparisons.html"><i class="fa fa-check"></i>4.4 Tests for Group Comparisons</a>
<ul>
<li class="chapter" data-level="" data-path="tests-for-group-comparisons.html"><a href="tests-for-group-comparisons.html#prepare-the-work-environment-7"><i class="fa fa-check"></i>Prepare the work environment</a></li>
<li class="chapter" data-level="" data-path="tests-for-group-comparisons.html"><a href="tests-for-group-comparisons.html#conducting-group-comparisons-on-expenditure"><i class="fa fa-check"></i>Conducting Group Comparisons on expenditure</a></li>
<li class="chapter" data-level="" data-path="tests-for-group-comparisons.html"><a href="tests-for-group-comparisons.html#hypothesis-testing-for-group-comparisons"><i class="fa fa-check"></i>Hypothesis Testing for Group Comparisons</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="linear-models.html"><a href="linear-models.html"><i class="fa fa-check"></i>5.3 Linear Models</a>
<ul>
<li class="chapter" data-level="" data-path="linear-models.html"><a href="linear-models.html#prepare-the-work-environment-8"><i class="fa fa-check"></i>Prepare the work environment</a></li>
<li class="chapter" data-level="" data-path="linear-models.html"><a href="linear-models.html#processing-demographic-information"><i class="fa fa-check"></i>Processing Demographic Information</a></li>
<li class="chapter" data-level="" data-path="linear-models.html"><a href="linear-models.html#estimating-linear-models"><i class="fa fa-check"></i>Estimating Linear Models</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="working-with-weights.html"><a href="working-with-weights.html"><i class="fa fa-check"></i>5.4 Working with Weights</a>
<ul>
<li class="chapter" data-level="" data-path="working-with-weights.html"><a href="working-with-weights.html#prepare-the-work-environment-9"><i class="fa fa-check"></i>Prepare the work environment</a></li>
<li class="chapter" data-level="" data-path="working-with-weights.html"><a href="working-with-weights.html#descriptive-analysis"><i class="fa fa-check"></i>Descriptive Analysis</a></li>
<li class="chapter" data-level="" data-path="working-with-weights.html"><a href="working-with-weights.html#defining-survey-designs"><i class="fa fa-check"></i>Defining Survey Designs</a></li>
<li class="chapter" data-level="" data-path="working-with-weights.html"><a href="working-with-weights.html#estimating-linear-models-1"><i class="fa fa-check"></i>Estimating Linear Models</a></li>
<li class="chapter" data-level="" data-path="working-with-weights.html"><a href="working-with-weights.html#display-regression-results"><i class="fa fa-check"></i>Display regression results</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="model-diagnostics.html"><a href="model-diagnostics.html"><i class="fa fa-check"></i>5.5 Model Diagnostics</a>
<ul>
<li class="chapter" data-level="" data-path="model-diagnostics.html"><a href="model-diagnostics.html#prepare-the-work-environment-10"><i class="fa fa-check"></i>Prepare the work environment</a></li>
<li class="chapter" data-level="" data-path="model-diagnostics.html"><a href="model-diagnostics.html#model-fit-r2-calculation"><i class="fa fa-check"></i>Model Fit: <span class="math inline">\(R^2\)</span> Calculation</a></li>
<li class="chapter" data-level="" data-path="model-diagnostics.html"><a href="model-diagnostics.html#standardized-residuals-analysis"><i class="fa fa-check"></i>Standardized Residuals Analysis</a></li>
<li class="chapter" data-level="" data-path="model-diagnostics.html"><a href="model-diagnostics.html#influential-observations"><i class="fa fa-check"></i>Influential Observations</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="inference-on-model-parameters.html"><a href="inference-on-model-parameters.html"><i class="fa fa-check"></i>5.6 Inference on Model Parameters</a>
<ul>
<li class="chapter" data-level="" data-path="inference-on-model-parameters.html"><a href="inference-on-model-parameters.html#prepare-the-work-environment-11"><i class="fa fa-check"></i>Prepare the work environment</a></li>
<li class="chapter" data-level="" data-path="inference-on-model-parameters.html"><a href="inference-on-model-parameters.html#estimating-linear-models-2"><i class="fa fa-check"></i>Estimating Linear Models</a></li>
<li class="chapter" data-level="" data-path="inference-on-model-parameters.html"><a href="inference-on-model-parameters.html#inference-on-model-parameters-1"><i class="fa fa-check"></i>Inference on Model Parameters</a></li>
<li class="chapter" data-level="" data-path="inference-on-model-parameters.html"><a href="inference-on-model-parameters.html#comparison-predicted-vs-observed-values"><i class="fa fa-check"></i>Comparison: Predicted vs Observed Values</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="bar-charts.html"><a href="bar-charts.html"><i class="fa fa-check"></i>7.1 Bar charts</a>
<ul>
<li class="chapter" data-level="" data-path="bar-charts.html"><a href="bar-charts.html#prepare-the-work-environment-12"><i class="fa fa-check"></i>Prepare the work environment</a></li>
<li class="chapter" data-level="" data-path="bar-charts.html"><a href="bar-charts.html#bar-chart-for-estimated-number-of-households-spending-on-non-food-items"><i class="fa fa-check"></i>Bar Chart for Estimated Number of Households Spending on Non-Food Items</a></li>
<li class="chapter" data-level="" data-path="bar-charts.html"><a href="bar-charts.html#bar-chart-for-estimated-total-household-expenditure-on-non-food-items"><i class="fa fa-check"></i>Bar Chart for Estimated Total Household Expenditure on Non-Food Items</a></li>
<li class="chapter" data-level="" data-path="bar-charts.html"><a href="bar-charts.html#bar-chart-for-estimated-proportion-of-households-spending-on-non-food-items"><i class="fa fa-check"></i>Bar Chart for Estimated Proportion of Households Spending on Non-Food Items</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="histograms.html"><a href="histograms.html"><i class="fa fa-check"></i>7.2 Histograms</a>
<ul>
<li class="chapter" data-level="" data-path="histograms.html"><a href="histograms.html#prepare-the-work-environment-13"><i class="fa fa-check"></i>Prepare the work environment</a></li>
<li class="chapter" data-level="" data-path="histograms.html"><a href="histograms.html#histogram-using-survey-weighted-data"><i class="fa fa-check"></i>Histogram using Survey-Weighted Data</a></li>
<li class="chapter" data-level="" data-path="histograms.html"><a href="histograms.html#preparing-data-for-ggplot2-visualization"><i class="fa fa-check"></i>Preparing Data for ggplot2 Visualization</a></li>
<li class="chapter" data-level="" data-path="histograms.html"><a href="histograms.html#histogram-for-expenditure-distribution"><i class="fa fa-check"></i>Histogram for Expenditure Distribution</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="scatter-plots---relationship-between-expenditure-and-income.html"><a href="scatter-plots---relationship-between-expenditure-and-income.html"><i class="fa fa-check"></i>7.3 Scatter Plots - Relationship Between Expenditure and Income</a>
<ul>
<li class="chapter" data-level="" data-path="scatter-plots---relationship-between-expenditure-and-income.html"><a href="scatter-plots---relationship-between-expenditure-and-income.html#prepare-the-work-environment-14"><i class="fa fa-check"></i>Prepare the work environment</a></li>
<li class="chapter" data-level="" data-path="scatter-plots---relationship-between-expenditure-and-income.html"><a href="scatter-plots---relationship-between-expenditure-and-income.html#scatter-plots-of-expenditure-vs-income"><i class="fa fa-check"></i>Scatter Plots of Expenditure vs Income</a></li>
</ul></li>
<li class="divider"></li>
<li><a CHAPTER 9 - EXAMPLES IN R </a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Appendix of Chapter 9 - Analysis of Household Surveys - Examples in R</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="model-diagnostics" class="section level1 unnumbered hasAnchor">
<h1>5.5 Model Diagnostics<a href="model-diagnostics.html#model-diagnostics" class="anchor-section" aria-label="Anchor link to header"></a></h1>
<p>This code performs diagnostic analysis for survey-weighted regression models. It configures the survey design, fits a model for household expenditure, and evaluates it through: 1) <span class="math inline">\(R^2\)</span> calculation, 2) residual analysis (histogram/QQ plots), and 3) influence diagnostics (Cook’s Distance, DFBETAS, DFFITS). The implementation handles complex survey features like stratification and sampling weights.</p>
<div id="prepare-the-work-environment-10" class="section level3 unnumbered hasAnchor">
<h3>Prepare the work environment<a href="model-diagnostics.html#prepare-the-work-environment-10" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>This block sets up the working environment to perform <strong>diagnostics for linear models using complex survey data</strong>. It begins by clearing memory, loading essential libraries, and ensuring correct usage of <code>dplyr::select</code>. Then, it loads the preprocessed dataset (<code>IND_data_regression</code>) and defines the <strong>survey design object (<code>ESS4_design</code>)</strong>, incorporating stratification, primary sampling units (PSU), and calibrated survey weights. Lastly, a log transformation is applied to per capita expenditure to prepare the response variable for subsequent modeling.</p>
<div class="sourceCode" id="cb123"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb123-1"><a href="model-diagnostics.html#cb123-1" tabindex="-1"></a><span class="co">#------------------------------------------------------------------------------#</span></span>
<span id="cb123-2"><a href="model-diagnostics.html#cb123-2" tabindex="-1"></a><span class="co">#                           Cleaning R Environment                             #</span></span>
<span id="cb123-3"><a href="model-diagnostics.html#cb123-3" tabindex="-1"></a><span class="co">#------------------------------------------------------------------------------#</span></span>
<span id="cb123-4"><a href="model-diagnostics.html#cb123-4" tabindex="-1"></a></span>
<span id="cb123-5"><a href="model-diagnostics.html#cb123-5" tabindex="-1"></a><span class="co"># Remove all objects from the environment to avoid conflicts</span></span>
<span id="cb123-6"><a href="model-diagnostics.html#cb123-6" tabindex="-1"></a><span class="fu">rm</span>(<span class="at">list =</span> <span class="fu">ls</span>())</span>
<span id="cb123-7"><a href="model-diagnostics.html#cb123-7" tabindex="-1"></a></span>
<span id="cb123-8"><a href="model-diagnostics.html#cb123-8" tabindex="-1"></a><span class="co"># Perform garbage collection to free memory</span></span>
<span id="cb123-9"><a href="model-diagnostics.html#cb123-9" tabindex="-1"></a><span class="fu">gc</span>()</span></code></pre></div>
<pre><code>##          used (Mb) gc trigger (Mb) max used (Mb)
## Ncells 534418 28.6    1196718   64   660380 35.3
## Vcells 946774  7.3    8388608   64  1769850 13.6</code></pre>
<div class="sourceCode" id="cb125"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb125-1"><a href="model-diagnostics.html#cb125-1" tabindex="-1"></a><span class="co">#------------------------------------------------------------------------------#</span></span>
<span id="cb125-2"><a href="model-diagnostics.html#cb125-2" tabindex="-1"></a><span class="co">#                                Libraries                                     #</span></span>
<span id="cb125-3"><a href="model-diagnostics.html#cb125-3" tabindex="-1"></a><span class="co">#------------------------------------------------------------------------------#</span></span>
<span id="cb125-4"><a href="model-diagnostics.html#cb125-4" tabindex="-1"></a></span>
<span id="cb125-5"><a href="model-diagnostics.html#cb125-5" tabindex="-1"></a><span class="co"># Load required packages for data handling, survey analysis, and diagnostics</span></span>
<span id="cb125-6"><a href="model-diagnostics.html#cb125-6" tabindex="-1"></a></span>
<span id="cb125-7"><a href="model-diagnostics.html#cb125-7" tabindex="-1"></a><span class="fu">library</span>(dplyr)        </span>
<span id="cb125-8"><a href="model-diagnostics.html#cb125-8" tabindex="-1"></a><span class="fu">library</span>(survey)       </span>
<span id="cb125-9"><a href="model-diagnostics.html#cb125-9" tabindex="-1"></a><span class="fu">library</span>(srvyr)       </span>
<span id="cb125-10"><a href="model-diagnostics.html#cb125-10" tabindex="-1"></a><span class="fu">library</span>(data.table)  </span>
<span id="cb125-11"><a href="model-diagnostics.html#cb125-11" tabindex="-1"></a><span class="fu">library</span>(magrittr)     </span>
<span id="cb125-12"><a href="model-diagnostics.html#cb125-12" tabindex="-1"></a><span class="fu">library</span>(haven)        </span>
<span id="cb125-13"><a href="model-diagnostics.html#cb125-13" tabindex="-1"></a><span class="fu">library</span>(tidyr)        </span>
<span id="cb125-14"><a href="model-diagnostics.html#cb125-14" tabindex="-1"></a><span class="fu">library</span>(svydiags)     <span class="co"># Survey diagnostics</span></span>
<span id="cb125-15"><a href="model-diagnostics.html#cb125-15" tabindex="-1"></a><span class="fu">library</span>(ggplot2)      </span>
<span id="cb125-16"><a href="model-diagnostics.html#cb125-16" tabindex="-1"></a><span class="fu">library</span>(broom)       </span>
<span id="cb125-17"><a href="model-diagnostics.html#cb125-17" tabindex="-1"></a></span>
<span id="cb125-18"><a href="model-diagnostics.html#cb125-18" tabindex="-1"></a><span class="co"># Ensure dplyr&#39;s select function is correctly used to avoid conflicts</span></span>
<span id="cb125-19"><a href="model-diagnostics.html#cb125-19" tabindex="-1"></a>select <span class="ot">&lt;-</span> dplyr<span class="sc">::</span>select</span>
<span id="cb125-20"><a href="model-diagnostics.html#cb125-20" tabindex="-1"></a></span>
<span id="cb125-21"><a href="model-diagnostics.html#cb125-21" tabindex="-1"></a><span class="co">#------------------------------------------------------------------------------#</span></span>
<span id="cb125-22"><a href="model-diagnostics.html#cb125-22" tabindex="-1"></a><span class="co">#                           Loading Dataset                                    #</span></span>
<span id="cb125-23"><a href="model-diagnostics.html#cb125-23" tabindex="-1"></a><span class="co">#------------------------------------------------------------------------------#</span></span>
<span id="cb125-24"><a href="model-diagnostics.html#cb125-24" tabindex="-1"></a></span>
<span id="cb125-25"><a href="model-diagnostics.html#cb125-25" tabindex="-1"></a><span class="co"># Load the dataset containing survey information</span></span>
<span id="cb125-26"><a href="model-diagnostics.html#cb125-26" tabindex="-1"></a>IND_data_regression <span class="ot">&lt;-</span> <span class="fu">readRDS</span>(<span class="st">&quot;data/data_ESS4/IND_data_regression.rds&quot;</span>)</span>
<span id="cb125-27"><a href="model-diagnostics.html#cb125-27" tabindex="-1"></a></span>
<span id="cb125-28"><a href="model-diagnostics.html#cb125-28" tabindex="-1"></a><span class="co">#------------------------------------------------------------------------------#</span></span>
<span id="cb125-29"><a href="model-diagnostics.html#cb125-29" tabindex="-1"></a><span class="co">#                        Defining Survey Design                                #</span></span>
<span id="cb125-30"><a href="model-diagnostics.html#cb125-30" tabindex="-1"></a><span class="co">#------------------------------------------------------------------------------#</span></span>
<span id="cb125-31"><a href="model-diagnostics.html#cb125-31" tabindex="-1"></a></span>
<span id="cb125-32"><a href="model-diagnostics.html#cb125-32" tabindex="-1"></a><span class="co"># Set survey options to avoid errors in single PSU strata</span></span>
<span id="cb125-33"><a href="model-diagnostics.html#cb125-33" tabindex="-1"></a><span class="fu">options</span>(<span class="at">survey.lonely.psu =</span> <span class="st">&quot;fail&quot;</span>)</span>
<span id="cb125-34"><a href="model-diagnostics.html#cb125-34" tabindex="-1"></a></span>
<span id="cb125-35"><a href="model-diagnostics.html#cb125-35" tabindex="-1"></a><span class="co"># Define the survey design object using weighted data</span></span>
<span id="cb125-36"><a href="model-diagnostics.html#cb125-36" tabindex="-1"></a>ESS4_design <span class="ot">&lt;-</span> IND_data_regression <span class="sc">%&gt;%</span></span>
<span id="cb125-37"><a href="model-diagnostics.html#cb125-37" tabindex="-1"></a>  <span class="fu">filter</span>(percapita_expenditure <span class="sc">&gt;</span> <span class="dv">0</span>) <span class="sc">%&gt;%</span></span>
<span id="cb125-38"><a href="model-diagnostics.html#cb125-38" tabindex="-1"></a>  <span class="fu">as_survey_design</span>(</span>
<span id="cb125-39"><a href="model-diagnostics.html#cb125-39" tabindex="-1"></a>    <span class="at">ids =</span> ea_id,         <span class="co"># Primary Sampling Units (PSU)</span></span>
<span id="cb125-40"><a href="model-diagnostics.html#cb125-40" tabindex="-1"></a>    <span class="at">strata =</span> strata,     <span class="co"># Stratification variable</span></span>
<span id="cb125-41"><a href="model-diagnostics.html#cb125-41" tabindex="-1"></a>    <span class="at">weights =</span> pw_w4,     <span class="co"># Sampling weights</span></span>
<span id="cb125-42"><a href="model-diagnostics.html#cb125-42" tabindex="-1"></a>    <span class="at">nest =</span> <span class="cn">TRUE</span></span>
<span id="cb125-43"><a href="model-diagnostics.html#cb125-43" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb125-44"><a href="model-diagnostics.html#cb125-44" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">log_expenditure =</span> <span class="fu">log</span>(percapita_expenditure <span class="sc">+</span> <span class="dv">70</span>)) <span class="co"># Log transformation</span></span></code></pre></div>
<p>This block fits a <strong>linear regression model</strong> using the <code>svyglm()</code> function, where the dependent variable is the log of per capita expenditure. The model includes main effects and an interaction between area of residence and religion, as well as sex and age group. This structure allows for exploring how social and demographic factors influence individual spending levels in a statistically sound, design-aware manner.</p>
<div class="sourceCode" id="cb126"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb126-1"><a href="model-diagnostics.html#cb126-1" tabindex="-1"></a><span class="co">#------------------------------------------------------------------------------#</span></span>
<span id="cb126-2"><a href="model-diagnostics.html#cb126-2" tabindex="-1"></a><span class="co">#                     Estimating Survey-weighted Model                         #</span></span>
<span id="cb126-3"><a href="model-diagnostics.html#cb126-3" tabindex="-1"></a><span class="co">#------------------------------------------------------------------------------#</span></span>
<span id="cb126-4"><a href="model-diagnostics.html#cb126-4" tabindex="-1"></a></span>
<span id="cb126-5"><a href="model-diagnostics.html#cb126-5" tabindex="-1"></a><span class="co"># Define and estimate a survey-weighted regression model</span></span>
<span id="cb126-6"><a href="model-diagnostics.html#cb126-6" tabindex="-1"></a>EXP_model <span class="ot">&lt;-</span> <span class="fu">svyglm</span>(</span>
<span id="cb126-7"><a href="model-diagnostics.html#cb126-7" tabindex="-1"></a>  log_expenditure <span class="sc">~</span> <span class="dv">1</span> <span class="sc">+</span> Zone <span class="sc">*</span> Religion <span class="sc">+</span> Zone <span class="sc">+</span> Sex <span class="sc">+</span> age_group,</span>
<span id="cb126-8"><a href="model-diagnostics.html#cb126-8" tabindex="-1"></a>  <span class="at">design =</span> ESS4_design</span>
<span id="cb126-9"><a href="model-diagnostics.html#cb126-9" tabindex="-1"></a>)</span></code></pre></div>
<p>This block displays the statistical summary of the survey-weighted linear model fitted to the ESS4 data. The model examines how demographic and social characteristics—such as area of residence, religion, sex, and age group—are associated with the log of per capita expenditure. The output includes estimated coefficients, standard errors, t-values, and significance levels. Interaction terms between religion and area allow for testing whether religious spending patterns differ across urban and rural settings. The high statistical significance of several predictors confirms their importance in explaining spending behavior.</p>
<div class="sourceCode" id="cb127"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb127-1"><a href="model-diagnostics.html#cb127-1" tabindex="-1"></a><span class="co"># Display model summary and coefficients</span></span>
<span id="cb127-2"><a href="model-diagnostics.html#cb127-2" tabindex="-1"></a><span class="fu">summary</span>(EXP_model)</span></code></pre></div>
<pre><code>## 
## Call:
## svyglm(formula = log_expenditure ~ 1 + Zone * Religion + Zone + 
##     Sex + age_group, design = ESS4_design)
## 
## Survey design:
## Called via srvyr
## 
## Coefficients:
##                                    Estimate Std. Error t value Pr(&gt;|t|)    
## (Intercept)                         6.75103    0.06376 105.882  &lt; 2e-16 ***
## Zone2. URBAN                        0.62235    0.08999   6.916 1.43e-11 ***
## Religion2. CATHOLIC                -0.83665    0.33704  -2.482  0.01338 *  
## Religion3. PROTESTANT              -0.37824    0.09629  -3.928 9.76e-05 ***
## Religion4. MUSLEM                  -0.52809    0.08640  -6.112 1.98e-09 ***
## ReligionOTHER                      -0.27937    0.10867  -2.571  0.01043 *  
## Sex2. Female                       -0.06211    0.01450  -4.284 2.20e-05 ***
## age_group31-45                     -0.08358    0.02644  -3.161  0.00167 ** 
## age_group46-65                     -0.09009    0.03114  -2.893  0.00398 ** 
## age_group66 or more                -0.17498    0.06199  -2.823  0.00495 ** 
## Zone2. URBAN:Religion2. CATHOLIC    0.90298    0.39443   2.289  0.02248 *  
## Zone2. URBAN:Religion3. PROTESTANT  0.25355    0.13325   1.903  0.05763 .  
## Zone2. URBAN:Religion4. MUSLEM      0.16567    0.12553   1.320  0.18752    
## Zone2. URBAN:ReligionOTHER         -0.65549    0.28641  -2.289  0.02252 *  
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## (Dispersion parameter for gaussian family taken to be 0.7269917)
## 
## Number of Fisher Scoring iterations: 2</code></pre>
<p>The model shows that living in urban areas is associated with <strong>62% higher</strong> per capita spending, while women spend on average <strong>6% less</strong> than men. Religious differences are also notable: Catholics, Protestants, and Muslims show <strong>significantly lower</strong> spending compared to the reference group, although urban Catholics offset this with a <strong>+90%</strong> interaction effect. Spending decreases with age, particularly among those aged 66 and older (<strong>-17.5%</strong>). Urban–religion interactions suggest the urban advantage varies across religious groups.</p>
<div class="sourceCode" id="cb129"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb129-1"><a href="model-diagnostics.html#cb129-1" tabindex="-1"></a><span class="fu">tidy</span>(EXP_model) </span></code></pre></div>
<table class="table" style="width: auto !important; margin-left: auto; margin-right: auto;">
<thead>
<tr>
<th style="text-align:left;">
term
</th>
<th style="text-align:right;">
estimate
</th>
<th style="text-align:right;">
std.error
</th>
<th style="text-align:right;">
statistic
</th>
<th style="text-align:right;">
p.value
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;">
(Intercept)
</td>
<td style="text-align:right;">
6.7510301
</td>
<td style="text-align:right;">
0.0637599
</td>
<td style="text-align:right;">
105.882094
</td>
<td style="text-align:right;">
0.0000000
</td>
</tr>
<tr>
<td style="text-align:left;">
Zone2. URBAN
</td>
<td style="text-align:right;">
0.6223513
</td>
<td style="text-align:right;">
0.0899920
</td>
<td style="text-align:right;">
6.915629
</td>
<td style="text-align:right;">
0.0000000
</td>
</tr>
<tr>
<td style="text-align:left;">
Religion2. CATHOLIC
</td>
<td style="text-align:right;">
-0.8366462
</td>
<td style="text-align:right;">
0.3370375
</td>
<td style="text-align:right;">
-2.482353
</td>
<td style="text-align:right;">
0.0133789
</td>
</tr>
<tr>
<td style="text-align:left;">
Religion3. PROTESTANT
</td>
<td style="text-align:right;">
-0.3782428
</td>
<td style="text-align:right;">
0.0962860
</td>
<td style="text-align:right;">
-3.928327
</td>
<td style="text-align:right;">
0.0000976
</td>
</tr>
<tr>
<td style="text-align:left;">
Religion4. MUSLEM
</td>
<td style="text-align:right;">
-0.5280854
</td>
<td style="text-align:right;">
0.0864032
</td>
<td style="text-align:right;">
-6.111875
</td>
<td style="text-align:right;">
0.0000000
</td>
</tr>
<tr>
<td style="text-align:left;">
ReligionOTHER
</td>
<td style="text-align:right;">
-0.2793720
</td>
<td style="text-align:right;">
0.1086689
</td>
<td style="text-align:right;">
-2.570856
</td>
<td style="text-align:right;">
0.0104329
</td>
</tr>
<tr>
<td style="text-align:left;">
Sex2. Female
</td>
<td style="text-align:right;">
-0.0621092
</td>
<td style="text-align:right;">
0.0144976
</td>
<td style="text-align:right;">
-4.284105
</td>
<td style="text-align:right;">
0.0000220
</td>
</tr>
<tr>
<td style="text-align:left;">
age_group31-45
</td>
<td style="text-align:right;">
-0.0835824
</td>
<td style="text-align:right;">
0.0264417
</td>
<td style="text-align:right;">
-3.161011
</td>
<td style="text-align:right;">
0.0016676
</td>
</tr>
<tr>
<td style="text-align:left;">
age_group46-65
</td>
<td style="text-align:right;">
-0.0900876
</td>
<td style="text-align:right;">
0.0311394
</td>
<td style="text-align:right;">
-2.893044
</td>
<td style="text-align:right;">
0.0039817
</td>
</tr>
<tr>
<td style="text-align:left;">
age_group66 or more
</td>
<td style="text-align:right;">
-0.1749824
</td>
<td style="text-align:right;">
0.0619859
</td>
<td style="text-align:right;">
-2.822941
</td>
<td style="text-align:right;">
0.0049482
</td>
</tr>
<tr>
<td style="text-align:left;">
Zone2. URBAN:Religion2. CATHOLIC
</td>
<td style="text-align:right;">
0.9029832
</td>
<td style="text-align:right;">
0.3944289
</td>
<td style="text-align:right;">
2.289343
</td>
<td style="text-align:right;">
0.0224753
</td>
</tr>
<tr>
<td style="text-align:left;">
Zone2. URBAN:Religion3. PROTESTANT
</td>
<td style="text-align:right;">
0.2535506
</td>
<td style="text-align:right;">
0.1332460
</td>
<td style="text-align:right;">
1.902876
</td>
<td style="text-align:right;">
0.0576309
</td>
</tr>
<tr>
<td style="text-align:left;">
Zone2. URBAN:Religion4. MUSLEM
</td>
<td style="text-align:right;">
0.1656684
</td>
<td style="text-align:right;">
0.1255290
</td>
<td style="text-align:right;">
1.319762
</td>
<td style="text-align:right;">
0.1875183
</td>
</tr>
<tr>
<td style="text-align:left;">
Zone2. URBAN:ReligionOTHER
</td>
<td style="text-align:right;">
-0.6554855
</td>
<td style="text-align:right;">
0.2864145
</td>
<td style="text-align:right;">
-2.288591
</td>
<td style="text-align:right;">
0.0225194
</td>
</tr>
</tbody>
</table>
</div>
<div id="model-fit-r2-calculation" class="section level3 unnumbered hasAnchor">
<h3>Model Fit: <span class="math inline">\(R^2\)</span> Calculation<a href="model-diagnostics.html#model-fit-r2-calculation" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Here, the <strong>survey-adjusted R²</strong> is computed by comparing the fitted model to a null (intercept-only) model. Total variance and residual variance are extracted from each model summary, and <span class="math inline">\(R^2\)</span> is calculated as the proportion of variance explained by the model. This provides a sense of how well the independent variables explain differences in per capita expenditure.</p>
<div class="sourceCode" id="cb130"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb130-1"><a href="model-diagnostics.html#cb130-1" tabindex="-1"></a><span class="co">#------------------------------------------------------------------------------#</span></span>
<span id="cb130-2"><a href="model-diagnostics.html#cb130-2" tabindex="-1"></a><span class="co">#                   Model Fit: R² Calculation                                  #</span></span>
<span id="cb130-3"><a href="model-diagnostics.html#cb130-3" tabindex="-1"></a><span class="co">#------------------------------------------------------------------------------#</span></span>
<span id="cb130-4"><a href="model-diagnostics.html#cb130-4" tabindex="-1"></a></span>
<span id="cb130-5"><a href="model-diagnostics.html#cb130-5" tabindex="-1"></a><span class="co"># Fit a null model (intercept-only) for R² computation</span></span>
<span id="cb130-6"><a href="model-diagnostics.html#cb130-6" tabindex="-1"></a>null_model <span class="ot">&lt;-</span> <span class="fu">svyglm</span>(<span class="fu">log</span>(percapita_expenditure <span class="sc">+</span> <span class="dv">1</span>) <span class="sc">~</span> <span class="dv">1</span>, <span class="at">design =</span> ESS4_design)</span>
<span id="cb130-7"><a href="model-diagnostics.html#cb130-7" tabindex="-1"></a></span>
<span id="cb130-8"><a href="model-diagnostics.html#cb130-8" tabindex="-1"></a><span class="co"># Extract residual dispersion values</span></span>
<span id="cb130-9"><a href="model-diagnostics.html#cb130-9" tabindex="-1"></a>s1 <span class="ot">&lt;-</span> <span class="fu">summary</span>(EXP_model)</span>
<span id="cb130-10"><a href="model-diagnostics.html#cb130-10" tabindex="-1"></a>s0 <span class="ot">&lt;-</span> <span class="fu">summary</span>(null_model)</span>
<span id="cb130-11"><a href="model-diagnostics.html#cb130-11" tabindex="-1"></a></span>
<span id="cb130-12"><a href="model-diagnostics.html#cb130-12" tabindex="-1"></a><span class="co"># Compute weighted R² using total variance and residual variance</span></span>
<span id="cb130-13"><a href="model-diagnostics.html#cb130-13" tabindex="-1"></a>wSST <span class="ot">&lt;-</span> s0<span class="sc">$</span>dispersion  <span class="co"># Total variance</span></span>
<span id="cb130-14"><a href="model-diagnostics.html#cb130-14" tabindex="-1"></a>wSSE <span class="ot">&lt;-</span> s1<span class="sc">$</span>dispersion  <span class="co"># Residual variance</span></span>
<span id="cb130-15"><a href="model-diagnostics.html#cb130-15" tabindex="-1"></a></span>
<span id="cb130-16"><a href="model-diagnostics.html#cb130-16" tabindex="-1"></a>R2 <span class="ot">&lt;-</span> <span class="dv">1</span> <span class="sc">-</span> (wSSE <span class="sc">/</span> wSST)  <span class="co"># R² formula</span></span>
<span id="cb130-17"><a href="model-diagnostics.html#cb130-17" tabindex="-1"></a>R2  <span class="co"># Display computed R² value</span></span></code></pre></div>
<pre><code>##      variance     SE
## [1,]  0.43095 0.0345</code></pre>
</div>
<div id="standardized-residuals-analysis" class="section level3 unnumbered hasAnchor">
<h3>Standardized Residuals Analysis<a href="model-diagnostics.html#standardized-residuals-analysis" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>This block assesses the <strong>distribution of standardized residuals</strong> from the fitted model to check the assumption of normality. A histogram overlaid with a theoretical normal curve and a Q-Q plot (quantile–quantile plot) are generated. These visual tools help detect skewness, outliers, or departures from normality that could affect model validity.</p>
<div class="sourceCode" id="cb132"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb132-1"><a href="model-diagnostics.html#cb132-1" tabindex="-1"></a><span class="co">#------------------------------------------------------------------------------#</span></span>
<span id="cb132-2"><a href="model-diagnostics.html#cb132-2" tabindex="-1"></a><span class="co">#                     Standardized Residuals Analysis                          #</span></span>
<span id="cb132-3"><a href="model-diagnostics.html#cb132-3" tabindex="-1"></a><span class="co">#------------------------------------------------------------------------------#</span></span>
<span id="cb132-4"><a href="model-diagnostics.html#cb132-4" tabindex="-1"></a></span>
<span id="cb132-5"><a href="model-diagnostics.html#cb132-5" tabindex="-1"></a><span class="co"># Compute standardized residuals from the model</span></span>
<span id="cb132-6"><a href="model-diagnostics.html#cb132-6" tabindex="-1"></a>stdresids <span class="ot">&lt;-</span> <span class="fu">as.numeric</span>(<span class="fu">svystdres</span>(EXP_model)<span class="sc">$</span>stdresids)</span>
<span id="cb132-7"><a href="model-diagnostics.html#cb132-7" tabindex="-1"></a></span>
<span id="cb132-8"><a href="model-diagnostics.html#cb132-8" tabindex="-1"></a><span class="co"># Attach residuals to the dataset</span></span>
<span id="cb132-9"><a href="model-diagnostics.html#cb132-9" tabindex="-1"></a><span class="co"># ESS4_design$variables %&lt;&gt;% mutate(stdresids = stdresids)</span></span>
<span id="cb132-10"><a href="model-diagnostics.html#cb132-10" tabindex="-1"></a></span>
<span id="cb132-11"><a href="model-diagnostics.html#cb132-11" tabindex="-1"></a><span class="co"># Histogram of standardized residuals</span></span>
<span id="cb132-12"><a href="model-diagnostics.html#cb132-12" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> <span class="fu">data.frame</span>(stdresids), <span class="fu">aes</span>(<span class="at">x =</span> stdresids)) <span class="sc">+</span></span>
<span id="cb132-13"><a href="model-diagnostics.html#cb132-13" tabindex="-1"></a>  <span class="fu">geom_histogram</span>(</span>
<span id="cb132-14"><a href="model-diagnostics.html#cb132-14" tabindex="-1"></a>    <span class="fu">aes</span>(<span class="at">y =</span> ..density..),</span>
<span id="cb132-15"><a href="model-diagnostics.html#cb132-15" tabindex="-1"></a>    <span class="at">bins =</span> <span class="dv">30</span>,</span>
<span id="cb132-16"><a href="model-diagnostics.html#cb132-16" tabindex="-1"></a>    <span class="at">fill =</span> <span class="st">&quot;#CCE5FF&quot;</span>,</span>
<span id="cb132-17"><a href="model-diagnostics.html#cb132-17" tabindex="-1"></a>    <span class="at">color =</span> <span class="st">&quot;black&quot;</span></span>
<span id="cb132-18"><a href="model-diagnostics.html#cb132-18" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb132-19"><a href="model-diagnostics.html#cb132-19" tabindex="-1"></a>  <span class="fu">stat_function</span>(</span>
<span id="cb132-20"><a href="model-diagnostics.html#cb132-20" tabindex="-1"></a>    <span class="at">fun =</span> dnorm,</span>
<span id="cb132-21"><a href="model-diagnostics.html#cb132-21" tabindex="-1"></a>    <span class="at">args =</span> <span class="fu">list</span>(<span class="at">mean =</span> <span class="dv">0</span>, <span class="at">sd =</span> <span class="dv">1</span>),</span>
<span id="cb132-22"><a href="model-diagnostics.html#cb132-22" tabindex="-1"></a>    <span class="at">color =</span> <span class="st">&quot;black&quot;</span>,</span>
<span id="cb132-23"><a href="model-diagnostics.html#cb132-23" tabindex="-1"></a>    <span class="at">size =</span> <span class="dv">1</span></span>
<span id="cb132-24"><a href="model-diagnostics.html#cb132-24" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb132-25"><a href="model-diagnostics.html#cb132-25" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">&quot;Standardized Residuals&quot;</span>, <span class="at">x =</span> <span class="st">&quot;Residuals&quot;</span>, <span class="at">y =</span> <span class="st">&quot;Density&quot;</span>) <span class="sc">+</span></span>
<span id="cb132-26"><a href="model-diagnostics.html#cb132-26" tabindex="-1"></a>  <span class="fu">theme_minimal</span>(<span class="at">base_size =</span> <span class="dv">20</span>) <span class="sc">+</span></span>
<span id="cb132-27"><a href="model-diagnostics.html#cb132-27" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">hjust =</span> <span class="fl">0.5</span>))</span></code></pre></div>
<p><img src="images/5.5/01_standardized_residuals.png" /></p>
<div class="sourceCode" id="cb133"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb133-1"><a href="model-diagnostics.html#cb133-1" tabindex="-1"></a><span class="co"># Q-Q plot to assess normality of residuals</span></span>
<span id="cb133-2"><a href="model-diagnostics.html#cb133-2" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> <span class="fu">data.frame</span>(stdresids), <span class="fu">aes</span>(<span class="at">sample =</span> stdresids)) <span class="sc">+</span></span>
<span id="cb133-3"><a href="model-diagnostics.html#cb133-3" tabindex="-1"></a>  <span class="fu">stat_qq</span>() <span class="sc">+</span></span>
<span id="cb133-4"><a href="model-diagnostics.html#cb133-4" tabindex="-1"></a>  <span class="fu">stat_qq_line</span>(<span class="at">color =</span> <span class="st">&quot;red&quot;</span>) <span class="sc">+</span></span>
<span id="cb133-5"><a href="model-diagnostics.html#cb133-5" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">&quot;Q-Q Plot of Standardized Residuals&quot;</span>,</span>
<span id="cb133-6"><a href="model-diagnostics.html#cb133-6" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">&quot;Theoretical Quantiles&quot;</span>, <span class="at">y =</span> <span class="st">&quot;Sample Quantiles&quot;</span>) <span class="sc">+</span></span>
<span id="cb133-7"><a href="model-diagnostics.html#cb133-7" tabindex="-1"></a>  <span class="fu">theme_minimal</span>(<span class="at">base_size =</span> <span class="dv">20</span>)<span class="sc">+</span></span>
<span id="cb133-8"><a href="model-diagnostics.html#cb133-8" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">hjust =</span> <span class="fl">0.5</span>))</span></code></pre></div>
<p><img src="images/5.5/02_qqplot.png" /></p>
</div>
<div id="influential-observations" class="section level3 unnumbered hasAnchor">
<h3>Influential Observations<a href="model-diagnostics.html#influential-observations" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<div id="cooks-distance" class="section level4 unnumbered hasAnchor">
<h4>Cook’s Distance<a href="model-diagnostics.html#cooks-distance" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>This part computes <strong>Cook’s Distance</strong> to detect observations that have a disproportionate influence on the model’s parameter estimates. Observations exceeding a threshold (e.g., &gt;3) are flagged as influential and visualized in a scatter plot, with red dots indicating high influence.</p>
<div class="sourceCode" id="cb134"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb134-1"><a href="model-diagnostics.html#cb134-1" tabindex="-1"></a><span class="co">#------------------------------------------------------------------------------#</span></span>
<span id="cb134-2"><a href="model-diagnostics.html#cb134-2" tabindex="-1"></a><span class="co">#                         Influential Observations                             #</span></span>
<span id="cb134-3"><a href="model-diagnostics.html#cb134-3" tabindex="-1"></a><span class="co">#------------------------------------------------------------------------------#</span></span>
<span id="cb134-4"><a href="model-diagnostics.html#cb134-4" tabindex="-1"></a></span>
<span id="cb134-5"><a href="model-diagnostics.html#cb134-5" tabindex="-1"></a><span class="co">#---------------------#</span></span>
<span id="cb134-6"><a href="model-diagnostics.html#cb134-6" tabindex="-1"></a><span class="co"># Cook&#39;s Distance     #</span></span>
<span id="cb134-7"><a href="model-diagnostics.html#cb134-7" tabindex="-1"></a><span class="co">#---------------------#</span></span>
<span id="cb134-8"><a href="model-diagnostics.html#cb134-8" tabindex="-1"></a></span>
<span id="cb134-9"><a href="model-diagnostics.html#cb134-9" tabindex="-1"></a><span class="co"># Compute Cook&#39;s Distance and flag influential observations</span></span>
<span id="cb134-10"><a href="model-diagnostics.html#cb134-10" tabindex="-1"></a>CooksD <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb134-11"><a href="model-diagnostics.html#cb134-11" tabindex="-1"></a>  <span class="at">cook =</span> <span class="fu">svyCooksD</span>(EXP_model),</span>
<span id="cb134-12"><a href="model-diagnostics.html#cb134-12" tabindex="-1"></a>  <span class="at">id =</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(<span class="fu">svyCooksD</span>(EXP_model))</span>
<span id="cb134-13"><a href="model-diagnostics.html#cb134-13" tabindex="-1"></a>) <span class="sc">%&gt;%</span></span>
<span id="cb134-14"><a href="model-diagnostics.html#cb134-14" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Criterion =</span> <span class="fu">ifelse</span>(cook <span class="sc">&gt;</span> <span class="dv">3</span>, <span class="st">&quot;Yes&quot;</span>, <span class="st">&quot;No&quot;</span>))</span>
<span id="cb134-15"><a href="model-diagnostics.html#cb134-15" tabindex="-1"></a></span>
<span id="cb134-16"><a href="model-diagnostics.html#cb134-16" tabindex="-1"></a><span class="co"># Scatter plot of Cook&#39;s Distance</span></span>
<span id="cb134-17"><a href="model-diagnostics.html#cb134-17" tabindex="-1"></a><span class="fu">ggplot</span>(CooksD, <span class="fu">aes</span>(<span class="at">y =</span> cook, <span class="at">x =</span> id)) <span class="sc">+</span></span>
<span id="cb134-18"><a href="model-diagnostics.html#cb134-18" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="fu">aes</span>(<span class="at">col =</span> Criterion)) <span class="sc">+</span></span>
<span id="cb134-19"><a href="model-diagnostics.html#cb134-19" tabindex="-1"></a>  <span class="fu">geom_hline</span>(<span class="fu">aes</span>(<span class="at">yintercept =</span> <span class="dv">3</span>), <span class="at">color =</span> <span class="st">&quot;black&quot;</span>, <span class="at">linetype =</span> <span class="st">&quot;dashed&quot;</span>) <span class="sc">+</span></span>
<span id="cb134-20"><a href="model-diagnostics.html#cb134-20" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">&quot;Yes&quot;</span> <span class="ot">=</span> <span class="st">&quot;red&quot;</span>, <span class="st">&quot;No&quot;</span> <span class="ot">=</span> <span class="st">&quot;black&quot;</span>)) <span class="sc">+</span></span>
<span id="cb134-21"><a href="model-diagnostics.html#cb134-21" tabindex="-1"></a>  <span class="fu">theme_minimal</span>(<span class="at">base_size =</span> <span class="dv">20</span>) <span class="sc">+</span></span>
<span id="cb134-22"><a href="model-diagnostics.html#cb134-22" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">&quot;Cook&#39;s Distance&quot;</span>, <span class="at">x =</span> <span class="st">&quot;Observation ID&quot;</span>, <span class="at">y =</span> <span class="st">&quot;Cook&#39;s D&quot;</span>)</span></code></pre></div>
<p><img src="images/5.5/03_Cook_Distance.png" /></p>
</div>
<div id="dfbetas" class="section level4 unnumbered hasAnchor">
<h4>DFBETAS<a href="model-diagnostics.html#dfbetas" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>The <strong>DFBETAS</strong> analysis measures how much each coefficient would change if a specific observation were removed. The values are reshaped into long format and plotted with facets, one for each model term. Observations above the threshold are flagged as influential, offering insight into which points affect specific parameters.</p>
<div class="sourceCode" id="cb135"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb135-1"><a href="model-diagnostics.html#cb135-1" tabindex="-1"></a><span class="co">#---------------------#</span></span>
<span id="cb135-2"><a href="model-diagnostics.html#cb135-2" tabindex="-1"></a><span class="co"># DFBETAS Analysis    #</span></span>
<span id="cb135-3"><a href="model-diagnostics.html#cb135-3" tabindex="-1"></a><span class="co">#---------------------#</span></span>
<span id="cb135-4"><a href="model-diagnostics.html#cb135-4" tabindex="-1"></a></span>
<span id="cb135-5"><a href="model-diagnostics.html#cb135-5" tabindex="-1"></a><span class="co"># Compute DFBETAS for all model coefficients</span></span>
<span id="cb135-6"><a href="model-diagnostics.html#cb135-6" tabindex="-1"></a>d_dfbetas <span class="ot">&lt;-</span> <span class="fu">svydfbetas</span>(EXP_model)<span class="sc">$</span>Dfbetas <span class="sc">%&gt;%</span></span>
<span id="cb135-7"><a href="model-diagnostics.html#cb135-7" tabindex="-1"></a>  <span class="fu">t</span>() <span class="sc">%&gt;%</span></span>
<span id="cb135-8"><a href="model-diagnostics.html#cb135-8" tabindex="-1"></a>  <span class="fu">as.data.frame</span>()</span>
<span id="cb135-9"><a href="model-diagnostics.html#cb135-9" tabindex="-1"></a></span>
<span id="cb135-10"><a href="model-diagnostics.html#cb135-10" tabindex="-1"></a><span class="co"># Rename DFBETAS columns</span></span>
<span id="cb135-11"><a href="model-diagnostics.html#cb135-11" tabindex="-1"></a><span class="fu">colnames</span>(d_dfbetas) <span class="ot">&lt;-</span> <span class="fu">paste0</span>(<span class="st">&quot;beta[&quot;</span>, <span class="fu">seq_len</span>(<span class="fu">ncol</span>(d_dfbetas)) <span class="sc">-</span> <span class="dv">1</span>, <span class="st">&quot;]&quot;</span>)</span>
<span id="cb135-12"><a href="model-diagnostics.html#cb135-12" tabindex="-1"></a></span>
<span id="cb135-13"><a href="model-diagnostics.html#cb135-13" tabindex="-1"></a><span class="co"># Convert DFBETAS to long format</span></span>
<span id="cb135-14"><a href="model-diagnostics.html#cb135-14" tabindex="-1"></a>d_dfbetas_long <span class="ot">&lt;-</span> d_dfbetas <span class="sc">%&gt;%</span></span>
<span id="cb135-15"><a href="model-diagnostics.html#cb135-15" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">id =</span> <span class="fu">row_number</span>()) <span class="sc">%&gt;%</span></span>
<span id="cb135-16"><a href="model-diagnostics.html#cb135-16" tabindex="-1"></a>  <span class="fu">pivot_longer</span>(<span class="at">cols =</span> <span class="sc">-</span>id, <span class="at">names_to =</span> <span class="st">&quot;Variable&quot;</span>, <span class="at">values_to =</span> <span class="st">&quot;value&quot;</span>)</span>
<span id="cb135-17"><a href="model-diagnostics.html#cb135-17" tabindex="-1"></a></span>
<span id="cb135-18"><a href="model-diagnostics.html#cb135-18" tabindex="-1"></a><span class="co"># Get threshold for influential observations</span></span>
<span id="cb135-19"><a href="model-diagnostics.html#cb135-19" tabindex="-1"></a>cutoff <span class="ot">&lt;-</span> <span class="fu">svydfbetas</span>(EXP_model)<span class="sc">$</span>cutoff</span>
<span id="cb135-20"><a href="model-diagnostics.html#cb135-20" tabindex="-1"></a></span>
<span id="cb135-21"><a href="model-diagnostics.html#cb135-21" tabindex="-1"></a><span class="co"># Flag influential observations</span></span>
<span id="cb135-22"><a href="model-diagnostics.html#cb135-22" tabindex="-1"></a>d_dfbetas_long <span class="ot">&lt;-</span> d_dfbetas_long <span class="sc">%&gt;%</span></span>
<span id="cb135-23"><a href="model-diagnostics.html#cb135-23" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Criterion =</span> <span class="fu">ifelse</span>(<span class="fu">abs</span>(value) <span class="sc">&gt;</span> cutoff, <span class="st">&quot;Yes&quot;</span>, <span class="st">&quot;No&quot;</span>))</span></code></pre></div>
<div class="sourceCode" id="cb136"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb136-1"><a href="model-diagnostics.html#cb136-1" tabindex="-1"></a><span class="co"># Plot DFBETAS</span></span>
<span id="cb136-2"><a href="model-diagnostics.html#cb136-2" tabindex="-1"></a><span class="fu">ggplot</span>(d_dfbetas_long ,</span>
<span id="cb136-3"><a href="model-diagnostics.html#cb136-3" tabindex="-1"></a>       <span class="fu">aes</span>(<span class="at">y =</span> <span class="fu">abs</span>(value), <span class="at">x =</span> id)) <span class="sc">+</span></span>
<span id="cb136-4"><a href="model-diagnostics.html#cb136-4" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="fu">aes</span>(<span class="at">color =</span> Criterion)) <span class="sc">+</span></span>
<span id="cb136-5"><a href="model-diagnostics.html#cb136-5" tabindex="-1"></a>  <span class="fu">geom_hline</span>(<span class="fu">aes</span>(<span class="at">yintercept =</span> cutoff), <span class="at">linetype =</span> <span class="st">&quot;dashed&quot;</span>) <span class="sc">+</span></span>
<span id="cb136-6"><a href="model-diagnostics.html#cb136-6" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(. <span class="sc">~</span> Variable, <span class="at">nrow =</span> <span class="dv">4</span>, <span class="at">scales =</span> <span class="st">&quot;free_y&quot;</span>) <span class="sc">+</span></span>
<span id="cb136-7"><a href="model-diagnostics.html#cb136-7" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">&quot;Yes&quot;</span> <span class="ot">=</span> <span class="st">&quot;red&quot;</span>, <span class="st">&quot;No&quot;</span> <span class="ot">=</span> <span class="st">&quot;black&quot;</span>)) <span class="sc">+</span></span>
<span id="cb136-8"><a href="model-diagnostics.html#cb136-8" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">&quot;DFBETAS Analysis&quot;</span>, <span class="at">x =</span> <span class="st">&quot;Observation ID&quot;</span>, <span class="at">y =</span> <span class="fu">expression</span>(<span class="fu">abs</span>(beta))) <span class="sc">+</span></span>
<span id="cb136-9"><a href="model-diagnostics.html#cb136-9" tabindex="-1"></a>  <span class="fu">theme_minimal</span>(<span class="at">base_size =</span> <span class="dv">20</span>)</span></code></pre></div>
<p><img src="images/5.5/04_DFBETAS.png" /></p>
</div>
<div id="dffits" class="section level4 unnumbered hasAnchor">
<h4>DFFITS<a href="model-diagnostics.html#dffits" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>This section calculates <strong>DFFITS</strong>, which assesses the influence of each observation on its own predicted value. Observations with high DFFITS are flagged and visualized in a scatter plot, helping identify cases that disproportionately affect fitted values.</p>
<div class="sourceCode" id="cb137"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb137-1"><a href="model-diagnostics.html#cb137-1" tabindex="-1"></a><span class="co">#---------------------#</span></span>
<span id="cb137-2"><a href="model-diagnostics.html#cb137-2" tabindex="-1"></a><span class="co"># DFFITS Analysis     #</span></span>
<span id="cb137-3"><a href="model-diagnostics.html#cb137-3" tabindex="-1"></a><span class="co">#---------------------#</span></span>
<span id="cb137-4"><a href="model-diagnostics.html#cb137-4" tabindex="-1"></a></span>
<span id="cb137-5"><a href="model-diagnostics.html#cb137-5" tabindex="-1"></a><span class="co"># Compute DFFITS values</span></span>
<span id="cb137-6"><a href="model-diagnostics.html#cb137-6" tabindex="-1"></a>d_dffits <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb137-7"><a href="model-diagnostics.html#cb137-7" tabindex="-1"></a>  <span class="at">dffits =</span> <span class="fu">svydffits</span>(EXP_model)<span class="sc">$</span>Dffits,</span>
<span id="cb137-8"><a href="model-diagnostics.html#cb137-8" tabindex="-1"></a>  <span class="at">id =</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(<span class="fu">svydffits</span>(EXP_model)<span class="sc">$</span>Dffits)</span>
<span id="cb137-9"><a href="model-diagnostics.html#cb137-9" tabindex="-1"></a>)</span>
<span id="cb137-10"><a href="model-diagnostics.html#cb137-10" tabindex="-1"></a></span>
<span id="cb137-11"><a href="model-diagnostics.html#cb137-11" tabindex="-1"></a><span class="co"># Get influence threshold</span></span>
<span id="cb137-12"><a href="model-diagnostics.html#cb137-12" tabindex="-1"></a>cutoff <span class="ot">&lt;-</span> <span class="fu">svydffits</span>(EXP_model)<span class="sc">$</span>cutoff</span>
<span id="cb137-13"><a href="model-diagnostics.html#cb137-13" tabindex="-1"></a></span>
<span id="cb137-14"><a href="model-diagnostics.html#cb137-14" tabindex="-1"></a><span class="co"># Flag influential observations</span></span>
<span id="cb137-15"><a href="model-diagnostics.html#cb137-15" tabindex="-1"></a>d_dffits <span class="ot">&lt;-</span> d_dffits <span class="sc">%&gt;%</span></span>
<span id="cb137-16"><a href="model-diagnostics.html#cb137-16" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Criterion =</span> <span class="fu">ifelse</span>(<span class="fu">abs</span>(dffits) <span class="sc">&gt;</span> cutoff, <span class="st">&quot;Yes&quot;</span>, <span class="st">&quot;No&quot;</span>))</span></code></pre></div>
<div class="sourceCode" id="cb138"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb138-1"><a href="model-diagnostics.html#cb138-1" tabindex="-1"></a><span class="co"># Plot DFFITS values</span></span>
<span id="cb138-2"><a href="model-diagnostics.html#cb138-2" tabindex="-1"></a><span class="fu">ggplot</span>(d_dffits, <span class="fu">aes</span>(<span class="at">y =</span> <span class="fu">abs</span>(dffits), <span class="at">x =</span> id)) <span class="sc">+</span></span>
<span id="cb138-3"><a href="model-diagnostics.html#cb138-3" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="fu">aes</span>(<span class="at">color =</span> Criterion)) <span class="sc">+</span></span>
<span id="cb138-4"><a href="model-diagnostics.html#cb138-4" tabindex="-1"></a>  <span class="fu">geom_hline</span>(<span class="at">yintercept =</span> cutoff, <span class="at">linetype =</span> <span class="st">&quot;dashed&quot;</span>, <span class="at">color =</span> <span class="st">&quot;black&quot;</span>) <span class="sc">+</span></span>
<span id="cb138-5"><a href="model-diagnostics.html#cb138-5" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">&quot;Yes&quot;</span> <span class="ot">=</span> <span class="st">&quot;red&quot;</span>, <span class="st">&quot;No&quot;</span> <span class="ot">=</span> <span class="st">&quot;black&quot;</span>)) <span class="sc">+</span></span>
<span id="cb138-6"><a href="model-diagnostics.html#cb138-6" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">&quot;DFFITS Influence Analysis&quot;</span>, <span class="at">x =</span> <span class="st">&quot;Observation ID&quot;</span>, <span class="at">y =</span> <span class="fu">expression</span>(<span class="fu">abs</span>(DFFITS))) <span class="sc">+</span></span>
<span id="cb138-7"><a href="model-diagnostics.html#cb138-7" tabindex="-1"></a>  <span class="fu">theme_minimal</span>(<span class="at">base_size =</span> <span class="dv">20</span>)</span></code></pre></div>
<p><img src="images/5.5/05_DFFITS.png" /></p>

</div>
</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="working-with-weights.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="inference-on-model-parameters.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": true,
"facebook": false,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"whatsapp": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": "https://github.com/psirusteam/chapter9Rcodes/5.5_Model_Diagnostics.rmd",
"text": "Edit"
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": ["CHAPTER 9 - EXAMPLES IN R.pdf", "CHAPTER 9 - EXAMPLES IN R.epub", "CHAPTER 9 - EXAMPLES IN R.mobi"],
"search": {
"engine": "fuse",
"options": null
},
"toc": {
"collapse": "section"
},
"tconfig": null
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.9/latest.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
