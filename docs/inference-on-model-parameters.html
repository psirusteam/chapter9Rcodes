<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>5.6 Inference on Model Parameters | CHAPTER 9 - EXAMPLES IN R</title>
  <meta name="description" content="5.6 Inference on Model Parameters | CHAPTER 9 - EXAMPLES IN R" />
  <meta name="generator" content="bookdown 0.42 and GitBook 2.6.7" />

  <meta property="og:title" content="5.6 Inference on Model Parameters | CHAPTER 9 - EXAMPLES IN R" />
  <meta property="og:type" content="book" />
  
  <meta property="og:description" content="5.6 Inference on Model Parameters | CHAPTER 9 - EXAMPLES IN R" />
  <meta name="github-repo" content="psirusteam/chapter9Rcodes" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="5.6 Inference on Model Parameters | CHAPTER 9 - EXAMPLES IN R" />
  
  <meta name="twitter:description" content="5.6 Inference on Model Parameters | CHAPTER 9 - EXAMPLES IN R" />
  

<meta name="author" content="" />


<meta name="date" content="2025-03-25" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="model-diagnostics.html"/>
<link rel="next" href="bar-charts.html"/>
<script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.6/dist/fuse.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />








<link href="libs/anchor-sections-1.1.0/anchor-sections.css" rel="stylesheet" />
<link href="libs/anchor-sections-1.1.0/anchor-sections-hash.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.1.0/anchor-sections.js"></script>
<script src="libs/kePrint-0.0.1/kePrint.js"></script>
<link href="libs/lightable-0.0.1/lightable.css" rel="stylesheet" />


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { color: #008000; } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { color: #008000; font-weight: bold; } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<style type="text/css">
  
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">CHAPTER 9 - EXAMPLES IN R</a></li>

<li class="divider"></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>Abstract</a></li>
<li class="chapter" data-level="" data-path="accounting-for-the-sampling-design.html"><a href="accounting-for-the-sampling-design.html"><i class="fa fa-check"></i>Accounting for the Sampling Design</a>
<ul>
<li class="chapter" data-level="" data-path="sample-design-of-the-ess4-20182019.html"><a href="sample-design-of-the-ess4-20182019.html"><i class="fa fa-check"></i>Sample design of the ESS4 2018/2019</a></li>
<li class="chapter" data-level="" data-path="data-source.html"><a href="data-source.html"><i class="fa fa-check"></i>Data Source</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="using-software-to-generate-valid-inferences.html"><a href="using-software-to-generate-valid-inferences.html"><i class="fa fa-check"></i>2.3 Using Software to Generate Valid Inferences</a>
<ul>
<li class="chapter" data-level="" data-path="using-software-to-generate-valid-inferences.html"><a href="using-software-to-generate-valid-inferences.html#prepare-the-work-environment"><i class="fa fa-check"></i>Prepare the work environment</a></li>
<li class="chapter" data-level="" data-path="using-software-to-generate-valid-inferences.html"><a href="using-software-to-generate-valid-inferences.html#loading-datasets"><i class="fa fa-check"></i>Loading Datasets</a></li>
<li class="chapter" data-level="" data-path="using-software-to-generate-valid-inferences.html"><a href="using-software-to-generate-valid-inferences.html#defining-the-survey-design"><i class="fa fa-check"></i>Defining the survey design</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="frequencies-and-proportions.html"><a href="frequencies-and-proportions.html"><i class="fa fa-check"></i>3.1 Frequencies and Proportions</a>
<ul>
<li class="chapter" data-level="" data-path="frequencies-and-proportions.html"><a href="frequencies-and-proportions.html#prepare-the-work-environment-1"><i class="fa fa-check"></i>Prepare the work environment</a></li>
<li class="chapter" data-level="" data-path="frequencies-and-proportions.html"><a href="frequencies-and-proportions.html#estimating-totals-and-proportions"><i class="fa fa-check"></i>Estimating totals and proportions</a></li>
<li class="chapter" data-level="" data-path="frequencies-and-proportions.html"><a href="frequencies-and-proportions.html#formatting-and-presenting-results"><i class="fa fa-check"></i>Formatting and presenting results</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="totals-means-and-ratios.html"><a href="totals-means-and-ratios.html"><i class="fa fa-check"></i>3.2 Totals, means and ratios</a>
<ul>
<li class="chapter" data-level="" data-path="totals-means-and-ratios.html"><a href="totals-means-and-ratios.html#prepare-the-work-environment-2"><i class="fa fa-check"></i>Prepare the work environment</a></li>
<li class="chapter" data-level="" data-path="totals-means-and-ratios.html"><a href="totals-means-and-ratios.html#estimation-of-totals-and-means"><i class="fa fa-check"></i>Estimation of totals and means</a></li>
<li class="chapter" data-level="" data-path="totals-means-and-ratios.html"><a href="totals-means-and-ratios.html#estimation-of-ratio"><i class="fa fa-check"></i>Estimation of Ratio</a></li>
<li class="chapter" data-level="" data-path="totals-means-and-ratios.html"><a href="totals-means-and-ratios.html#estimating-the-ratio-of-educational-expenditure"><i class="fa fa-check"></i>Estimating the Ratio of Educational Expenditure</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="correlations.html"><a href="correlations.html"><i class="fa fa-check"></i>3.3 Correlations</a>
<ul>
<li class="chapter" data-level="" data-path="correlations.html"><a href="correlations.html#prepare-the-work-environment-3"><i class="fa fa-check"></i>Prepare the work environment</a></li>
<li class="chapter" data-level="" data-path="correlations.html"><a href="correlations.html#estimating-correlations"><i class="fa fa-check"></i>Estimating Correlations</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="percentiles-and-inequality-measures.html"><a href="percentiles-and-inequality-measures.html"><i class="fa fa-check"></i>3.4 Percentiles and inequality measures</a>
<ul>
<li class="chapter" data-level="" data-path="percentiles-and-inequality-measures.html"><a href="percentiles-and-inequality-measures.html#prepare-the-work-environment-4"><i class="fa fa-check"></i>Prepare the work environment</a></li>
<li class="chapter" data-level="" data-path="percentiles-and-inequality-measures.html"><a href="percentiles-and-inequality-measures.html#estimating-the-mean-and-median-of-total-other-income"><i class="fa fa-check"></i>Estimating the Mean and Median of Total Other Income</a></li>
<li class="chapter" data-level="" data-path="percentiles-and-inequality-measures.html"><a href="percentiles-and-inequality-measures.html#the-gini-coefficient."><i class="fa fa-check"></i>The Gini Coefficient.</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="cross-tabulations.html"><a href="cross-tabulations.html"><i class="fa fa-check"></i>4.2 Cross-tabulations</a>
<ul>
<li class="chapter" data-level="" data-path="cross-tabulations.html"><a href="cross-tabulations.html#prepare-the-work-environment-5"><i class="fa fa-check"></i>Prepare the work environment</a></li>
<li class="chapter" data-level="" data-path="cross-tabulations.html"><a href="cross-tabulations.html#processing-variables-for-analysis"><i class="fa fa-check"></i>Processing Variables for Analysis</a></li>
<li class="chapter" data-level="" data-path="cross-tabulations.html"><a href="cross-tabulations.html#estimating-proportions-and-totals-by-religion"><i class="fa fa-check"></i>Estimating Proportions and Totals by Religion</a></li>
<li class="chapter" data-level="" data-path="cross-tabulations.html"><a href="cross-tabulations.html#formatting-and-displaying-cross-tabulation-tables"><i class="fa fa-check"></i>Formatting and Displaying Cross-tabulation Tables</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="testing-for-independence.html"><a href="testing-for-independence.html"><i class="fa fa-check"></i>4.3 Testing for Independence</a>
<ul>
<li class="chapter" data-level="" data-path="testing-for-independence.html"><a href="testing-for-independence.html#prepare-the-work-environment-6"><i class="fa fa-check"></i>Prepare the work environment</a></li>
<li class="chapter" data-level="" data-path="testing-for-independence.html"><a href="testing-for-independence.html#processing-education-variables"><i class="fa fa-check"></i>Processing Education Variables</a></li>
<li class="chapter" data-level="" data-path="testing-for-independence.html"><a href="testing-for-independence.html#testing-for-independence-1"><i class="fa fa-check"></i>Testing for Independence</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="tests-for-group-comparisons.html"><a href="tests-for-group-comparisons.html"><i class="fa fa-check"></i>4.4 Tests for Group Comparisons</a>
<ul>
<li class="chapter" data-level="" data-path="tests-for-group-comparisons.html"><a href="tests-for-group-comparisons.html#prepare-the-work-environment-7"><i class="fa fa-check"></i>Prepare the work environment</a></li>
<li class="chapter" data-level="" data-path="tests-for-group-comparisons.html"><a href="tests-for-group-comparisons.html#conducting-group-comparisons-on-expenditure"><i class="fa fa-check"></i>Conducting Group Comparisons on expenditure</a></li>
<li class="chapter" data-level="" data-path="tests-for-group-comparisons.html"><a href="tests-for-group-comparisons.html#hypothesis-testing-for-group-comparisons"><i class="fa fa-check"></i>Hypothesis Testing for Group Comparisons</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="linear-models.html"><a href="linear-models.html"><i class="fa fa-check"></i>5.3 Linear Models</a>
<ul>
<li class="chapter" data-level="" data-path="linear-models.html"><a href="linear-models.html#prepare-the-work-environment-8"><i class="fa fa-check"></i>Prepare the work environment</a></li>
<li class="chapter" data-level="" data-path="linear-models.html"><a href="linear-models.html#processing-demographic-information"><i class="fa fa-check"></i>Processing Demographic Information</a></li>
<li class="chapter" data-level="" data-path="linear-models.html"><a href="linear-models.html#estimating-linear-models"><i class="fa fa-check"></i>Estimating Linear Models</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="working-with-weights.html"><a href="working-with-weights.html"><i class="fa fa-check"></i>5.4 Working with Weights</a>
<ul>
<li class="chapter" data-level="" data-path="working-with-weights.html"><a href="working-with-weights.html#prepare-the-work-environment-9"><i class="fa fa-check"></i>Prepare the work environment</a></li>
<li class="chapter" data-level="" data-path="working-with-weights.html"><a href="working-with-weights.html#descriptive-analysis"><i class="fa fa-check"></i>Descriptive Analysis</a></li>
<li class="chapter" data-level="" data-path="working-with-weights.html"><a href="working-with-weights.html#defining-survey-designs"><i class="fa fa-check"></i>Defining Survey Designs</a></li>
<li class="chapter" data-level="" data-path="working-with-weights.html"><a href="working-with-weights.html#estimating-linear-models-1"><i class="fa fa-check"></i>Estimating Linear Models</a></li>
<li class="chapter" data-level="" data-path="working-with-weights.html"><a href="working-with-weights.html#display-regression-results"><i class="fa fa-check"></i>Display regression results</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="model-diagnostics.html"><a href="model-diagnostics.html"><i class="fa fa-check"></i>5.5 Model Diagnostics</a>
<ul>
<li class="chapter" data-level="" data-path="model-diagnostics.html"><a href="model-diagnostics.html#prepare-the-work-environment-10"><i class="fa fa-check"></i>Prepare the work environment</a></li>
<li class="chapter" data-level="" data-path="model-diagnostics.html"><a href="model-diagnostics.html#model-fit-r2-calculation"><i class="fa fa-check"></i>Model Fit: <span class="math inline">\(R^2\)</span> Calculation</a></li>
<li class="chapter" data-level="" data-path="model-diagnostics.html"><a href="model-diagnostics.html#standardized-residuals-analysis"><i class="fa fa-check"></i>Standardized Residuals Analysis</a></li>
<li class="chapter" data-level="" data-path="model-diagnostics.html"><a href="model-diagnostics.html#influential-observations"><i class="fa fa-check"></i>Influential Observations</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="inference-on-model-parameters.html"><a href="inference-on-model-parameters.html"><i class="fa fa-check"></i>5.6 Inference on Model Parameters</a>
<ul>
<li class="chapter" data-level="" data-path="inference-on-model-parameters.html"><a href="inference-on-model-parameters.html#prepare-the-work-environment-11"><i class="fa fa-check"></i>Prepare the work environment</a></li>
<li class="chapter" data-level="" data-path="inference-on-model-parameters.html"><a href="inference-on-model-parameters.html#estimating-linear-models-2"><i class="fa fa-check"></i>Estimating Linear Models</a></li>
<li class="chapter" data-level="" data-path="inference-on-model-parameters.html"><a href="inference-on-model-parameters.html#inference-on-model-parameters-1"><i class="fa fa-check"></i>Inference on Model Parameters</a></li>
<li class="chapter" data-level="" data-path="inference-on-model-parameters.html"><a href="inference-on-model-parameters.html#comparison-predicted-vs-observed-values"><i class="fa fa-check"></i>Comparison: Predicted vs Observed Values</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="bar-charts.html"><a href="bar-charts.html"><i class="fa fa-check"></i>7.1 Bar charts</a>
<ul>
<li class="chapter" data-level="" data-path="bar-charts.html"><a href="bar-charts.html#prepare-the-work-environment-12"><i class="fa fa-check"></i>Prepare the work environment</a></li>
<li class="chapter" data-level="" data-path="bar-charts.html"><a href="bar-charts.html#bar-chart-for-estimated-number-of-households-spending-on-non-food-items"><i class="fa fa-check"></i>Bar Chart for Estimated Number of Households Spending on Non-Food Items</a></li>
<li class="chapter" data-level="" data-path="bar-charts.html"><a href="bar-charts.html#bar-chart-for-estimated-total-household-expenditure-on-non-food-items"><i class="fa fa-check"></i>Bar Chart for Estimated Total Household Expenditure on Non-Food Items</a></li>
<li class="chapter" data-level="" data-path="bar-charts.html"><a href="bar-charts.html#bar-chart-for-estimated-proportion-of-households-spending-on-non-food-items"><i class="fa fa-check"></i>Bar Chart for Estimated Proportion of Households Spending on Non-Food Items</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="histograms.html"><a href="histograms.html"><i class="fa fa-check"></i>7.2 Histograms</a>
<ul>
<li class="chapter" data-level="" data-path="histograms.html"><a href="histograms.html#prepare-the-work-environment-13"><i class="fa fa-check"></i>Prepare the work environment</a></li>
<li class="chapter" data-level="" data-path="histograms.html"><a href="histograms.html#histogram-using-survey-weighted-data"><i class="fa fa-check"></i>Histogram using Survey-Weighted Data</a></li>
<li class="chapter" data-level="" data-path="histograms.html"><a href="histograms.html#preparing-data-for-ggplot2-visualization"><i class="fa fa-check"></i>Preparing Data for ggplot2 Visualization</a></li>
<li class="chapter" data-level="" data-path="histograms.html"><a href="histograms.html#histogram-for-expenditure-distribution"><i class="fa fa-check"></i>Histogram for Expenditure Distribution</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="scatter-plots---relationship-between-expenditure-and-income.html"><a href="scatter-plots---relationship-between-expenditure-and-income.html"><i class="fa fa-check"></i>7.3 Scatter Plots - Relationship Between Expenditure and Income</a>
<ul>
<li class="chapter" data-level="" data-path="scatter-plots---relationship-between-expenditure-and-income.html"><a href="scatter-plots---relationship-between-expenditure-and-income.html#prepare-the-work-environment-14"><i class="fa fa-check"></i>Prepare the work environment</a></li>
<li class="chapter" data-level="" data-path="scatter-plots---relationship-between-expenditure-and-income.html"><a href="scatter-plots---relationship-between-expenditure-and-income.html#scatter-plots-of-expenditure-vs-income"><i class="fa fa-check"></i>Scatter Plots of Expenditure vs Income</a></li>
</ul></li>
<li class="divider"></li>
<li><a CHAPTER 9 - EXAMPLES IN R </a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">CHAPTER 9 - EXAMPLES IN R</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="inference-on-model-parameters" class="section level1 unnumbered hasAnchor">
<h1>5.6 Inference on Model Parameters<a href="inference-on-model-parameters.html#inference-on-model-parameters" class="anchor-section" aria-label="Anchor link to header"></a></h1>
<p>This section performs inference on the parameters of a weighted linear regression model fitted to the log of per capita expenditure using ESS4 survey data. Coefficient estimates are extracted, visualized with confidence intervals, and model predictions are compared against observed values. This approach helps identify statistically significant effects and assess overall model fit under a complex survey design.</p>
<div id="prepare-the-work-environment-11" class="section level3 unnumbered hasAnchor">
<h3>Prepare the work environment<a href="inference-on-model-parameters.html#prepare-the-work-environment-11" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>This initial block prepares the working environment to perform weighted regressions using ESS4 survey data. It begins by clearing memory and loading the required libraries for complex survey analysis, data handling, and model diagnostics. The processed dataset (<code>IND_data_regression</code>) is then imported, and a complex survey design object (<code>ESS4_design</code>) is defined, incorporating primary sampling units, stratification, and final weights. Finally, per capita expenditure is log-transformed to approximate normality and ensure the validity of linear model assumptions.</p>
<div class="sourceCode" id="cb139"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb139-1"><a href="inference-on-model-parameters.html#cb139-1" tabindex="-1"></a><span class="co">#------------------------------------------------------------------------------#</span></span>
<span id="cb139-2"><a href="inference-on-model-parameters.html#cb139-2" tabindex="-1"></a><span class="co">#                           Cleaning R Environment                             #</span></span>
<span id="cb139-3"><a href="inference-on-model-parameters.html#cb139-3" tabindex="-1"></a><span class="co">#------------------------------------------------------------------------------#</span></span>
<span id="cb139-4"><a href="inference-on-model-parameters.html#cb139-4" tabindex="-1"></a></span>
<span id="cb139-5"><a href="inference-on-model-parameters.html#cb139-5" tabindex="-1"></a><span class="fu">rm</span>(<span class="at">list =</span> <span class="fu">ls</span>())</span>
<span id="cb139-6"><a href="inference-on-model-parameters.html#cb139-6" tabindex="-1"></a><span class="fu">gc</span>()</span></code></pre></div>
<pre><code>##          used (Mb) gc trigger (Mb) max used (Mb)
## Ncells 534094 28.6    1195792 63.9   660380 35.3
## Vcells 944957  7.3    8388608 64.0  1769854 13.6</code></pre>
<div class="sourceCode" id="cb141"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb141-1"><a href="inference-on-model-parameters.html#cb141-1" tabindex="-1"></a><span class="co">#------------------------------------------------------------------------------#</span></span>
<span id="cb141-2"><a href="inference-on-model-parameters.html#cb141-2" tabindex="-1"></a><span class="co">#                                Libraries                                     #</span></span>
<span id="cb141-3"><a href="inference-on-model-parameters.html#cb141-3" tabindex="-1"></a><span class="co">#------------------------------------------------------------------------------#</span></span>
<span id="cb141-4"><a href="inference-on-model-parameters.html#cb141-4" tabindex="-1"></a></span>
<span id="cb141-5"><a href="inference-on-model-parameters.html#cb141-5" tabindex="-1"></a><span class="fu">library</span>(dplyr)</span>
<span id="cb141-6"><a href="inference-on-model-parameters.html#cb141-6" tabindex="-1"></a><span class="fu">library</span>(survey)</span>
<span id="cb141-7"><a href="inference-on-model-parameters.html#cb141-7" tabindex="-1"></a><span class="fu">library</span>(srvyr)</span>
<span id="cb141-8"><a href="inference-on-model-parameters.html#cb141-8" tabindex="-1"></a><span class="fu">library</span>(data.table)</span>
<span id="cb141-9"><a href="inference-on-model-parameters.html#cb141-9" tabindex="-1"></a><span class="fu">library</span>(magrittr)</span>
<span id="cb141-10"><a href="inference-on-model-parameters.html#cb141-10" tabindex="-1"></a><span class="fu">library</span>(haven)</span>
<span id="cb141-11"><a href="inference-on-model-parameters.html#cb141-11" tabindex="-1"></a><span class="fu">library</span>(stringr)</span>
<span id="cb141-12"><a href="inference-on-model-parameters.html#cb141-12" tabindex="-1"></a><span class="fu">library</span>(tidyr)</span>
<span id="cb141-13"><a href="inference-on-model-parameters.html#cb141-13" tabindex="-1"></a><span class="fu">library</span>(svydiags)</span>
<span id="cb141-14"><a href="inference-on-model-parameters.html#cb141-14" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb141-15"><a href="inference-on-model-parameters.html#cb141-15" tabindex="-1"></a><span class="fu">library</span>(broom)</span>
<span id="cb141-16"><a href="inference-on-model-parameters.html#cb141-16" tabindex="-1"></a></span>
<span id="cb141-17"><a href="inference-on-model-parameters.html#cb141-17" tabindex="-1"></a><span class="co"># Ensure the correct use of dplyr&#39;s select function</span></span>
<span id="cb141-18"><a href="inference-on-model-parameters.html#cb141-18" tabindex="-1"></a>select <span class="ot">&lt;-</span> dplyr<span class="sc">::</span>select</span>
<span id="cb141-19"><a href="inference-on-model-parameters.html#cb141-19" tabindex="-1"></a></span>
<span id="cb141-20"><a href="inference-on-model-parameters.html#cb141-20" tabindex="-1"></a><span class="co">#------------------------------------------------------------------------------#</span></span>
<span id="cb141-21"><a href="inference-on-model-parameters.html#cb141-21" tabindex="-1"></a><span class="co">#                           Loading Datasets                                   #</span></span>
<span id="cb141-22"><a href="inference-on-model-parameters.html#cb141-22" tabindex="-1"></a><span class="co">#------------------------------------------------------------------------------#</span></span>
<span id="cb141-23"><a href="inference-on-model-parameters.html#cb141-23" tabindex="-1"></a></span>
<span id="cb141-24"><a href="inference-on-model-parameters.html#cb141-24" tabindex="-1"></a>IND_data_regression <span class="ot">&lt;-</span> <span class="fu">readRDS</span>(<span class="st">&quot;data/data_ESS4/IND_data_regression.rds&quot;</span>)</span>
<span id="cb141-25"><a href="inference-on-model-parameters.html#cb141-25" tabindex="-1"></a></span>
<span id="cb141-26"><a href="inference-on-model-parameters.html#cb141-26" tabindex="-1"></a><span class="co">#------------------------------------------------------------------------------#</span></span>
<span id="cb141-27"><a href="inference-on-model-parameters.html#cb141-27" tabindex="-1"></a><span class="co"># Defining the survey design for weighted regression</span></span>
<span id="cb141-28"><a href="inference-on-model-parameters.html#cb141-28" tabindex="-1"></a><span class="co">#------------------------------------------------------------------------------#</span></span>
<span id="cb141-29"><a href="inference-on-model-parameters.html#cb141-29" tabindex="-1"></a></span>
<span id="cb141-30"><a href="inference-on-model-parameters.html#cb141-30" tabindex="-1"></a><span class="co"># Set survey options to handle single PSU issues</span></span>
<span id="cb141-31"><a href="inference-on-model-parameters.html#cb141-31" tabindex="-1"></a><span class="fu">options</span>(<span class="at">survey.lonely.psu =</span> <span class="st">&quot;fail&quot;</span>) </span>
<span id="cb141-32"><a href="inference-on-model-parameters.html#cb141-32" tabindex="-1"></a></span>
<span id="cb141-33"><a href="inference-on-model-parameters.html#cb141-33" tabindex="-1"></a><span class="co"># Define survey design with appropriate stratification and weighting</span></span>
<span id="cb141-34"><a href="inference-on-model-parameters.html#cb141-34" tabindex="-1"></a>ESS4_design <span class="ot">&lt;-</span> IND_data_regression <span class="sc">%&gt;%</span></span>
<span id="cb141-35"><a href="inference-on-model-parameters.html#cb141-35" tabindex="-1"></a>  <span class="fu">filter</span>(percapita_expenditure <span class="sc">&gt;</span> <span class="dv">0</span>)   <span class="sc">%&gt;%</span> </span>
<span id="cb141-36"><a href="inference-on-model-parameters.html#cb141-36" tabindex="-1"></a>  <span class="fu">as_survey_design</span>(</span>
<span id="cb141-37"><a href="inference-on-model-parameters.html#cb141-37" tabindex="-1"></a>    <span class="at">ids =</span> ea_id,       <span class="co"># Primary Sampling Unit (PSU)</span></span>
<span id="cb141-38"><a href="inference-on-model-parameters.html#cb141-38" tabindex="-1"></a>    <span class="at">strata =</span> strata,   <span class="co"># Stratification variable</span></span>
<span id="cb141-39"><a href="inference-on-model-parameters.html#cb141-39" tabindex="-1"></a>    <span class="at">weights =</span> pw_w4,   <span class="co"># Survey weights</span></span>
<span id="cb141-40"><a href="inference-on-model-parameters.html#cb141-40" tabindex="-1"></a>    <span class="at">nest =</span> <span class="cn">TRUE</span></span>
<span id="cb141-41"><a href="inference-on-model-parameters.html#cb141-41" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span> </span>
<span id="cb141-42"><a href="inference-on-model-parameters.html#cb141-42" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">log_expenditure =</span> <span class="fu">log</span>(percapita_expenditure <span class="sc">+</span> <span class="dv">70</span>)) <span class="co"># Log transformation for normality</span></span></code></pre></div>
</div>
<div id="estimating-linear-models-2" class="section level3 unnumbered hasAnchor">
<h3>Estimating Linear Models<a href="inference-on-model-parameters.html#estimating-linear-models-2" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>This block estimates a survey-weighted linear regression model using the complex design from the ESS4 dataset. The dependent variable is the log of per capita expenditure, with predictors including area of residence, religion, sex, and age group, as well as an interaction between area and religion. The <code>svyglm()</code> function ensures valid standard errors and inference under the complex design. The code outputs the model summary and estimated coefficients.</p>
<div class="sourceCode" id="cb142"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb142-1"><a href="inference-on-model-parameters.html#cb142-1" tabindex="-1"></a><span class="co">#------------------------------------------------------------------------------#</span></span>
<span id="cb142-2"><a href="inference-on-model-parameters.html#cb142-2" tabindex="-1"></a><span class="co">#                         Estimating Linear Models                             #</span></span>
<span id="cb142-3"><a href="inference-on-model-parameters.html#cb142-3" tabindex="-1"></a><span class="co">#------------------------------------------------------------------------------#</span></span>
<span id="cb142-4"><a href="inference-on-model-parameters.html#cb142-4" tabindex="-1"></a></span>
<span id="cb142-5"><a href="inference-on-model-parameters.html#cb142-5" tabindex="-1"></a><span class="co"># Survey-weighted linear model for log expenditure</span></span>
<span id="cb142-6"><a href="inference-on-model-parameters.html#cb142-6" tabindex="-1"></a>EXP_model <span class="ot">&lt;-</span></span>
<span id="cb142-7"><a href="inference-on-model-parameters.html#cb142-7" tabindex="-1"></a>  <span class="fu">svyglm</span>(log_expenditure  <span class="sc">~</span> <span class="dv">1</span> <span class="sc">+</span> Zone <span class="sc">*</span> Religion <span class="sc">+</span> Zone <span class="sc">+</span> Sex <span class="sc">+</span> age_group,</span>
<span id="cb142-8"><a href="inference-on-model-parameters.html#cb142-8" tabindex="-1"></a>         <span class="at">design =</span> ESS4_design)</span>
<span id="cb142-9"><a href="inference-on-model-parameters.html#cb142-9" tabindex="-1"></a></span>
<span id="cb142-10"><a href="inference-on-model-parameters.html#cb142-10" tabindex="-1"></a><span class="co"># Display model coefficients</span></span>
<span id="cb142-11"><a href="inference-on-model-parameters.html#cb142-11" tabindex="-1"></a><span class="fu">summary</span>(EXP_model)</span></code></pre></div>
<pre><code>## 
## Call:
## svyglm(formula = log_expenditure ~ 1 + Zone * Religion + Zone + 
##     Sex + age_group, design = ESS4_design)
## 
## Survey design:
## Called via srvyr
## 
## Coefficients:
##                                    Estimate Std. Error t value Pr(&gt;|t|)    
## (Intercept)                         6.75103    0.06376 105.882  &lt; 2e-16 ***
## Zone2. URBAN                        0.62235    0.08999   6.916 1.43e-11 ***
## Religion2. CATHOLIC                -0.83665    0.33704  -2.482  0.01338 *  
## Religion3. PROTESTANT              -0.37824    0.09629  -3.928 9.76e-05 ***
## Religion4. MUSLEM                  -0.52809    0.08640  -6.112 1.98e-09 ***
## ReligionOTHER                      -0.27937    0.10867  -2.571  0.01043 *  
## Sex2. Female                       -0.06211    0.01450  -4.284 2.20e-05 ***
## age_group31-45                     -0.08358    0.02644  -3.161  0.00167 ** 
## age_group46-65                     -0.09009    0.03114  -2.893  0.00398 ** 
## age_group66 or more                -0.17498    0.06199  -2.823  0.00495 ** 
## Zone2. URBAN:Religion2. CATHOLIC    0.90298    0.39443   2.289  0.02248 *  
## Zone2. URBAN:Religion3. PROTESTANT  0.25355    0.13325   1.903  0.05763 .  
## Zone2. URBAN:Religion4. MUSLEM      0.16567    0.12553   1.320  0.18752    
## Zone2. URBAN:ReligionOTHER         -0.65549    0.28641  -2.289  0.02252 *  
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## (Dispersion parameter for gaussian family taken to be 0.7269917)
## 
## Number of Fisher Scoring iterations: 2</code></pre>
<div class="sourceCode" id="cb144"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb144-1"><a href="inference-on-model-parameters.html#cb144-1" tabindex="-1"></a>EXP_model <span class="sc">%&gt;%</span> <span class="fu">coef</span>()</span></code></pre></div>
<pre><code>##                        (Intercept)                       Zone2. URBAN 
##                         6.75103013                         0.62235134 
##                Religion2. CATHOLIC              Religion3. PROTESTANT 
##                        -0.83664621                        -0.37824277 
##                  Religion4. MUSLEM                      ReligionOTHER 
##                        -0.52808542                        -0.27937202 
##                       Sex2. Female                     age_group31-45 
##                        -0.06210920                        -0.08358242 
##                     age_group46-65                age_group66 or more 
##                        -0.09008758                        -0.17498242 
##   Zone2. URBAN:Religion2. CATHOLIC Zone2. URBAN:Religion3. PROTESTANT 
##                         0.90298319                         0.25355058 
##     Zone2. URBAN:Religion4. MUSLEM         Zone2. URBAN:ReligionOTHER 
##                         0.16566844                        -0.65548554</code></pre>
</div>
<div id="inference-on-model-parameters-1" class="section level3 unnumbered hasAnchor">
<h3>Inference on Model Parameters<a href="inference-on-model-parameters.html#inference-on-model-parameters-1" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>This block extracts the estimated model coefficients along with their 95% confidence intervals and prepares labels for graphical display. LaTeX-style expressions (e.g., <span class="math inline">\(\beta_0, \beta_1, \dots\)</span>) are generated to visually identify each parameter in plots. This formatting enables a clearer and more professional presentation of regression results.</p>
<div class="sourceCode" id="cb146"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb146-1"><a href="inference-on-model-parameters.html#cb146-1" tabindex="-1"></a><span class="co">#------------------------------------------------------------------------------#</span></span>
<span id="cb146-2"><a href="inference-on-model-parameters.html#cb146-2" tabindex="-1"></a><span class="co">#                    Inference on Model Parameters                             #</span></span>
<span id="cb146-3"><a href="inference-on-model-parameters.html#cb146-3" tabindex="-1"></a><span class="co">#------------------------------------------------------------------------------#</span></span>
<span id="cb146-4"><a href="inference-on-model-parameters.html#cb146-4" tabindex="-1"></a></span>
<span id="cb146-5"><a href="inference-on-model-parameters.html#cb146-5" tabindex="-1"></a><span class="co"># Extract coefficients and confidence intervals</span></span>
<span id="cb146-6"><a href="inference-on-model-parameters.html#cb146-6" tabindex="-1"></a>coef_df <span class="ot">&lt;-</span> <span class="fu">tidy</span>(EXP_model, <span class="at">conf.int =</span> <span class="cn">TRUE</span>)</span>
<span id="cb146-7"><a href="inference-on-model-parameters.html#cb146-7" tabindex="-1"></a></span>
<span id="cb146-8"><a href="inference-on-model-parameters.html#cb146-8" tabindex="-1"></a></span>
<span id="cb146-9"><a href="inference-on-model-parameters.html#cb146-9" tabindex="-1"></a><span class="co"># Define factor labels for coefficients</span></span>
<span id="cb146-10"><a href="inference-on-model-parameters.html#cb146-10" tabindex="-1"></a>coef_df<span class="sc">$</span>beta <span class="ot">&lt;-</span> <span class="fu">factor</span>(</span>
<span id="cb146-11"><a href="inference-on-model-parameters.html#cb146-11" tabindex="-1"></a>  <span class="fu">paste0</span>(<span class="st">&quot;beta[&quot;</span>, <span class="dv">1</span><span class="sc">:</span><span class="fu">nrow</span>(coef_df) <span class="sc">-</span><span class="dv">1</span>, <span class="st">&quot;]&quot;</span>),</span>
<span id="cb146-12"><a href="inference-on-model-parameters.html#cb146-12" tabindex="-1"></a>  <span class="at">ordered =</span> <span class="cn">TRUE</span>,</span>
<span id="cb146-13"><a href="inference-on-model-parameters.html#cb146-13" tabindex="-1"></a>  <span class="at">levels =</span> <span class="fu">paste0</span>(<span class="st">&quot;beta[&quot;</span>, <span class="dv">1</span><span class="sc">:</span><span class="fu">nrow</span>(coef_df) <span class="sc">-</span> <span class="dv">1</span>, <span class="st">&quot;]&quot;</span>),</span>
<span id="cb146-14"><a href="inference-on-model-parameters.html#cb146-14" tabindex="-1"></a>  <span class="at">labels =</span> <span class="fu">paste0</span>(<span class="st">&quot;beta[&quot;</span>, <span class="dv">1</span><span class="sc">:</span><span class="fu">nrow</span>(coef_df) <span class="sc">-</span> <span class="dv">1</span>, <span class="st">&quot;]&quot;</span>)</span>
<span id="cb146-15"><a href="inference-on-model-parameters.html#cb146-15" tabindex="-1"></a>)</span>
<span id="cb146-16"><a href="inference-on-model-parameters.html#cb146-16" tabindex="-1"></a></span>
<span id="cb146-17"><a href="inference-on-model-parameters.html#cb146-17" tabindex="-1"></a></span>
<span id="cb146-18"><a href="inference-on-model-parameters.html#cb146-18" tabindex="-1"></a><span class="co"># Generate LaTeX-like expressions for beta coefficients</span></span>
<span id="cb146-19"><a href="inference-on-model-parameters.html#cb146-19" tabindex="-1"></a>beta_labels <span class="ot">&lt;-</span> <span class="fu">setNames</span>(</span>
<span id="cb146-20"><a href="inference-on-model-parameters.html#cb146-20" tabindex="-1"></a>  <span class="fu">lapply</span>(<span class="dv">0</span><span class="sc">:</span>(<span class="fu">nrow</span>(coef_df) <span class="sc">-</span> <span class="dv">1</span>), <span class="cf">function</span>(i) <span class="fu">bquote</span>(beta[.(i)])),</span>
<span id="cb146-21"><a href="inference-on-model-parameters.html#cb146-21" tabindex="-1"></a>  <span class="fu">paste0</span>(<span class="st">&quot;beta[&quot;</span>, <span class="dv">0</span><span class="sc">:</span>(<span class="fu">nrow</span>(coef_df) <span class="sc">-</span> <span class="dv">1</span>), <span class="st">&quot;]&quot;</span>)</span>
<span id="cb146-22"><a href="inference-on-model-parameters.html#cb146-22" tabindex="-1"></a>)</span></code></pre></div>
<p>This block generates a plot of the survey-weighted linear model coefficients, displaying point estimates with 95% confidence intervals. Each coefficient is labeled using LaTeX-style notation ( <span class="math inline">\(\beta_0, \beta_1, \dots\)</span>*, etc.) on the vertical axis, enhancing clarity and professionalism. A dashed red line at zero provides a reference to identify non-significant effects.</p>
<div class="sourceCode" id="cb147"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb147-1"><a href="inference-on-model-parameters.html#cb147-1" tabindex="-1"></a><span class="co"># Plot model coefficients with confidence intervals</span></span>
<span id="cb147-2"><a href="inference-on-model-parameters.html#cb147-2" tabindex="-1"></a><span class="fu">ggplot</span>(coef_df, <span class="fu">aes</span>(<span class="at">x =</span> beta, <span class="at">y =</span> estimate)) <span class="sc">+</span></span>
<span id="cb147-3"><a href="inference-on-model-parameters.html#cb147-3" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">size =</span> <span class="dv">3</span>, <span class="at">color =</span> <span class="st">&quot;blue&quot;</span>) <span class="sc">+</span>  <span class="co"># Point estimates</span></span>
<span id="cb147-4"><a href="inference-on-model-parameters.html#cb147-4" tabindex="-1"></a>  <span class="fu">geom_errorbar</span>(<span class="fu">aes</span>(<span class="at">ymin =</span> conf.low, <span class="at">ymax =</span> conf.high),</span>
<span id="cb147-5"><a href="inference-on-model-parameters.html#cb147-5" tabindex="-1"></a>                <span class="at">width =</span> <span class="fl">0.2</span>,</span>
<span id="cb147-6"><a href="inference-on-model-parameters.html#cb147-6" tabindex="-1"></a>                <span class="at">color =</span> <span class="st">&quot;black&quot;</span>) <span class="sc">+</span></span>
<span id="cb147-7"><a href="inference-on-model-parameters.html#cb147-7" tabindex="-1"></a>  <span class="fu">geom_hline</span>(<span class="at">yintercept =</span> <span class="dv">0</span>,</span>
<span id="cb147-8"><a href="inference-on-model-parameters.html#cb147-8" tabindex="-1"></a>             <span class="at">linetype =</span> <span class="st">&quot;dashed&quot;</span>,</span>
<span id="cb147-9"><a href="inference-on-model-parameters.html#cb147-9" tabindex="-1"></a>             <span class="at">color =</span> <span class="st">&quot;red&quot;</span>) <span class="sc">+</span>  <span class="co"># Zero-reference line</span></span>
<span id="cb147-10"><a href="inference-on-model-parameters.html#cb147-10" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb147-11"><a href="inference-on-model-parameters.html#cb147-11" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">&quot;Survey Model Coefficients&quot;</span>,</span>
<span id="cb147-12"><a href="inference-on-model-parameters.html#cb147-12" tabindex="-1"></a>    <span class="at">subtitle =</span> <span class="st">&quot;Point estimates with 95% confidence intervals&quot;</span>,</span>
<span id="cb147-13"><a href="inference-on-model-parameters.html#cb147-13" tabindex="-1"></a>    <span class="at">x =</span> <span class="st">&quot;Coefficients&quot;</span>,</span>
<span id="cb147-14"><a href="inference-on-model-parameters.html#cb147-14" tabindex="-1"></a>    <span class="at">y =</span> <span class="st">&quot;Estimate&quot;</span></span>
<span id="cb147-15"><a href="inference-on-model-parameters.html#cb147-15" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb147-16"><a href="inference-on-model-parameters.html#cb147-16" tabindex="-1"></a>  <span class="fu">theme_minimal</span>(<span class="at">base_size =</span> <span class="dv">16</span>) <span class="sc">+</span></span>
<span id="cb147-17"><a href="inference-on-model-parameters.html#cb147-17" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">hjust =</span> <span class="fl">0.5</span>),</span>
<span id="cb147-18"><a href="inference-on-model-parameters.html#cb147-18" tabindex="-1"></a>        <span class="at">plot.subtitle =</span> <span class="fu">element_text</span>(<span class="at">hjust =</span> <span class="fl">0.5</span>)) <span class="sc">+</span></span>
<span id="cb147-19"><a href="inference-on-model-parameters.html#cb147-19" tabindex="-1"></a>  <span class="fu">scale_x_discrete</span>(<span class="at">labels =</span> beta_labels) <span class="sc">+</span>  <span class="co"># Use LaTeX expressions for labels</span></span>
<span id="cb147-20"><a href="inference-on-model-parameters.html#cb147-20" tabindex="-1"></a>  <span class="fu">coord_flip</span>()  <span class="co"># Flip axes for readability</span></span></code></pre></div>
<p><img src="images/5.6/01_Plot_model_coefficients.png" /></p>
</div>
<div id="comparison-predicted-vs-observed-values" class="section level3 unnumbered hasAnchor">
<h3>Comparison: Predicted vs Observed Values<a href="inference-on-model-parameters.html#comparison-predicted-vs-observed-values" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>This block extracts the predicted values from the survey-weighted linear model (<code>EXP_model</code>) and compares them to the observed values of log per capita expenditure. This comparison is essential for assessing model fit and identifying potential systematic deviations between estimated and actual values.</p>
<div class="sourceCode" id="cb148"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb148-1"><a href="inference-on-model-parameters.html#cb148-1" tabindex="-1"></a><span class="co">#------------------------------------------------------------------------------#</span></span>
<span id="cb148-2"><a href="inference-on-model-parameters.html#cb148-2" tabindex="-1"></a><span class="co">#                     Comparison: Predicted vs Observed Values                 #</span></span>
<span id="cb148-3"><a href="inference-on-model-parameters.html#cb148-3" tabindex="-1"></a><span class="co">#------------------------------------------------------------------------------#</span></span>
<span id="cb148-4"><a href="inference-on-model-parameters.html#cb148-4" tabindex="-1"></a></span>
<span id="cb148-5"><a href="inference-on-model-parameters.html#cb148-5" tabindex="-1"></a><span class="co"># Extract predicted values from the model</span></span>
<span id="cb148-6"><a href="inference-on-model-parameters.html#cb148-6" tabindex="-1"></a>predicted_values <span class="ot">&lt;-</span> <span class="fu">predict</span>(EXP_model) <span class="sc">%&gt;%</span> <span class="fu">data.frame</span>()</span>
<span id="cb148-7"><a href="inference-on-model-parameters.html#cb148-7" tabindex="-1"></a></span>
<span id="cb148-8"><a href="inference-on-model-parameters.html#cb148-8" tabindex="-1"></a><span class="co"># Extract observed values from the dataset</span></span>
<span id="cb148-9"><a href="inference-on-model-parameters.html#cb148-9" tabindex="-1"></a>observed_values <span class="ot">&lt;-</span> ESS4_design<span class="sc">$</span>variables<span class="sc">$</span>log_expenditure</span></code></pre></div>
<p>This scatter plot compares the observed log per capita expenditure with the values predicted by the model. Each point represents an individual, and the red dashed line indicates perfect prediction (observed = predicted). The closer the points are to this line, the better the model fit. This visualization helps identify systematic bias or patterns of over/underestimation.</p>
<div class="sourceCode" id="cb149"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb149-1"><a href="inference-on-model-parameters.html#cb149-1" tabindex="-1"></a><span class="co"># Create scatter plot of observed vs predicted values</span></span>
<span id="cb149-2"><a href="inference-on-model-parameters.html#cb149-2" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> <span class="fu">data.frame</span>(<span class="at">observed =</span> observed_values, <span class="at">predicted =</span> predicted_values[,<span class="dv">1</span>]), </span>
<span id="cb149-3"><a href="inference-on-model-parameters.html#cb149-3" tabindex="-1"></a>       <span class="fu">aes</span>(<span class="at">x =</span> observed, <span class="at">y =</span> predicted)) <span class="sc">+</span></span>
<span id="cb149-4"><a href="inference-on-model-parameters.html#cb149-4" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">alpha =</span> <span class="fl">0.5</span>, <span class="at">color =</span> <span class="st">&quot;blue&quot;</span>) <span class="sc">+</span>  <span class="co"># Scatter plot with transparency</span></span>
<span id="cb149-5"><a href="inference-on-model-parameters.html#cb149-5" tabindex="-1"></a>  <span class="fu">geom_abline</span>(<span class="at">intercept =</span> <span class="dv">0</span>, <span class="at">slope =</span> <span class="dv">1</span>, <span class="at">color =</span> <span class="st">&quot;red&quot;</span>, <span class="at">linetype =</span> <span class="st">&quot;dashed&quot;</span>,</span>
<span id="cb149-6"><a href="inference-on-model-parameters.html#cb149-6" tabindex="-1"></a>              <span class="at">linewidth =</span> <span class="fl">1.5</span>) <span class="sc">+</span>  <span class="co"># Reference line</span></span>
<span id="cb149-7"><a href="inference-on-model-parameters.html#cb149-7" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb149-8"><a href="inference-on-model-parameters.html#cb149-8" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">&quot;Observed vs Predicted Values&quot;</span>,</span>
<span id="cb149-9"><a href="inference-on-model-parameters.html#cb149-9" tabindex="-1"></a>    <span class="at">x =</span> <span class="st">&quot;Observed Log Expenditure&quot;</span>,</span>
<span id="cb149-10"><a href="inference-on-model-parameters.html#cb149-10" tabindex="-1"></a>    <span class="at">y =</span> <span class="st">&quot;Predicted Log Expenditure&quot;</span></span>
<span id="cb149-11"><a href="inference-on-model-parameters.html#cb149-11" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb149-12"><a href="inference-on-model-parameters.html#cb149-12" tabindex="-1"></a>  <span class="fu">theme_minimal</span>(<span class="at">base_size =</span> <span class="dv">20</span>) <span class="sc">+</span></span>
<span id="cb149-13"><a href="inference-on-model-parameters.html#cb149-13" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">hjust =</span> <span class="fl">0.5</span>))</span></code></pre></div>
<p><img src="images/5.6/02_observed_vs_predicted_values.png" /></p>

</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="model-diagnostics.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="bar-charts.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": true,
"facebook": false,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"whatsapp": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": "https://github.com/psirusteam/chapter9Rcodes/5.6_Inference_on_Model_Parameters.Rmd",
"text": "Edit"
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": ["CHAPTER 9 - EXAMPLES IN R.pdf", "CHAPTER 9 - EXAMPLES IN R.epub", "CHAPTER 9 - EXAMPLES IN R.mobi"],
"search": {
"engine": "fuse",
"options": null
},
"toc": {
"collapse": "section"
},
"tconfig": null
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.9/latest.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
