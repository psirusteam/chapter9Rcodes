[["index.html", "CHAPTER 9 - EXAMPLES IN R Abstract", " CHAPTER 9 - EXAMPLES IN R 2025-03-21 Abstract The Ethiopia Socioeconomic Survey (ESS) is a nationally representative study conducted by the Central Statistical Agency of Ethiopia (CSA) in collaboration with the World Bank. Its objective is to collect detailed information on various aspects of Ethiopian households, such as expenditure on goods and services, income, employment, agricultural production, and living conditions. The data collected in the ESS are essential for policy formulation and evaluating the impact of development programs in the country. This survey enables the analysis of consumption patterns and economic inequalities across different regions, distinguishing between urban and rural areas to identify trends and specific population needs. In this study, multiple analyses have been conducted using ESS data, applying data processing and visualization techniques to examine household income and expenditure patterns. Bar charts have been created to illustrate the distribution of spending on non-food items, histograms to assess the density of expenditure across different categories, and scatter plots to explore the relationship between per capita income and expenditure. Additionally, weighted statistical models have been implemented, considering the survey’s sampling structure to ensure representative and robust estimates. These analyses help identify key differences in the economic behavior of Ethiopian households, providing valuable insights for designing interventions and policies aimed at improving the population’s well-being. "],["accounting-for-the-sampling-design.html", "Accounting for the Sampling Design", " Accounting for the Sampling Design The Ethiopia Socioeconomic Survey (ESS4) is part of the Living Standards Measurement Study (LSMS), an initiative by the World Bank in collaboration with the Central Statistical Agency of Ethiopia (CSA). Its objective is to provide high-quality data for the analysis of poverty, food security, agricultural development, and other key socioeconomic aspects. The ESS4 is part of a series of longitudinal surveys initiated in 2011 under the name Ethiopia Rural Socioeconomic Survey (ERSS). In its first two rounds, the survey only covered rural areas and small towns, but starting from the second wave (ESS2, 2013/2014), the coverage was expanded to all urban areas, ensuring nationally representative estimates. The ESS1, ESS2, and ESS3 waves constitute Panel I, while ESS4 initiates a new panel, serving as the baseline for future surveys. The survey provides information on household structure, employment, income, consumption, education, health, access to infrastructure, and characteristics of the agricultural sector. One of its key features is the combination of household survey data with administrative records and remote sensing technologies, such as satellite imagery, to improve the accuracy of economic and social indicator estimates. "],["sample-design-of-the-ess4-20182019.html", "Sample design of the ESS4 2018/2019", " Sample design of the ESS4 2018/2019 The sampling design of ESS4 is based on a two-stage stratified probabilistic sampling, with different strategies for rural and urban areas. In the first stage, enumeration areas (EA) in rural zones were selected using simple random sampling (SRS) from a subsample of the 2018 Large-Scale Agricultural Survey (AgSS). In urban areas, EAs were directly selected from the urban frame using systematic sampling with probability proportional to size (PPS) within each region. This approach ensured a proportional allocation of the sample between urban and rural areas. In the second stage, households within each selected EA were chosen through systematic random sampling. In rural areas, 10 agricultural households were selected from the AgSS sample, along with 2 non-agricultural households, ensuring that the total number of agricultural households remained 10 when fewer than 2 non-agricultural households were available. In urban areas, 15 households per EA were selected, regardless of economic activity. A total of 7,527 households across 565 EAs were initially planned for the survey; however, due to security restrictions, the final number of completed surveys was 6,770 households across 535 EAs. This design ensures representative coverage of socioeconomic conditions in both rural and urban areas. "],["data-source.html", "Data Source", " Data Source The ESS4 was implemented by the CSA of Ethiopia, in collaboration with the World Bank and other international organizations. Data collection was conducted through direct interviews with selected households, using electronic devices through the Computer-Assisted Personal Interviewing (CAPI) methodology. The database includes detailed information on various socioeconomic aspects, such as: Household structure and sociodemographic characteristics (age, gender, education, health). Living conditions and economic well-being (income, consumption, access to services). Housing characteristics (construction materials, access to drinking water, sanitation, and electricity). Food security and agricultural production (crops, livestock, access to markets). Access to financing and land tenure. Mobility and migration (internal displacement and job seeking). For more details on the methodology, sampling design, and data access, you can refer to the official source on the World Bank Microdata Library: ESS4 Survey on Microdata Library - World Bank "],["using-software-to-generate-valid-inferences.html", "2.3 Using Software to Generate Valid Inferences", " 2.3 Using Software to Generate Valid Inferences This set of code blocks prepares the working environment, loads the main household dataset from ESS4, and generates summary tables with the number of households and enumeration areas by region and area type (urban/rural). It then defines the complex survey design, applying the appropriate weights and stratification. Lastly, it validates the structure of the design and presents a summary of its implementation, ensuring that the estimates are representative at both national and regional levels. Prepare the work environment This R code sets up a clean and optimized environment for data analysis before executing any processing. First, it removes all previously loaded objects from memory and performs garbage collection to free up resources, preventing potential conflicts with data from previous sessions. Then, it loads a set of essential libraries for data manipulation and analysis, including packages specialized in survey data, efficient handling of large datasets, and formatting of results. Additionally, it ensures that the select function from dplyr is explicitly used to avoid conflicts with other libraries. Finally, the code adjusts the available RAM memory limit, optimizing performance for large-scale data processing. This setup is particularly useful in survey analysis and statistical studies that involve working with extensive datasets and computationally intensive calculations. #------------------------------------------------------------------------------# # Cleaning R Environment # #------------------------------------------------------------------------------# rm(list = ls()) gc() ## used (Mb) gc trigger (Mb) max used (Mb) ## Ncells 542487 29.0 1219720 65.2 660485 35.3 ## Vcells 958338 7.4 8388608 64.0 1770410 13.6 #------------------------------------------------------------------------------# # Libraries # #------------------------------------------------------------------------------# library(tidyverse) library(survey) library(srvyr) library(data.table) library(magrittr) library(haven) library(stringr) library(tidyr) library(knitr) library(kableExtra) # Ensure select function from dplyr is used explicitly select &lt;- dplyr::select #------------------------------------------------------------------------------# # Setting the RAM Memory Limit # #------------------------------------------------------------------------------# memory.limit(250000000) ## [1] Inf Loading Datasets This R code loads and prepares a dataset for the ESS4 survey analysis. It uses the read_sav() function to import a SPSS (.sav) file, ensuring the correct reading of the database. Then, the select() function is applied to extract only the key variables, including unique household and enumeration area identifiers, geographic location information, and stratification into urban and rural areas. Additionally, the final adjusted sampling weight is included, which is essential for obtaining representative estimates. #------------------------------------------------------------------------------# # Loading Datasets # #------------------------------------------------------------------------------# # Household identification; location; household size and field staff identification HH_data &lt;- read_sav(&quot;data/data_ESS4/sect_cover_hh_w4.sav&quot;) %&gt;% select(household_id, # Unique Household Identifier ea_id, # Unique Enumeration Area Identifier saq14, # Area = Rural/Urban saq02, # Zone Code saq01, # Region Code pw_w4 # Final adjusted sampling weight ) This code generates two summary tables that count the enumeration areas and households by region and type of area (urban/rural). First, the ea_counts_by_region table calculates the number of enumeration areas (EA) in each region and zone. To achieve this, unique EAs are identified and grouped by region and area type (urban or rural). The structure is then reorganized using pivot_wider() to display the rural and urban categories as separate columns. Finally, the total number of EAs per region is calculated, and the columns are renamed for better clarity. On the other hand, the hh_counts_by_region table follows a similar process, but instead of counting EAs, it counts the number of households by region and area type. Unique households are extracted along with their respective region and zone, then grouped and counted by category. Subsequently, the data is reorganized using pivot_wider(), allowing urban and rural households to be distinguished in separate columns. Finally, the total number of households per region is calculated, and the columns are renamed to ensure a clear and consistent format. ea_counts_by_region &lt;- HH_data %&gt;% distinct(ea_id, saq14, saq01) %&gt;% mutate(saq14 = as_factor(saq14), saq01 = as_factor(saq01)) %&gt;% group_by(saq01, saq14) %&gt;% tally() %&gt;% pivot_wider( names_from = saq14, values_from = n, values_fill = list(n = 0) ) %&gt;% mutate(ea_counts_by_region = RURAL + URBAN) %&gt;% rename_with( ~ paste0(., &quot;_ea_id&quot;), c(&quot;RURAL&quot;, &quot;URBAN&quot;)) # Count of Households (HH) by region and area (urban/rural) categories hh_counts_by_region &lt;- HH_data %&gt;% distinct(household_id, saq01, saq14) %&gt;% mutate(saq14 = as_factor(saq14), saq01 = as_factor(saq01)) %&gt;% group_by(saq01, saq14) %&gt;% tally() %&gt;% pivot_wider( names_from = saq14, values_from = n, values_fill = list(n = 0) ) %&gt;% mutate(TOTAL_HH = RURAL + URBAN) %&gt;% rename_with( ~ paste0(., &quot;_HH&quot;), c(&quot;RURAL&quot;, &quot;URBAN&quot;)) # Merging both datasets on saq01 temp &lt;- inner_join(hh_counts_by_region, ea_counts_by_region) This R code generates a final summary of the survey results, including an additional row with the total consolidated for “ETHIOPIA”. To achieve this, it combines the regional data stored in temp with a new row representing the sum of all regions. This aggregation is performed using summarise_if(is.numeric, sum), ensuring that all numeric variables are correctly summed, while the region column (saq01) is manually assigned as “ETHIOPIA”. Next, the dataset is reorganized using select(), where key variables are renamed for better clarity. The resulting table includes the number of rural and urban households, the number of enumeration areas for each type of zone, and the total counts of households and enumeration areas. Finally, it is converted into a data frame to facilitate manipulation and visualization. This process provides a structured view of the distribution of the population and enumeration areas, allowing for both regional analysis and a consolidated national overview. # Summarizing the results including an additional row for &quot;ETHIOPIA&quot; survey_counts &lt;- bind_rows( temp, temp %&gt;% data.frame() %&gt;% summarise_if(is.numeric, sum) %&gt;% mutate(saq01 = &quot;ETHIOPIA&quot;) ) %&gt;% select( Region = saq01, RURAL_HH, RURAL_AE = RURAL_ea_id, URBAN_HH, URBAN_AE = URBAN_ea_id, TOTAL_HH, TOTAL_AE = ea_counts_by_region ) %&gt;% data.frame() # Display final result data.frame(survey_counts) The table summarizes the distribution of households and enumeration areas (EA) by region in Ethiopia, distinguishing between rural and urban areas. Nationally, the sample includes 6,770 households and 535 EAs, with a relatively balanced distribution between urban and rural areas. The regions with the highest number of rural households are Amhara (479), Oromia (453), and SNNP (422), while Addis Ababa is entirely urban (778 households and 52 EAs). In terms of EAs, Amhara and Oromia lead in rural areas, while Addis Ababa and Dire Dawa have higher urban concentrations. Region RURAL_HH RURAL_AE URBAN_HH URBAN_AE TOTAL_HH TOTAL_AE TIGRAY 393 35 283 19 676 54 AFAR 299 28 225 15 524 43 AMHARA 479 43 271 18 750 61 OROMIA 453 43 300 20 753 63 SOMALI 355 35 255 17 610 52 BENISHANGUL GUMUZ 169 16 195 13 364 29 SNNP 422 40 269 18 691 58 GAMBELA 195 19 300 20 495 39 HARAR 190 18 360 24 550 42 ADDIS ABABA 0 0 778 52 778 52 DIRE DAWA 160 14 419 28 579 42 ETHIOPIA 3115 291 3655 244 6770 535 Defining the survey design This code defines the survey design for the ESS4 survey using the survey package in R, ensuring that the analysis accurately reflects the sample structure. First, a new variable strata is created by combining the region (saq01) with the urban/rural classification (saq14), allowing for proper stratification of the design. Then, the dataset HH_data is converted into a survey design (as_survey_design()), specifying: - ids = ea_id: Identifier of the primary sampling unit (enumeration area, EA). - strata = strata: Stratification by region and urban/rural area. - weights = pw_w4: Use of the adjusted sampling weight to obtain representative estimates. - nest = TRUE: Indicates that sampling units are nested within strata. #------------------------------------------------------------------------------# # Defining the survey design #------------------------------------------------------------------------------# ESS4_design &lt;- HH_data %&gt;% mutate(strata = paste0(saq01, &quot;_&quot;, saq14)) %&gt;% as_survey_design( ids = ea_id, # Primary sampling unit identifier (EA) strata = strata, # Stratification by region (saq01) and urban/rural zone (saq14) weights = pw_w4, # Final adjusted weight nest = TRUE ) Additionally, the option survey.lonely.psu = \"fail\" is set, causing the code to produce an error if a stratum has only a single, non-certainty primary sampling unit (PSU), ensuring a correctly specified survey design. Finally, summary(ESS4_design) is used to display a summary of the design, allowing verification of its structure before analysis. # Makes it an error to have a stratum with a single, non-certainty PSU options(survey.lonely.psu = &quot;fail&quot;) summary(ESS4_design) ## Stratified 1 - level Cluster Sampling design (with replacement) ## With (535) clusters. ## Called via srvyr ## Probabilities: ## Min. 1st Qu. Median Mean 3rd Qu. Max. ## 3.932e-05 1.997e-04 7.680e-04 2.814e-03 4.164e-03 1.317e-01 ## Stratum Sizes: ## 1_1 1_2 12_1 12_2 13_1 13_2 14_2 15_1 15_2 2_1 2_2 3_1 3_2 4_1 4_2 ## obs 393 283 195 300 190 360 778 160 419 299 225 479 271 453 300 ## design.PSU 35 19 19 20 18 24 52 14 28 28 15 43 18 43 20 ## actual.PSU 35 19 19 20 18 24 52 14 28 28 15 43 18 43 20 ## 5_1 5_2 6_1 6_2 7_1 7_2 ## obs 355 255 169 195 422 269 ## design.PSU 35 17 16 13 40 18 ## actual.PSU 35 17 16 13 40 18 ## Data variables: ## [1] &quot;household_id&quot; &quot;ea_id&quot; &quot;saq14&quot; &quot;saq02&quot; &quot;saq01&quot; ## [6] &quot;pw_w4&quot; &quot;strata&quot; The results confirm that the ESS4 survey design was correctly implemented using a stratified cluster sampling approach (PSU) with replacement. The stratification combines the region and the urban/rural classification, ensuring representativeness at both levels. The sample includes 535 clusters (PSU), and the number of primary sampling units in each stratum matches the planned design, indicating a consistent execution. The selection probabilities vary by region and area type, reflecting a sampling design adjusted to the population’s characteristics. Overall, these results validate the sampling structure and ensure that the derived estimates are representative at both the national and regional levels, accounting for geographic distribution and urban-rural stratification. "],["frequencies-and-proportions.html", "3.1 Frequencies and Proportions", " 3.1 Frequencies and Proportions This code block sets up the working environment for a new section of the analysis, focused on calculating frequencies and proportions based on the ESS4 survey design. Although this structure was defined earlier in the manual, it is repeated here to ensure that execution remains self-contained, reproducible, and free from interference from previous sections. Prepare the work environment This code block marks the beginning of a new working session, following the same methodological line established earlier. Its main purpose is to prepare a clean, efficient, and fully loaded environment to continue with the processing and analysis of the survey data. By resetting the R environment, reloading the necessary libraries, and adjusting the memory settings, this ensures that any subsequent analysis is carried out in a controlled manner, free from interference by previous objects or configurations. This approach is especially useful when working with modular scripts, such as in a manual, as it allows each section to be executed independently, ensuring reproducibility and consistency throughout the entire workflow. #------------------------------------------------------------------------------# # Cleaning R Environment # #------------------------------------------------------------------------------# rm(list = ls()) gc() ## used (Mb) gc trigger (Mb) max used (Mb) ## Ncells 554800 29.7 1241915 66.4 686454 36.7 ## Vcells 982594 7.5 8388608 64.0 1876235 14.4 #------------------------------------------------------------------------------# # Libraries # #------------------------------------------------------------------------------# library(tidyverse) library(survey) library(srvyr) library(data.table) library(magrittr) library(haven) library(stringr) library(tidyr) library(knitr) library(kableExtra) # Ensure select function from dplyr is used explicitly select &lt;- dplyr::select #------------------------------------------------------------------------------# # Setting the RAM Memory Limit # #------------------------------------------------------------------------------# memory.limit(250000000) ## [1] Inf This block continues the analysis, focusing on the processing of household consumption expenditure and participation in various items over the past 12 months. The dataset from section 7b of the questionnaire is loaded, and two variables are created: one for the amount spent (expenditure) and a binary indicator (yes_no) that reflects whether or not the household incurred that expense. Next, the survey design is defined using the same structure as before: strata are created by combining region and urban/rural classification, primary sampling units (ea_id) are specified, and the adjusted sampling weights (pw_w4) are applied. The summary of the design allows for validation before proceeding with the analysis. #------------------------------------------------------------------------------# # Loading Datasets # #------------------------------------------------------------------------------# HH_data &lt;- read_sav(&quot;data/data_ESS4/sect7b_hh_w4_v2.sav&quot;) # Processing expenditure and response indicators HH_data &lt;- HH_data %&gt;% group_by(item = item_cd_12months) %&gt;% mutate( expenditure = ifelse(s7q03 == 2, 0, s7q04), yes_no = ifelse(s7q03 == 2, 0, 1) ) # Defining the survey design ESS4_design &lt;- HH_data %&gt;% mutate(strata = paste0(saq01, &quot;_&quot;, saq14)) %&gt;% as_survey_design( ids = ea_id, # Primary sampling unit identifier (EA) strata = strata, # Stratification by region (saq01) and urban/rural zone (saq14) weights = pw_w4, # Final adjusted weight nest = TRUE ) # Makes it an error to have a stratum with a single, non-certainty PSU options(survey.lonely.psu = &quot;fail&quot;) summary(ESS4_design) ## Stratified 1 - level Cluster Sampling design (with replacement) ## With (535) clusters. ## Called via srvyr ## Probabilities: ## Min. 1st Qu. Median Mean 3rd Qu. Max. ## 3.932e-05 1.997e-04 7.680e-04 2.814e-03 4.164e-03 1.317e-01 ## Stratum Sizes: ## 1_1 1_2 12_1 12_2 13_1 13_2 14_2 15_1 15_2 2_1 2_2 3_1 3_2 ## obs 4323 3113 2145 3300 2090 3960 8558 1760 4609 3289 2475 5269 2981 ## design.PSU 35 19 19 20 18 24 52 14 28 28 15 43 18 ## actual.PSU 35 19 19 20 18 24 52 14 28 28 15 43 18 ## 4_1 4_2 5_1 5_2 6_1 6_2 7_1 7_2 ## obs 4983 3300 3905 2805 1859 2145 4642 2959 ## design.PSU 43 20 35 17 16 13 40 18 ## actual.PSU 43 20 35 17 16 13 40 18 ## Data variables: ## [1] &quot;household_id&quot; &quot;item_cd_12months&quot; &quot;ea_id&quot; &quot;saq14&quot; ## [5] &quot;pw_w4&quot; &quot;saq01&quot; &quot;saq02&quot; &quot;saq03&quot; ## [9] &quot;saq04&quot; &quot;saq05&quot; &quot;saq06&quot; &quot;saq07&quot; ## [13] &quot;saq08&quot; &quot;s7q03&quot; &quot;s7q04&quot; &quot;item&quot; ## [17] &quot;expenditure&quot; &quot;yes_no&quot; &quot;strata&quot; Estimating totals and proportions This block calculates key indicators related to household spending on nonfood items and services, grouping the data by item type (item_cd_12months). Based on the defined survey design, two main estimates are produced: N_hat: the estimated total number of households reporting expenditures on each item, along with its standard error and coefficient of variation. P_hat: the estimated proportion of households who reported spending, including its standard error, coefficient of variation, and a 95% confidence interval. These estimates provide insight into both the magnitude and coverage of consumption across different categories of goods and services at the national level. #------------------------------------------------------------------------------# # TABLE 7.3 # Spending on Nonfood Items and Services # # ESS4 Sampled EAs and Households by Region and by Urban and Rural # Ethiopia Socioeconomic Survey (ESS) 2018/19 # SURVEY REPORT # Central Statistics Agency of Ethiopia | World Bank #------------------------------------------------------------------------------# tab_01 &lt;- ESS4_design %&gt;% group_by(item = item_cd_12months) %&gt;% summarise( N_hat = survey_total(yes_no, na.rm = TRUE, vartype = c(&quot;se&quot;, &quot;cv&quot;)), # Absolute size P_hat = survey_mean(yes_no, na.rm = TRUE, vartype = c(&quot;se&quot;, &quot;cv&quot;, &quot;ci&quot;)) # Proportions ) Formatting and presenting results In this block, the previously computed results are transformed into a reader-friendly table. Item codes are converted into factors, and all estimates are rounded for clarity, including: - The total number of households (N_hat), - The proportion of households (P_hat), - Standard errors, coefficients of variation, and confidence intervals. This step facilitates interpretation and prepares the table for inclusion in technical reports or analytical documents, such as the official ESS4 survey report. The resulting table provides a summary of nonfood items and services purchased by Ethiopian households over the past 12 months, with estimates based on the ESS4 survey design. It includes key precision measures such as the coefficient of variation (*_cv), standard error (*_se), and the 95% confidence interval (*_low, *_upp). tab_01 %&gt;% transmute( item = as_factor(item), N_hat = round(N_hat), N_hat_cv = round(N_hat_cv * 100, 2), P_hat = round(P_hat * 100, 2), P_hat_cv = round(P_hat_cv * 100, 2), P_hat_se = round(P_hat_se * 100, 2), P_hat_low = round(P_hat_low * 100, 2), P_hat_upp = round(P_hat_upp * 100, 2) ) %&gt;% data.frame() item N_hat N_hat_cv P_hat P_hat_cv P_hat_se P_hat_low P_hat_upp Clothes/shoes/fabric for MEN (18 years and older) 11641511 3.13 58.01 3.04 1.77 54.54 61.48 Clothes/shoes/fabric for WOMEN (18 years and older) 12665176 3.03 63.11 2.90 1.83 59.51 66.71 Clothes/shoes/fabric for BOYS (less than 18 years) 10538136 2.46 52.51 2.21 1.16 50.23 54.79 Clothes/shoes/fabric for GIRLS (less than 18 years) 10366155 2.52 51.66 2.30 1.19 49.33 53.99 Kitchen equipment (cooking pots, etc.) 3427502 8.63 17.08 8.58 1.46 14.20 19.96 Linens (sheets, towels,blankets) 5673849 5.83 28.27 5.63 1.59 25.15 31.40 Furniture 1583809 10.57 7.89 10.46 0.83 6.27 9.51 Lamp/torch/solare power 5607831 6.12 27.94 6.02 1.68 24.64 31.25 Ceremonial expenses 12305188 3.76 61.32 3.54 2.17 57.05 65.59 Contributions to informal social security institutions (inc. IDDIR, mahiber..) 8985343 5.06 44.78 4.96 2.22 40.41 49.14 Donations to religious institutions (Incl. churches and mosques..) 8174601 5.16 40.74 5.10 2.08 36.66 44.81 "],["totals-means-and-ratios.html", "3.2 Totals, means and ratios", " 3.2 Totals, means and ratios This section of the manual focuses on the calculation of totals, means, and ratios using data from the ESS4 survey. It begins by setting up the work environment and loading data on nonfood item expenditures. It then estimates the total and average household expenditure for each item type, along with precision measures. Next, it calculates the share of each item’s expenditure relative to total household spending, at both national and regional levels, and presents the results in a comparative table. The section concludes with a focused analysis of educational expenditure as a share of total consumption, using an aggregated dataset. All results are formatted for clear interpretation and regional comparison. Prepare the work environment This block resets the working environment and loads the necessary packages to continue with data processing and survey analysis in a new section. This structure ensures that each module of the analysis can be executed independently, promoting reproducibility and avoiding conflicts with previous sessions. #------------------------------------------------------------------------------# # Cleaning R Environment # #------------------------------------------------------------------------------# rm(list = ls()) gc() ## used (Mb) gc trigger (Mb) max used (Mb) ## Ncells 542333 29.0 1219280 65.2 660485 35.3 ## Vcells 955470 7.3 8388608 64.0 1770406 13.6 #------------------------------------------------------------------------------# # Libraries # #------------------------------------------------------------------------------# library(tidyverse) library(survey) library(srvyr) library(data.table) library(magrittr) library(haven) library(stringr) library(tidyr) library(knitr) library(kableExtra) # Ensure select function from dplyr is used explicitly select &lt;- dplyr::select #------------------------------------------------------------------------------# # Setting the RAM Memory Limit # #------------------------------------------------------------------------------# memory.limit(250000000) ## [1] Inf This block loads data from section 7b of the household questionnaire, related to expenditures on nonfood items, and calculates the total expenditure per household. It then defines the survey design using the same stratification structure and primary sampling units as in previous sections, in order to apply the adjusted weights in the analysis. This step is essential to produce representative estimates of expenditure and its distribution across households. #------------------------------------------------------------------------------# # Loading Datasets # #------------------------------------------------------------------------------# HH_data &lt;- read_sav(&quot;data/data_ESS4/sect7b_hh_w4_v2.sav&quot;) #------------------------------------------------------------------------------# # Calculating Ratio of Expenditures # #------------------------------------------------------------------------------# # Processing data HH_data &lt;- HH_data %&gt;% mutate(expenditure = ifelse(s7q03 == 2, 0, s7q04)) %&gt;% group_by(household_id) %&gt;% mutate(total_expenditure = sum(expenditure, na.rm = TRUE)) # Defining the survey design ESS4_design &lt;- HH_data %&gt;% mutate(strata = paste0(saq01, &quot;_&quot;, saq14)) %&gt;% as_survey_design( ids = ea_id, # Primary sampling unit identifier (EA) strata = strata, # Stratification by region (saq01) and urban/rural zone (saq14) weights = pw_w4, # Final adjusted weight nest = TRUE ) options(survey.lonely.psu = &quot;fail&quot;) summary(ESS4_design) ## Stratified 1 - level Cluster Sampling design (with replacement) ## With (535) clusters. ## Called via srvyr ## Probabilities: ## Min. 1st Qu. Median Mean 3rd Qu. Max. ## 3.932e-05 1.997e-04 7.680e-04 2.814e-03 4.164e-03 1.317e-01 ## Stratum Sizes: ## 1_1 1_2 12_1 12_2 13_1 13_2 14_2 15_1 15_2 2_1 2_2 3_1 3_2 ## obs 4323 3113 2145 3300 2090 3960 8558 1760 4609 3289 2475 5269 2981 ## design.PSU 35 19 19 20 18 24 52 14 28 28 15 43 18 ## actual.PSU 35 19 19 20 18 24 52 14 28 28 15 43 18 ## 4_1 4_2 5_1 5_2 6_1 6_2 7_1 7_2 ## obs 4983 3300 3905 2805 1859 2145 4642 2959 ## design.PSU 43 20 35 17 16 13 40 18 ## actual.PSU 43 20 35 17 16 13 40 18 ## Data variables: ## [1] &quot;household_id&quot; &quot;item_cd_12months&quot; &quot;ea_id&quot; ## [4] &quot;saq14&quot; &quot;pw_w4&quot; &quot;saq01&quot; ## [7] &quot;saq02&quot; &quot;saq03&quot; &quot;saq04&quot; ## [10] &quot;saq05&quot; &quot;saq06&quot; &quot;saq07&quot; ## [13] &quot;saq08&quot; &quot;s7q03&quot; &quot;s7q04&quot; ## [16] &quot;expenditure&quot; &quot;total_expenditure&quot; &quot;strata&quot; Estimation of totals and means This block estimates the total expenditure and the average expenditure per household on nonfood items, disaggregated by item type. Using the previously defined survey design, the estimates are calculated along with their corresponding precision measures: standard error and coefficient of variation. The results are then rounded and displayed in a readable table to facilitate analysis and interpretation. #------------------------------------------------------------------------------# # Estimation of totals and means #------------------------------------------------------------------------------# tab_02 &lt;- ESS4_design %&gt;% group_by(item = item_cd_12months) %&gt;% summarise( T_hat = survey_total(expenditure, na.rm = TRUE, vartype = c(&quot;se&quot;, &quot;cv&quot;)), M_hat = survey_mean(expenditure, na.rm = TRUE, vartype = c(&quot;se&quot;, &quot;cv&quot;)) ) tab_02 %&gt;% transmute( item = as_factor(item), T_hat = round(T_hat), T_hat_cv = round(T_hat_cv * 100, 2), M_hat = round(M_hat), M_hat_cv = round(M_hat_cv * 100, 2) ) %&gt;% data.frame() item T_hat T_hat_cv M_hat M_hat_cv Clothes/shoes/fabric for MEN (18 years and older) 14831623627 5.16 739 5.10 Clothes/shoes/fabric for WOMEN (18 years and older) 12372041190 4.61 617 4.58 Clothes/shoes/fabric for BOYS (less than 18 years) 8240485360 4.18 411 3.96 Clothes/shoes/fabric for GIRLS (less than 18 years) 7093344006 4.18 353 4.05 Kitchen equipment (cooking pots, etc.) 1546185290 9.68 77 9.64 Linens (sheets, towels,blankets) 3948547743 7.58 197 7.53 Furniture 3204286706 14.43 160 14.38 Lamp/torch/solare power 1364016013 12.61 68 12.58 Ceremonial expenses 26850995607 6.39 1338 6.23 Contributions to informal social security institutions (inc. IDDIR, mahiber..) 2939856749 9.22 146 9.20 Donations to religious institutions (Incl. churches and mosques..) 3238210354 10.25 161 9.89 Estimation of Ratio This block estimates the share of expenditure on each nonfood item relative to total household spending, both at the national level and by region, using the survey_ratio() function. Two tables are generated: one for Ethiopia as a whole and another disaggregated by region, both including standard errors and coefficients of variation. #------------------------------------------------------------------------------# # Estimation of Ratio # #------------------------------------------------------------------------------# tab_03_R1_total &lt;- ESS4_design %&gt;% group_by(item = item_cd_12months) %&gt;% summarise(R_hat = survey_ratio( expenditure, total_expenditure, na.rm = TRUE, vartype = c(&quot;se&quot;, &quot;cv&quot;) )) %&gt;% mutate(Region = &quot;ETHIOPIA&quot;) tab_03_R1_region &lt;- ESS4_design %&gt;% group_by(item = item_cd_12months, Region = as_factor(saq01)) %&gt;% summarise(R_hat = survey_ratio( expenditure, total_expenditure, na.rm = TRUE, vartype = c(&quot;se&quot;, &quot;cv&quot;) )) # Combining results tab_03_R1 &lt;- bind_rows(tab_03_R1_total, tab_03_R1_region) In this block, the results are formatted as percentages and paired with their standard errors in parentheses. The table is then reshaped into wide format, displaying regions as columns to facilitate comparison. # Formatting output tab_03_R1 &lt;- tab_03_R1 %&gt;% transmute( Region, item = as_factor(item), R_hat = round(R_hat * 100, 2), R_hat = paste0(R_hat, &quot; (&quot;, round(R_hat_se * 100, 2), &quot;)&quot;) ) %&gt;% pivot_wider( names_from = Region, values_from = R_hat, values_fill = list(n = 0) ) tab_03_R1 item ETHIOPIA TIGRAY AFAR AMHARA OROMIA SOMALI BENISHANGUL GUMUZ SNNP GAMBELA HARAR ADDIS ABABA DIRE DAWA Clothes/shoes/fabric for MEN (18 years and older) 17.32 (0.64) 16.41 (1.99) 21.76 (2.07) 15.57 (1.03) 19.75 (1.47) 13.9 (1.07) 18.5 (2.17) 15.1 (1.31) 18.94 (1.76) 16.84 (1.81) 19.82 (1.77) 15.91 (1.55) Clothes/shoes/fabric for WOMEN (18 years and older) 14.45 (0.53) 17.76 (1.18) 21.91 (1.81) 13.04 (0.93) 14.98 (1.28) 13.11 (0.9) 16.16 (1.37) 11.55 (1.02) 17.47 (1.75) 17.3 (1.23) 18.33 (1.02) 14.94 (1.31) Clothes/shoes/fabric for BOYS (less than 18 years) 9.62 (0.38) 8.87 (0.86) 14.85 (1.08) 7.61 (0.67) 11.38 (0.95) 16.68 (1.27) 9.3 (1.31) 8.89 (0.73) 10.07 (1.21) 12.08 (1.48) 7.16 (0.65) 11.56 (1.2) Clothes/shoes/fabric for GIRLS (less than 18 years) 8.28 (0.34) 7.98 (0.8) 10.75 (0.79) 6.17 (0.51) 9.13 (0.87) 14.69 (0.94) 8.06 (1) 8.97 (0.7) 8.58 (1.12) 11.5 (1.49) 6.59 (0.53) 8.85 (1.15) Kitchen equipment (cooking pots, etc.) 1.81 (0.16) 1.69 (0.58) 1.21 (0.47) 2.01 (0.38) 1.52 (0.28) 1.27 (0.21) 2.07 (0.49) 1.91 (0.31) 3.87 (0.87) 2.29 (0.45) 2.32 (0.46) 0.95 (0.26) Linens (sheets, towels,blankets) 4.61 (0.3) 4.22 (0.63) 3.31 (0.59) 4 (0.7) 4.94 (0.6) 5.22 (0.8) 4.18 (0.69) 5.52 (0.72) 6.52 (0.97) 4.55 (0.9) 3.69 (0.64) 3.09 (0.55) Furniture 3.74 (0.49) 7.05 (2.19) 1.11 (0.45) 2.61 (0.77) 3.83 (1.19) 1.33 (0.69) 7.69 (2.72) 2.58 (0.66) 4.17 (1.4) 3.61 (1.23) 6.42 (1.2) 7.33 (3.4) Lamp/torch/solare power 1.59 (0.19) 1.35 (0.25) 1.01 (0.23) 2.12 (0.46) 1.82 (0.44) 2.88 (0.53) 2.17 (0.55) 1.11 (0.19) 3.14 (0.81) 0.64 (0.14) 0.08 (0.03) 1.38 (0.59) Ceremonial expenses 31.36 (1.26) 31.17 (3.75) 19.33 (2.73) 40.7 (2.62) 23.65 (2.67) 29.45 (2.79) 25.88 (3.11) 34.18 (2.85) 21.42 (2.97) 26.15 (3.35) 30.46 (2.42) 32.45 (2.74) Contributions to informal social security institutions (inc. IDDIR, mahiber..) 3.43 (0.27) 1.23 (0.36) 1.25 (0.31) 2.53 (0.46) 4.8 (0.65) 0.42 (0.14) 1.16 (0.32) 4.39 (0.52) 1.65 (0.42) 1.81 (0.29) 3.41 (0.52) 1.93 (0.36) Donations to religious institutions (Incl. churches and mosques..) 3.78 (0.35) 2.26 (0.53) 3.51 (2.18) 3.64 (0.62) 4.22 (0.84) 1.06 (0.43) 4.81 (1.13) 5.81 (0.84) 4.17 (0.71) 3.22 (0.45) 1.71 (0.32) 1.6 (0.74) Estimating the Ratio of Educational Expenditure This block begins the analysis of educational expenditure by loading an aggregated consumption dataset. The survey design is then defined using the same stratification structure and adjusted weights applied in previous sections. This step is essential to ensure that estimates of educational spending are properly representative of the survey’s sample design. #------------------------------------------------------------------------------# # Estimating the Ratio of Educational Expenditure # #------------------------------------------------------------------------------# HH_data &lt;- read_sav(&quot;data/data_ESS4/cons_agg_w4.sav&quot;) # Defining the survey design ESS4_design &lt;- HH_data %&gt;% mutate(strata = paste0(saq01, &quot;_&quot;, saq14)) %&gt;% as_survey_design( ids = ea_id, # Primary sampling unit identifier (EA) strata = strata, # Stratification by region (saq01) and urban/rural zone (saq14) weights = pw_w4, # Final adjusted weight nest = TRUE ) Estimation of the ratio This block estimates the share of educational expenditure relative to total household consumption, both at the national level and by region. The survey_ratio() function is used to calculate the ratio between annual educational consumption (educ_cons_ann) and total annual consumption (total_cons_ann), including precision measures such as standard error and coefficient of variation. National and regional results are combined into a single table for further analysis and visualization. #------------------------------------------------------------------------------# # Estimation of the ratio. # #------------------------------------------------------------------------------# tab_03_R2_total &lt;- ESS4_design %&gt;% summarise(R_hat = survey_ratio( educ_cons_ann, total_cons_ann, na.rm = TRUE, vartype = c(&quot;se&quot;, &quot;cv&quot;) )) %&gt;% mutate(Region = &quot;ETHIOPIA&quot;) tab_03_R2_region &lt;- ESS4_design %&gt;% group_by(Region = as_factor(saq01)) %&gt;% summarise(R_hat = survey_ratio( educ_cons_ann, total_cons_ann, na.rm = TRUE, vartype = c(&quot;se&quot;, &quot;cv&quot;) )) # Combining results tab_03_R2 &lt;- bind_rows(tab_03_R2_region, tab_03_R2_total) This final block formats the results of the educational expenditure as a share of total household consumption, expressing them as percentages. Both the estimated ratio (R_hat) and its standard error (R_hat_se) are included, allowing for easy interpretation and comparison across regions and at the national level. # Formatting and displaying results tab_03_R2 %&gt;% transmute(Region, R_hat = round(R_hat * 100, 2), R_hat_se = round(R_hat_se * 100, 2)) Region R_hat R_hat_se TIGRAY 2.51 0.43 AFAR 0.88 0.14 AMHARA 1.41 0.19 OROMIA 1.56 0.17 SOMALI 1.73 0.27 BENISHANGUL GUMUZ 2.44 0.60 SNNP 2.13 0.38 GAMBELA 2.09 0.32 HARAR 2.85 0.36 ADDIS ABABA 8.87 1.38 DIRE DAWA 3.36 0.37 ETHIOPIA 2.35 0.17 "],["correlations.html", "3.3 Correlations", " 3.3 Correlations This section estimates correlations between educational expenditure and other types of household spending using the complex survey design from the ESS4 dataset. It explores the relationship between educational spending and two key components of consumption: utilities and food away from home. The estimates are presented at three levels: 1. National, capturing the overall association. 2. By area type (urban/rural), to explore territorial differences. 3. By region, providing a detailed subnational analysis. The results include correlation coefficients along with their standard errors, allowing for the assessment of both the strength and precision of the associations observed. Prepare the work environment This block sets up the working environment, loads an aggregated individual-level consumption dataset, and defines the survey design for analysis. The data is stratified by region and area type (urban/rural), and both the primary sampling units (ea_id) and adjusted weights (pw_w4) are specified. Applying this structure ensures that all estimates reflect the representativeness of the survey design. Finally, a summary of the design is displayed as a preliminary validation step. #------------------------------------------------------------------------------# # Cleaning R Environment # #------------------------------------------------------------------------------# rm(list = ls()) gc() ## used (Mb) gc trigger (Mb) max used (Mb) ## Ncells 542546 29.0 1219888 65.2 660485 35.3 ## Vcells 955799 7.3 8388608 64.0 1770406 13.6 #------------------------------------------------------------------------------# # Libraries # #------------------------------------------------------------------------------# library(tidyverse) library(survey) library(srvyr) library(data.table) library(magrittr) library(haven) library(stringr) library(tidyr) library(knitr) library(kableExtra) # Ensure select function from dplyr is used explicitly select &lt;- dplyr::select #------------------------------------------------------------------------------# # Loading Datasets # #------------------------------------------------------------------------------# IND_data &lt;- read_sav(&quot;data/data_ESS4/cons_agg_w4.sav&quot;) %&gt;% mutate(strata = paste0(saq01, &quot;_&quot;, saq14)) #------------------------------------------------------------------------------# # Defining Survey Design # #------------------------------------------------------------------------------# ESS4_design &lt;- IND_data %&gt;% as_survey_design( ids = ea_id, # Primary sampling unit identifier (EA) strata = strata, # Stratification by region (saq01) and urban/rural zone (saq14) weights = pw_w4, # Final adjusted weight nest = TRUE ) options(survey.lonely.psu = &quot;fail&quot;) summary(ESS4_design) ## Stratified 1 - level Cluster Sampling design (with replacement) ## With (535) clusters. ## Called via srvyr ## Probabilities: ## Min. 1st Qu. Median Mean 3rd Qu. Max. ## 3.932e-05 1.997e-04 7.680e-04 2.814e-03 4.164e-03 1.317e-01 ## Stratum Sizes: ## 1_1 1_2 12_1 12_2 13_1 13_2 14_2 15_1 15_2 2_1 2_2 3_1 3_2 4_1 4_2 ## obs 393 283 195 300 190 360 778 160 419 299 225 479 271 453 300 ## design.PSU 35 19 19 20 18 24 52 14 28 28 15 43 18 43 20 ## actual.PSU 35 19 19 20 18 24 52 14 28 28 15 43 18 43 20 ## 5_1 5_2 6_1 6_2 7_1 7_2 ## obs 355 255 169 195 422 269 ## design.PSU 35 17 16 13 40 18 ## actual.PSU 35 17 16 13 40 18 ## Data variables: ## [1] &quot;household_id&quot; &quot;ea_id&quot; &quot;saq01&quot; ## [4] &quot;saq14&quot; &quot;pw_w4&quot; &quot;adulteq&quot; ## [7] &quot;hh_size&quot; &quot;food_cons_ann&quot; &quot;nonfood_cons_ann&quot; ## [10] &quot;educ_cons_ann&quot; &quot;fafh_cons_ann&quot; &quot;utilities_cons_ann&quot; ## [13] &quot;total_cons_ann&quot; &quot;nom_foodcons_aeq&quot; &quot;nom_nonfoodcons_aeq&quot; ## [16] &quot;nom_educcons_aeq&quot; &quot;nom_utilities_aeq&quot; &quot;nom_totcons_aeq&quot; ## [19] &quot;spat_totcons_aeq&quot; &quot;cons_quint&quot; &quot;strata&quot; Estimating Correlations This block calculates the overall correlation between annual educational expenditure and two types of spending: utilities and food away from home. The estimates account for the complex survey design. #------------------------------------------------------------------------------# # Estimating Correlations # #------------------------------------------------------------------------------# # Overall correlation ESS4_design %&gt;% summarise( corr1 = survey_corr(educ_cons_ann, utilities_cons_ann), corr2 = survey_corr(educ_cons_ann, fafh_cons_ann) ) The table shows the national-level estimated correlations between annual educational expenditure and two types of spending: corr1: correlation between educational spending and utility expenses, estimated at 0.19, indicating a moderate positive association. corr2: correlation between educational spending and food away from home, estimated at 0.06, suggesting a weak association. Both estimates include their respective standard errors, allowing for an assessment of precision within the context of the complex survey design. corr1 corr1_se corr2 corr2_se 0.1906679 0.0313768 0.0551461 0.0250799 This block estimates the correlation by area type (urban or rural), allowing us to identify differences in spending patterns depending on geographic setting. # Correlation grouped by urban/rural area ESS4_design %&gt;% group_by(area = as_factor(saq14)) %&gt;% summarise( corr1 = survey_corr(educ_cons_ann, utilities_cons_ann), corr2 = survey_corr(educ_cons_ann, fafh_cons_ann) ) The table shows the correlations between educational expenditure and other types of spending, broken down by area of residence: In rural areas, the correlation between educational spending and utilities (corr1) is moderate (0.19) but has higher uncertainty (standard error = 0.073). The correlation with food away from home (corr2) is nearly zero (0.009). In urban areas, the correlation with utilities remains positive (0.16) and is more precise (standard error = 0.025). The correlation with food away from home is slightly higher (0.039) than in rural areas but still weak. These results suggest that the link between educational and utility spending is consistent across areas, while the relationship with food away from home is weak—particularly in rural settings. area corr1 corr1_se corr2 corr2_se RURAL 0.1910101 0.0729421 0.0091824 0.0257959 URBAN 0.1582441 0.0248202 0.0391755 0.0221427 This block estimates the correlation between expenditure variables by region, providing a more detailed view of consumption relationships at the subnational level. # Correlation grouped by region ESS4_design %&gt;% group_by(Region = as_factor(saq01)) %&gt;% summarise( corr1 = survey_corr(educ_cons_ann, utilities_cons_ann), corr2 = survey_corr(educ_cons_ann, fafh_cons_ann) ) The table displays regional correlations between educational expenditure and two types of spending: utilities (corr1) and food away from home (corr2), along with their standard errors. In most regions, the correlation between education and utilities is positive and moderate, with the highest values in Dire Dawa (0.33), Somali (0.31), Amhara (0.24), and Harar (0.23). This suggests that households investing more in education also tend to spend more on utilities in those areas. The correlation with food away from home is weaker and more variable. Notably, Tigray (0.25) shows a stronger positive association, while Benishangul Gumuz (-0.07) and Dire Dawa (-0.04) show negative correlations, possibly reflecting different spending trade-offs or priorities. The standard errors indicate precision: Addis Ababa has the most precise estimates, while regions like SNNP and Tigray show greater uncertainty. Region corr1 corr1_se corr2 corr2_se TIGRAY 0.1909944 0.0809238 0.2539895 0.0621995 AFAR 0.1700086 0.0586904 -0.0021256 0.0574260 AMHARA 0.2370307 0.0570303 0.0401066 0.0363661 OROMIA 0.2096871 0.0381022 -0.0103300 0.0372057 SOMALI 0.3050576 0.0560321 0.0536496 0.0709755 BENISHANGUL GUMUZ 0.0079110 0.0272672 -0.0658016 0.0232147 SNNP 0.2022214 0.0712977 0.0467115 0.0269180 GAMBELA 0.1174653 0.0444969 0.0224387 0.0497909 HARAR 0.2334025 0.0598253 0.0476901 0.0362023 ADDIS ABABA 0.1816015 0.0214595 0.0152325 0.0212303 DIRE DAWA 0.3336417 0.0726053 -0.0382218 0.0236171 "],["percentiles-and-inequality-measures.html", "3.4 Percentiles and inequality measures", " 3.4 Percentiles and inequality measures This section estimates key inequality and income access indicators among Ethiopian households using ESS4 survey data. It begins by processing non-labor income sources, calculating the proportion of households that received each source, along with the mean and median income values. Then, it computes the Gini coefficient based on per capita expenditure, taking into account the complex survey design. A per-person expenditure variable is constructed, the survey design is defined using convey, and the Gini is calculated both at the national and regional levels. The final results help characterize income inequality in Ethiopia and highlight regional disparities, providing essential evidence to inform equity-oriented public policy. Prepare the work environment This block initiates the analysis of income by source using data from Section 13 of the ESS4 household questionnaire. It begins by cleaning the environment, loading the required libraries, and importing the relevant dataset. Then, income variables are processed: - income is created to reflect the reported value or zero if no income was received. - A binary indicator yes_no is defined to flag participation in each income source. Next, the survey design is defined using stratification by region and area type (urban/rural), primary sampling unit identifiers, and adjusted weights. This setup ensures that all income estimates are representative. A summary of the design is provided as a consistency check before further analysis. #------------------------------------------------------------------------------# # Cleaning R Environment # #------------------------------------------------------------------------------# rm(list = ls()) gc() ## used (Mb) gc trigger (Mb) max used (Mb) ## Ncells 542662 29.0 1220220 65.2 660485 35.3 ## Vcells 956517 7.3 8388608 64.0 1770410 13.6 #------------------------------------------------------------------------------# # Libraries # #------------------------------------------------------------------------------# library(tidyverse) library(survey) library(srvyr) library(data.table) library(magrittr) library(haven) library(stringr) library(tidyr) library(knitr) library(kableExtra) library(convey) # Ensure select function from dplyr is used explicitly select &lt;- dplyr::select #------------------------------------------------------------------------------# # Setting the RAM Memory Limit # #------------------------------------------------------------------------------# memory.limit(250000000) ## [1] Inf #------------------------------------------------------------------------------# # Loading Datasets # #------------------------------------------------------------------------------# HH_data &lt;- read_sav(&quot;data/data_ESS4/sect13_hh_w4_v2.sav&quot;) #------------------------------------------------------------------------------# # Processing Income Data # #------------------------------------------------------------------------------# HH_data &lt;- HH_data %&gt;% group_by(item = source_cd) %&gt;% mutate(income = ifelse(s13q01 == 2, 0, s13q02), yes_no = ifelse(s13q01 == 2, 0, 1)) #------------------------------------------------------------------------------# # Defining Survey Design # #------------------------------------------------------------------------------# ESS4_design &lt;- HH_data %&gt;% mutate(strata = paste0(saq01, &quot;_&quot;, saq14)) %&gt;% as_survey_design( ids = ea_id, # Primary sampling unit identifier (EA) strata = strata, # Stratification by region (saq01) and urban/rural zone (saq14) weights = pw_w4, # Final adjusted weight nest = TRUE ) options(survey.lonely.psu = &quot;fail&quot;) summary(ESS4_design) ## Stratified 1 - level Cluster Sampling design (with replacement) ## With (535) clusters. ## Called via srvyr ## Probabilities: ## Min. 1st Qu. Median Mean 3rd Qu. Max. ## 3.932e-05 1.997e-04 7.680e-04 2.814e-03 4.164e-03 1.317e-01 ## Stratum Sizes: ## 1_1 1_2 12_1 12_2 13_1 13_2 14_2 15_1 15_2 2_1 2_2 3_1 3_2 ## obs 5502 3962 2730 4200 2660 5040 10892 2240 5866 4186 3150 6706 3794 ## design.PSU 35 19 19 20 18 24 52 14 28 28 15 43 18 ## actual.PSU 35 19 19 20 18 24 52 14 28 28 15 43 18 ## 4_1 4_2 5_1 5_2 6_1 6_2 7_1 7_2 ## obs 6342 4200 4970 3570 2366 2730 5908 3766 ## design.PSU 43 20 35 17 16 13 40 18 ## actual.PSU 43 20 35 17 16 13 40 18 ## Data variables: ## [1] &quot;household_id&quot; &quot;source_cd&quot; &quot;ea_id&quot; &quot;saq14&quot; &quot;pw_w4&quot; ## [6] &quot;saq01&quot; &quot;saq02&quot; &quot;saq03&quot; &quot;saq04&quot; &quot;saq05&quot; ## [11] &quot;saq06&quot; &quot;saq07&quot; &quot;saq08&quot; &quot;s13q01&quot; &quot;s13q02&quot; ## [16] &quot;s13q03_1&quot; &quot;s13q03_2&quot; &quot;s13q04a&quot; &quot;s13q04b&quot; &quot;s13q04c&quot; ## [21] &quot;s13q05&quot; &quot;item&quot; &quot;income&quot; &quot;yes_no&quot; &quot;strata&quot; Estimating the Mean and Median of Total Other Income This block estimates key indicators to construct Table 5.3 of the ESS4 report, which focuses on non-labor income sources received over the last 12 months, broken down by type. First, it calculates the mean (M_hat) and median (Md_hat) income for each source (item), including only households that reported receiving income from that source. Then, it estimates the proportion of households (P_hat) that reported receiving each income type, based on the binary variable yes_no. Finally, both results are merged into a single table that summarizes the coverage and estimated amounts of income by source across the country. #------------------------------------------------------------------------------# # Estimation of Income Statistics - TABLE 5.3 # # Other Income by Source in the Last 12 Months and Median Income by Source, # Ethiopia 2018/19 #------------------------------------------------------------------------------# # ESS4 Sampled EAs and Households by Region and by Urban and Rural # Ethiopia Socioeconomic Survey (ESS) 2018/19 # SURVEY REPORT # Central Statistics Agency of Ethiopia | World Bank #------------------------------------------------------------------------------# # Estimating the Mean and Median of Total Other Income tab_06 &lt;- ESS4_design %&gt;% group_by(item) %&gt;% filter(s13q01 == 1) %&gt;% summarise( M_hat = survey_mean(income, na.rm = TRUE, vartype = c(&quot;se&quot;, &quot;cv&quot;)), Md_hat = survey_median(income, na.rm = TRUE, vartype = c(&quot;se&quot;, &quot;cv&quot;)) ) # Estimating proportion of HH that received other income sources tab_06_P &lt;- ESS4_design %&gt;% group_by(item) %&gt;% summarise(P_hat = survey_mean(yes_no, na.rm = TRUE, vartype = c(&quot;se&quot;, &quot;cv&quot;))) # Merging income and proportion tables tab_06 &lt;- inner_join(tab_06, tab_06_P) This block produces the final formatted output for the estimates of non-labor income sources, resulting in a clear and concise table. For each income source, it presents the proportion of households that reported receiving it (P_hat), along with its standard error and coefficient of variation, allowing for the evaluation of both coverage and estimate precision. It also includes the median income (Md_hat) among recipients, with corresponding measures of uncertainty. All values are rounded to enhance readability and interpretation, making the resulting table suitable for technical reports or comparative analyses. # Formatting and displaying results tab_06 %&gt;% transmute( item = as_factor(item), P_hat = round(P_hat * 100, 2), P_hat_cv = round(P_hat_cv * 100, 2), P_hat_se = round(P_hat_se * 100, 2), Md_hat = round(Md_hat), Md_hat_se = round(Md_hat_se), Md_hat_cv = round(Md_hat_cv * 100, 2) ) The table summarizes the estimated non-labor income sources for the Ethiopian population. For each income type, it shows the proportion of recipient households (P_hat), along with its standard error and coefficient of variation, allowing assessment of both coverage and estimate precision. It also reports the median income (Md_hat) among those who received the income, including precision measures. The most common sources include cash transfers from individuals (10.3%) and food transfers (5.1%), while pensions and land rental show relatively high median values. In contrast, less common sources such as inheritance, asset sales, or rental of tools display higher uncertainty or lack sufficient data for reliable precision estimates. item P_hat P_hat_cv P_hat_se Md_hat Md_hat_se Md_hat_cv Cash Transfer/Gifts from Individuals 10.33 7.10 0.73 4000 508 12.71 Food Transfers/Gifts from Individuals 5.15 10.44 0.54 500 203 40.53 Non-food In-kind Transfers/Gifts form Individuals 2.49 15.47 0.39 800 252 31.48 Savings, Interest or Other Investment Income 0.23 48.34 0.11 520 NaN NaN Pension Income 1.42 13.46 0.19 7000 1206 17.23 Income from Shop/Store Rental/Car, truck, other vehicle rental 2.47 13.24 0.33 6000 1161 19.35 Income from Land Rental 4.02 12.73 0.51 4000 266 6.66 Income from Renting Agricultural Tools 0.17 50.31 0.08 2500 NaN NaN Income from Renting Transport Animals 0.66 25.60 0.17 600 1039 173.14 Income from Real Estate Sales 0.16 53.31 0.08 2880 NaN NaN Income from household Non-Agricultural Asset Sales 0.98 24.17 0.24 3500 1759 50.27 Income from household Agricultural/Fishing Asset Sales 7.90 16.88 1.33 6500 882 13.57 Income from sales of other Fixed Assets (Sale of b/ss enterprises or stocks/shares 0.89 33.56 0.30 4600 5830 126.74 Inheritance/Lottery/Gambling Winnings 0.18 47.66 0.09 12000 NaN NaN The Gini Coefficient. This block prepares the data required to calculate the Gini coefficient based on per capita expenditure. It begins by loading the nonfood expenditure dataset and computing total household expenditure, considering only items that were actually purchased. This is then merged with the household cover data to retrieve household size (saq09). Using this merged dataset, per capita expenditure is calculated by dividing total expenditure by the number of household members. Lastly, summary statistics of the resulting variable are generated as a preliminary step before inequality estimation. #------------------------------------------------------------------------------# # Loading Datasets # #------------------------------------------------------------------------------# EXP_data &lt;- read_sav(&quot;data/data_ESS4/sect7b_hh_w4_v2.sav&quot;) %&gt;% mutate(expenditure = ifelse(s7q03 == 2, 0, s7q04)) %&gt;% group_by(household_id) %&gt;% summarise(total_expenditure = sum(expenditure, na.rm = TRUE)) HH_data &lt;- read_sav(&quot;data/data_ESS4/sect_cover_hh_w4.sav&quot;) #------------------------------------------------------------------------------# # Processing Per Capita Expenditure # #------------------------------------------------------------------------------# # Merging household data with expenditure data HH_data &lt;- HH_data %&gt;% inner_join(EXP_data) HH_data &lt;- HH_data %&gt;% mutate(percapita_expenditure = total_expenditure / saq09) # Summary statistics summary(HH_data$percapita_expenditure) ## Min. 1st Qu. Median Mean 3rd Qu. Max. ## 0.0 335.7 800.0 1470.2 1706.7 58378.0 This block defines the survey design based on the previously processed household data and prepares it for inequality analysis using the convey package. A stratification variable is created by combining the region (saq01) and the urban/rural classification (saq14), while the primary sampling units (ea_id) and final adjusted weights (pw_w4) are specified. The design is then prepared using convey_prep(), which is essential for computing measures such as the Gini coefficient under a complex survey framework. Finally, a summary of the prepared design is displayed to verify its structure before proceeding with the analysis. #------------------------------------------------------------------------------# # Defining the Survey Design # #------------------------------------------------------------------------------# ESS4_design &lt;- HH_data %&gt;% mutate(strata = paste0(saq01, &quot;_&quot;, saq14)) %&gt;% as_survey_design( ids = ea_id, # Primary sampling unit identifier (EA) strata = strata, # Stratification by region (saq01) and urban/rural zone (saq14) weights = pw_w4, # Final adjusted weight nest = TRUE ) design_gini &lt;- convey_prep(ESS4_design) options(survey.lonely.psu = &quot;fail&quot;) summary(design_gini) ## Stratified 1 - level Cluster Sampling design (with replacement) ## With (535) clusters. ## Called via srvyr ## Probabilities: ## Min. 1st Qu. Median Mean 3rd Qu. Max. ## 3.932e-05 1.997e-04 7.680e-04 2.814e-03 4.164e-03 1.317e-01 ## Stratum Sizes: ## 1_1 1_2 12_1 12_2 13_1 13_2 14_2 15_1 15_2 2_1 2_2 3_1 3_2 4_1 4_2 ## obs 393 283 195 300 190 360 778 160 419 299 225 479 271 453 300 ## design.PSU 35 19 19 20 18 24 52 14 28 28 15 43 18 43 20 ## actual.PSU 35 19 19 20 18 24 52 14 28 28 15 43 18 43 20 ## 5_1 5_2 6_1 6_2 7_1 7_2 ## obs 355 255 169 195 422 269 ## design.PSU 35 17 16 13 40 18 ## actual.PSU 35 17 16 13 40 18 ## Data variables: ## [1] &quot;household_id&quot; &quot;ea_id&quot; &quot;saq14&quot; ## [4] &quot;pw_w4&quot; &quot;saq01&quot; &quot;saq02&quot; ## [7] &quot;saq03&quot; &quot;saq04&quot; &quot;saq05&quot; ## [10] &quot;saq06&quot; &quot;saq07&quot; &quot;saq08&quot; ## [13] &quot;saq09&quot; &quot;saq11&quot; &quot;saq12&quot; ## [16] &quot;saq13&quot; &quot;saq17&quot; &quot;saq18&quot; ## [19] &quot;InterviewStart&quot; &quot;saq21&quot; &quot;total_expenditure&quot; ## [22] &quot;percapita_expenditure&quot; &quot;strata&quot; This block computes the Gini coefficient of per capita expenditure using the complex survey design. It first estimates the national value, then uses map_df() to calculate regional Gini coefficients (saq01). Each estimate includes its standard error, allowing assessment of inequality both nationally and by region. #------------------------------------------------------------------------------# # Computing Gini Coefficient based on expenditure # #------------------------------------------------------------------------------# # National Gini coefficient tab_07_tot &lt;- svygini(~ percapita_expenditure, design = design_gini) %&gt;% as.data.frame() %&gt;% mutate(Region = &quot;ETHIOPIA&quot;) %&gt;% rename(SE = percapita_expenditure) # Regional Gini coefficient tab_07_region &lt;- map_df( unique(HH_data$saq01), ~ svygini( ~ percapita_expenditure, design = design_gini %&gt;% filter(saq01 == .x)) %&gt;% as.data.frame() %&gt;% mutate(Region = as_factor(.x))) %&gt;% rename(SE = percapita_expenditure) This block merges the national and regional results into a single table, with Gini coefficients and their standard errors rounded and expressed as percentages. # Combining results tab_07 &lt;- bind_rows(tab_07_region, tab_07_tot) %&gt;% transmute(Region, gini = round(gini * 100, 2), SE = round(SE * 100, 2),) rownames(tab_07) &lt;- NULL tab_07 The table shows the Gini coefficient values for per capita expenditure in Ethiopia, both nationally and by region. At the national level, the Gini is estimated at 58.68%, indicating a high degree of inequality in expenditure distribution. Regionally, the highest inequality levels are found in Benishangul Gumuz (67.41%), Gambela (61.40%), and SNNP (61.19%). Conversely, Somali (49.28%), Addis Ababa (53.46%), and Dire Dawa (53.81%) show relatively lower inequality. These findings highlight significant regional disparities, which are crucial for informing targeted policy interventions. Region gini SE TIGRAY 60.19 2.61 AFAR 54.22 4.04 AMHARA 56.16 2.08 OROMIA 57.28 2.33 SOMALI 49.28 2.88 BENISHANGUL GUMUZ 67.41 3.44 SNNP 61.19 2.83 GAMBELA 61.40 3.10 HARAR 58.90 2.94 ADDIS ABABA 53.46 1.84 DIRE DAWA 53.81 2.40 ETHIOPIA 58.68 1.12 "],["404.html", "Page not found", " Page not found The page you requested cannot be found (perhaps it was moved or renamed). You may want to try searching to find the page's new location, or use the table of contents to find the page you are looking for. "]]
